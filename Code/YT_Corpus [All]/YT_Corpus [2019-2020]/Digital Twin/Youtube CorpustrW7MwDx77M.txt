 I'd like to thank the SPE foundation for making this Distinguished Lecturer program possible through member donations and a contribution from Offshore Europe. Additional support is also provided by AIME. My name is John Hedengren and I’m an Associate Professor at Brigham Young University in Provo, Utah. Automation is transforming many aspects of our lives as well as the energy industry. Today, I’ll talk generally about the progress in automation and specifically about drilling automation. Along with automation we want to monitor conditions that cannot be measured directly. I’ll share recent advancements on monitoring downhole drilling conditions with machine learning and physics-based digital twins. We’ll first cover why and how to automate drilling. I’ll share 3 essential elements of automation including sensors, actuators, and controllers. There are many motivating case studies for automation and I’ll share references to several case studies. While there has been recent progress, there remain many challenges and opportunities with using physics based or machine learned models. A digital twin is a simulation replica of a physical assets or processes. I’ll share methods for creating a digital twin of the drilling process to enable new ways of thinking about automation. This new way of thinking is to use the predictive power of the digital twin to create predictive instead of reactive automation solutions. This is shown through a simulation study on combined pressure and rate control. Finally, I’ll share a few concluding thoughts along with a few things that you can do to adopt automation and fully utilize the predictive potential of digital twins and machine learning. Let’s review why we want to automate drilling. There are many benefits of automation including health, safety, and environmental factors. Automation reacts faster to problems with fast and small corrections versus large corrections or costly remedial actions. Economic benefits come from operating closer to constraints and reducing drilling time (especially with challenging market conditions). One study showed that there continue to be an average of 4 uncontrolled well situations in the Gulf of Mexico each year, even after the BP Macondo well incident in 2011. Automation is making strong progress in the oil and gas industry as shown by the recent publications. Results include greater accuracy and consistency, faster drilling with fewer interruptions, and more accurate directional drilling for fewer deviations and improved steering to the most productive reservoir zones. Automation is transforming many industries. Surgeons are directing robots in operations with improved precision. Self driving vehicles are augmenting the driver capabilities and may soon take full control. Self-driving long-haul truck transporters are currently under development to reduce transportation costs. Unmanned aerial vehicles, or drones, are increasingly used to regularly inspect assets such as flare stacks and offshore platform risers. Technology companies are working on systems to change how we buy and receive products with automated delivery and warehouse management. Automation is transforming medical care, transportation, inspection, and retail. Full automation does not typically happen all at once. There are many levels of automation that consider human machine interactions. Sheridan proposed 10 levels of automation with levels 1-3 listed here. In the first level, the computer carries out the command. In the second level, the computer also gets options. In the third level, the computer also selects the action. With each successive level of automation, the computer does more of the work. In level 5, the computer starts the action with human approval, In level 8, the computer does everything and the role of the human is to request the outcome or request an explanation for the action. Level 10 is full automation. I’ll share a video of an automation scenario. At a certain point in the video, the automation level goes from Level 8 to Level 10. As you can see, the driver is not touching the steering wheel, brake, or accelerator. Computer vision identifies other vehicles, pedestrians, and other features of interest. At the beginning of the journey, the driver requested an action (a destination) and the car is self-navigating. The driver is ready to take control if needed (Level 8). At a certain point, the driver exits the vehicle and the vehicle enters a mode to find a parking spot (Level 10). Once it identifies a parking spot, it navigates to the spot and parks until the driver summons the car. This is a complex environment with many decisions. Can a similar level of automation be provided to assist a driller? With any automation system there are three essential elements: the sensor that measures the quantity of interest, an actuator that causes a change to the system, and a controller that requests new sensor readings and makes the adjustments to the actuator. Managed Pressure Drilling (MPD) is a special type of drilling where the drilling mud returns to the mud pit through a choke valve. When the valve closes, the pressure increases at the drill bit to increase the downhole pressure to match the reservoir pore pressure. MPD also uses a back pressure pump to maintain flow through the choke valve and regulate pressure when the main mud pump is stopped. In designing an automation system for MPD, there are many considerations including open or proprietary systems, centralized or distributed control systems, and simple or complex features. Now that we have reviewed the three essential elements for automation, let’s first review the progress with sensors and digitization. A modern automobile may produce up to 25 GB per hour of data. A wind farm has 150,000 data point per second, and an aircraft engine produces 51,200 GB per hour. This data is used to monitor the health of the equipment and provide early warning signals of failure. Similar to these other industries, the drilling industry is experiencing a rapid increase in the amount of drilling, completions, and production data. Mud pulse telemetry is a common method for transmitting data from downhole sensors but it is generally limited to less than 100 bits per second. Acoustic signals and electromagnetic telemetry have improved data transmissions rates as well as the recent developments with wired drill pipe. Wired drill pipe, in particular, has increased the data transmission rates to over 100’s of kbits per second and next generation technologies are under development to further expand this capability. It is important to monitor downhole pressure, in particular, to remain within an acceptable pressure region. A lower limit for pressure is the collapse pressure and the upper limit is the overburden pressure. Even more restrictive limits are the lower pore pressure where fluid influx may occur and the upper fracture pressure where the reservoir may be damaged or lead to drilling fluid loss. The bottomhole pressure fluctuates during drilling operations as the mud pumping stops for additional pipe connections. Some reservoirs have wide pressure margins while others have very narrow pressure margins. The wide pressure margins on the left indicate that wide fluctuations in pressure are allowed while the narrow pressure margins on the right indicate that tight pressure control is essential during drilling. The choke valve in MPD adjusts the pressure at the surface. The mud density or equivalent circulating density (ECD) adjust the slope of pressure versus depth along the drill string. The closing the choke valve has the effect of moving the starting pressure at the top to the right. Choke valve opening and mud pump flow are used to adjust the bottomhole pressure. The rate of penetration (ROP) of the drill bit is adjusted with weight on bit (WOB) and the drillstring rotation rate in revolutions per minute (RPM). The ROP and pressure control are traditionally separate. Pumps and chokes are used to adjust pressure and the drill string is used to adjust cutting rate. Later, I’ll show a new way of thinking where pressure and ROP are combined instead of separate. The table gives a summary of the actuators, sensors, and estimated parameters required for predictive control. The actuators are the main mud pump, return choke valve, and the back pressure pump. The sensors are bottom hole pressure, annular pressures, and choke valve pressure. More information is in the SPE 173045 publication. Successful completion of a depleted reservoir in Southeast Asia would not have been possible without automation. This particular depleted reservoir had very narrow pressure margins. Wired drillpipe was used to measure the bottomhole pressure and maintain the pressure during all phases of drilling. This case study shows successful closed-loop pressure control to maintain pressure within 1 bar during normal drilling and within 3 bar during pipe connections. More discussion and results are given in IADC/SPE 112651. The Southeast Asia case study used a Proportional, Integral, and Derivative (PID) controller. PID has terms that monitor the measured and target pressures to adjust the choke valve. A PID controller is a feedback controller that is like driving while looking backwards. The controller “sees” how far it is away from a target value and makes adjustments to return to the target. PID controllers are very common in automation applications and can also be supplemented with feedforward elements to anticipate some future changes. Next, we will do a demonstration of feedback control with an Arduino microcontroller. This is an example of PID control that adjusts a transistor heater to maintain a temperature. The blue dashed line is the desired set point or temperature target. The orange solid line is the measured temperature. The black line below is the heater output that is adjusted by the PID controller. The heater application is like driving forward while looking backwards at the deviation outside the target lane. Imagine if the application could use a digital twin of the process to look forward instead? This is called Model Predictive Control as represented with the blue car on the right. The driver looks forward and occasionally checks the mirrors behind to update an understanding of where the car has been and what obstacles or disturbances are expected in the future. An essential element of Model Predictive Control is the digital twin that is used to predict the future based on current or future control actions. Model Predictive Control uses a digital twin simulation to anticipate future temperature. A move plan is calculated every 3 seconds and the heater values are implemented. After 3 seconds, new temperature measurements update the model and the calculation is repeated. Target temperatures may be a trajectory that controls the speed or response as shown in the top plot or else a temperature range as shown in the middle plot. With MPC, the move plan shows what the heaters will do in the future, up to 2 minutes in advance. The move plan changes as new measurements or target set points are updated. This is a comparison between PID and MPC. As you can see, there is little difference and both perform very well. MPC is especially needed when the system is nonlinear or there are multivariate effects that a PID controller cannot handle. The MPD drilling process is highly nonlinear with respect to choke valve opening. As the choke valve closes below 20%, there is a large increase in downhole pressure. This effect is amplified with increased mud pump flow. An automation system that does not account for this dramatic pressure increase may fracture the reservoir by closing the choke valve. With the challenges of multivariate effects and the nonlinear drilling process, there are many recent opportunities to use predict models in automation. First, there are data-based models such as artificial intelligence and deep learning. In addition, there are physic-based models of wellbore hydraulics and drill string dynamics. Optimizers have improved by 2.5 billion times in the past 30 years. Computing power has improved 17,000 times and some optimizers are 150,000 times faster on benchmark problems. Combining these two improvements allows automation systems to optimize predictive models much faster. Data-based models such as artificial neural networks can be used to create a digital twin. When there are multiple layers of neurons, it becomes deep-learning. Additional neurons generally improve the model fit but there may also be problems with extrapolation outside the training region. If there is knowledge of the system, it can be imposed on the problem as a first principles or physics-based model such as this case where x1 times x2 is selected as an input. Physics-based models are accurate digital twins of the drilling process as shown in SPE-112109. However, these models are challenging to align to all of the drilling and reservoir parameters. The complex models may also be too slow for Model Predictive Control where the digital twin must be simulated many times to determine the optimal solution. The hydraulic and drill string models are still useful, however, to train simplified models for automation. There are also advanced physics-based models of the drill string. The simulation on the left is a finite element analysis of the drill string. The simulation on the right shows the development of backward whirl. The backward whirl is from interaction between the drill string and borehole wall. The physics-based models accurately predict downhole behavior but may be too slow to be used in real-time automation. There are also hardware-in-the-loop simulators, such as at Celle, Germany, that verify the accuracy of the drill string models. Controlled case studies, such as these, provide valuable data and validation for simplified models that are useful for automation. Fit-for-purpose models are essential in Model Predictive Control. A simplified model is trained from the complex model. Once the model is trained in the first 25 seconds, the simplified model agrees with the complex model that is too slow. The simplified model can also be trained from downhole data, such as from wired drill pipe or Measurement While Drilling (MWD) tools. Returning to the temperature control device as an example, the model is trained by adjusting the parameter values to match the data. These parameter values are shown as K1 and K2 as dot sizes. The model predictions are aligned to past data as shown in the purple region. The model is then used to predict the future and develop an automation strategy as shown in the orange region. This is predictive automation that is also applied to drilling to see future events and take a proactive versus a reactive approach to automation. Digital twins are trained from data and are used to predict future and coordinate multiple actuators. In the prior Southeast Asia case study, only the choke valve was used to control pressure. These results show what is possible if the mud pump flow were adjusted in coordination with the choke valve to improve pressure control. The mud pump remains above a minimum limit needed for cuttings transport. This enables smaller adjustments of the choke valve and improved pressure control. A new way of thinking about control is to use multivariate relationships in automation. Formerly separate control such as pressure and ROP may see further improvement by combining the control into one unified strategy. A multivariate controller uses all of the measurements, actuators, and information about the desired outcomes to build a unified strategy. This is a case study on combining MPD pressure control and ROP maximization. The choke valve and pumps are traditionally adjusted to control pressure and the drill string WOB and RPM are adjusted to control ROP. When the two are combined into a unified strategy, the controller has a surprising outcome that challenges conventional thinking. We performed a simulation study with a large and unexpected fluid influx while drilling. The combined controller closes the close valve, increases the mud flow, increases the rotation rate, and decreases the WOB. The increase in rotation rate and WOB are not conventional methods to stop gas influx. However, the controller understands that the rotation rate has an immediate and along-string effect of increasing the pressure as the friction factor is increased. The WOB is decreased to compensate for the increase in rotation rate. Not only did the controller stop the gas influx, but it also found a way to further increase ROP by adjusting the pressure to the minimum allowable value. It understands the effect of pressure on drilling rate. There remain several challenges for drilling automation. First, automation requires digitization of the drilling process. Second, automation with predictive models is unreliable if the digital twin is not sufficiently accurate. Third, advanced optimizers may fail to find a solution within the required time. These are challenges that need further attention and development with reinforcement learning methods to update the digital twins and ensure reliability of the solver solution. In conclusion, automation leads to greater accuracy and consistency of drilling operations. Recent case studies show quantifiable results with faster drilling and fewer interruptions. There are three essential elements for automation including sensors, actuators, and controllers. Developments in each of these areas have enabled higher levels of automation in the medical field, transportation, aviation, retail, and the drilling industry. Predictive and multivariate control are two new ways of thinking about automation. There are many remaining challenges with predictive automation and many opportunities as companies seek innovative solutions. There are resources to help you get started. There is a new sub-section of the SPE Drilling Systems Automation Technical Section (DSATS) that is focused on creating models, cases, and data sets for evaluating new automation strategies. I also teach an online course on Machine Learning and Dynamic Optimization. I’d also like to connect with you on LinkedIn or discuss future opportunities for automation. I look forward to visiting 21 local SPE sections to share this message on drilling automation and to share this presentation with the online community. Thank you for your attention. Your feedback is very important. I encourage you to fill out an evaluation form at SPE.org/dl. Thank you. 