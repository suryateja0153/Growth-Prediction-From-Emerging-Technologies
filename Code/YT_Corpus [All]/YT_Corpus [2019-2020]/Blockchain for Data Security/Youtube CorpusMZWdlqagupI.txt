 [Music] so I'm Luis tough I had a platform at blockchain today I'm gonna be talking about how he brought retail trading to 34 million cryptocurrency wallets globally so first off who is blockchain they may have heard of the term Brenda Durant so we are blockchain comm television company and actually the world's leading digital asset platform so we started out life as a blockchain Explorer specifically for Bitcoin and then we've evolved and grown many products over the last five years one of our most popular is our cryptocurrency wallet we've also launched a number of our consumer products including the ability to trade for two currency and we have data products market research ap is for live streaming data on blockchain analytics and we've also launched a number of institutional products I'll go into more details on some of these later on the presentation so how do we compare it to the market and who is our kind of main competition so you may have heard of a company called coinbase so the difference between us and them is that they focus more on the custodial offering which means they are taking custody of your digital assets and funds and in return you can use our platform and services for us we've taken a noncustodial first approach which means we're empowering users take full control of their private keys and digital assets at no point do we take ownership of those and compromise your security or privacy so that means you are no longer reliant on a third party a centralized entity or risk of any one person losing or being compromised with your digital assets and funds so our key aim really is to empower users and educate them to allow them to take control in a secure and simple manner and our tagline here you can see is B or n Bank we want every user to consider becoming their own bank and that is surprisingly easier said than done so we have three main clients we have an iOS Android and web platform here are some screenshots of our iOS application and I've highlighted some of the key features functionality that our mobile applications offer as I mentioned these are owned long custodial so they're fat clients or wallets so a lot of the heavy lifting is done actually on browser side or on the client themselves our back-end is purely the store some metadata and to interact with the underlying blockchain network so here you can see you have an overview of your cryptocurrency assets your current balances the live market price you have the ability to buy and sell cryptocurrencies will fit on and off-ramps you can exchange your cryptocurrencies for any other asset you may be interested in and get live pricing and I'm going to list a bit more detail on the architecture behind that and it finally common use case you can send and receive cryptocurrency funds very easily and very securely from right within our mobile apps or from within the web wallet and as I say you never have to give up custody of your assets to do this so where are we today so right now we have 34 million wallets globally and growing we're doing over 10 million new wallets a year currently that equates to around a hundred thousand transactions per day that are being processed through our software platform in total to date that's two hundred billion dollars worth of transactive ahlian has flown through our software application and platform and I think for me most excitingly that actually accounts for 25% of the global network traffic on the Bitcoin network and finally we can't have a user base that spans over 140 different countries worldwide so first up our Explorer so here on the slide you can see we have this common interface into many different underlying block chains notably Bitcoin etherium and Bitcoin cash right now there's three main section on Explorer the first is the input to look up your address your transaction hash or a block second middle section is key stats in blockchain metrics such as the current difficulty or the mempool size and finally we have a real-time view of incoming transactions and blocks that are being mined so I want to delve now bit deeper into what does it take to run a web platform like that and how do we achieve in real-time the stream of data from these on the line chains and more importantly how do I do that at scale for getting around two and half thousand requests per minute consistently and that kind of Peaks even higher with kind of significant price movements so how does it work so this is obviously simplified overview but as I mentioned we have three main consumers of our platform so that is our mobile wallets on iOS Android and the web we have our Explorer which I just showed on a pure slide and we also have a number of public api's where any individual company can build on top of our platform and they can actually use it for creating transactions sending receiving and also just consuming and adjusting the blockchain data directly without having to do the kind of hard work of integrating with the underlying chains and we're in the middle we have this data ingestion service platform so internal to us we built out a number of services that are responsible for interacting with the underlying chains such as Bitcoin etherium cash stellar etc so we create a wrapper around these that interacts with the low-level API is that they provide we actually spin up and run all of our own notes in GCP and we have a number of our servicing opponents that then ingest all of the real-time blocks and transactions extract the key insights and metrics do any kind of transformations we need and persist that within a relational database we then serve that back up to our clients on demand at scale between that we do have caching layers and a number of other technologies to mitigate issues at scale which I will go into a bit further but a key thing here is that a lot of the complexity of pulling out a very simple attribute like your balance is abstracted away from the user both in terms of the UI and UX experience you get from within our clients but also for our unified API so you no longer have to spin up your own node come a part of the public network understand their api's which are often pretty low level interpret the data which again is usually at a lower level of abstraction now you just have one API to interact with to seamlessly send receive and process all the blockchain data so how do we evolve so I wanted to set a scene on our scale of our infrastructure to support our platform both the Explorer could critic currency wallet and a number of other products so you see here we're running over two and a thousand cores currently in DCP and around nine terabytes of virtual memory you can see the graph the wallet accounts they've been created over the last five six years have grown tremendously especially since 2017 when a news kind of hit mainstream and cryptocurrencies were suddenly being discussed by every single person on the street I think astonishingly and something that we realized wasn't going to scale was that a third of our infrastructure was dedicated to our in-memory NDB cluster and this was running our Explorer and our cryptocurrency wallets to the backbone for all those and it was done ourselves by our engineering team so we're using most predominantly compute engine and running all this stuff ourselves as scale as many of you will know that doing that beyond a point becomes extremely costly but from a monetary perspective but also from the operational overhead of maintaining it upgraded it and dealing with the fallout of failures so we ran over 24 nodes the bacon are in redundancy and make sure we our fault torrent and to do any kind of scaling we cannot scale linearly or on demand we had to actually spin up a whole new cluster alongside our production cluster restore each of the underlying chains for example the Bitcoin blockchain from the beginning and now take around one week all being well and then once it caught up we can then flick the switch and move our applications over to the new Russian cluster because of the pain involved and the time it took to do this we were just last year just doubles our infrastructure overnight just to support our exponential growth not as quickly realized that this is not sustainable so beginning of last year we started to consider what are the other options we have here and how can we reduce the operational overhead of running this at scale and ensuring that our infrastructure was going to support us on our mission to grow and we define can a financial infrastructure of the world so in comes Clyde spanner so we looked at a number of different products and we decided to try a prototype and PSC on Clyde spanner that impressive thing here is that within a few minutes we were able to spin out the production cluster and have strong consistency globally distributed at scale and all of that for a marginal increase in cost as to running just compute engine and management infrastructure ourselves so early signs were promising we then switched and we architect our application started to reinvent our schema and it started to actually go all-in on Clyde spanner initially for our Bitcoin blockchain ingestion process one of the key things we did early on which really benefited engineering team is that we connected with the class banner team directly so we had a few conversations with technical PM Deepti and a number of engineers in her team and they've already helped us through the initial hurdles of getting set up on a brand new technology and really understanding the nuances of where is gonna work and some of the constraints of running at scale we had to make some design decisions early on that we've had that help would have been costly to change later I think one of the key features that really benefited us during this iterative development process was the fact that we can now the full import and export in record time so we could back up our whole database in just 30 minutes as I mentioned before it took one week to restore that we can now do it in a batch job overnight in just 1/2 hours so what this meant is that we could rapidly develop our application and services do a lot of testing and playing around with different schemas and architectures and also once we're happy we could then promote that through each of the environments dev staging pre fraud and then finally to production and now it's simple quick and efficient you'll notice here as well that we have this is our production comparison to have under half of the original nodes that we needed before now just ten nodes and all the reasons for that is because you're getting redundancy high availability strong consistency and global replication as part of the package and if finally we could scale on-demand so at a touch of a button we could double our infrastructure we could also set predefined thresholds and have that elastic on-demand final thing is we actually leveraged table interleaving which meant that we could take some of the complex queries we're running against our NDB cluster previously and reduce the time it took to run those from 30 seconds down to around 15 milliseconds so the whole migration was hugely impactful for us and our products and now we've been running this for rent six months in production overall on average I just did a comparison before it came and we are saving around 30% month on month in terms of the at Dollar Man which is pretty impressive when usually some of the hesitation of I'm using to software as a service and Sony's cloud services is the expense it's going to just creep up as you grow but actually we've seen the opposite we've not only reduced the operational overhead of managing mr. Skell we've also made our CFO very happy so how else is this data set used and one of our products do we offer as I mentioned earlier we build out a crypto the crypto exchange product again leveraging a number of client services and operating at a significant scale so this allows you to exchange a cross chain transactions and get live exchange like pricing right from a VIN you're noncustodial wallet so again you never have to send your funds anywhere and give up the custody of your assets to any one individual company or entity your private keys remain with you on your device or in your browser here's a quick demo of the product so this is on one of our mobile applications you'd simply just type in the amount you wish to sell or buy you'd get a live pricing right from within the app in real time and you can exchange between mobile pairs that we offer you finally have a summary screen confirm and that's it so what's really going on and what are some of the complexities with building out this hair for your degree smooth user experience so the key challenges security so for us blockchain as a company security is our number one priority in everything we do you may have heard of some of the horror stories from cryptocurrency companies in a space that have been hacked compromised or lost their users funds we don't be a next headline so everything we do goes for a very rigorous process volatility so in the marketplace if any of you follow the cryptocurrency pricing you'll see that it's extremely volatile maybe swinging by 20 to 50 percent in a day so how do you create a smooth user experience when the price is jumping around all over the place the first challenge public network I think it's an important one now we are relying on infrastructure that is outside of our control we're no longer just relying on our private network within GCP and the services that we've built we now have to broadcast in centers actions over network and many nodes globally distributed so whether can some of the constraints when you do that and it finally high availability I think it's kind of a given for any challenge company now but it's worth noting how do you achieve that at scale and again what are some of the design decisions an architectural decision you have to make early on to ensure you achieve that so the interesting part how does it work someone's give you a little bit of information on what's under the hood and how does the architecture actually look this is a slight simplification but it gives you a very good idea by some of the core components and interactions between those we do leverage a number of cloud services to achieve this and I'll mention where they fit into the stack but as you saw on the previous slide first of all we start with a client so Android iOS or web you didn't have a secure connection to our back-end while our client gateways and the user will connect to the swap product initiate a secure web site connection and as we'll start streaming live prices to their device these are types in the volume they wish to sell or buy and we then adjust our pricing based upon that input we have a liquidity an execution engine which is the driving force of all of our trading activity and that has connections to many different exchanges market makers and brokers and also our internal imagery that's managing risk portfolio management and pricing internally as well we've also built our own custodial solution there's a multi-tiered custody solution on which the hot wallet is at a table stack so this is the only part of it or layer that is programmatically accessible and secure in our internal network all lovers are air-gapped and have a number of other security policies and pastes so once the users happy of the price the hit exchange what happens next so our client gateways will go off to our liquidity engine and say hey I want to execute a trade to sell half a Bitcoin liquid the engine will then lock in the price and send back how much of the counter currency they wish to receive so that's for example say I want to sell Bitcoin for aetherium in parallel we initiate a request to our hot wallet which is the gateway to all of our nodes so these are the blockchain nodes stellar xlm Bitcoin beacon cash etherium etc will then generate a deposit address which the hot wallet service will persist and start listening on for any incoming deposits we then combine these transactions send it back to the client and the client name returns to the user the final amount they need to send us to receive their etherium and amp reliant side the browser and/or the mobile client will construct that transaction and sign it using their private keys and then broadcast that out to the underlying respective network none of that touches our back-end that's well done client side as mentioned earlier now it will be sent and broadcast across the public network and we wait patiently for that to hit a network broadcast event and a confirmation event and the hot water is responsible for that once those have been received off the public network we then use Kafka as our main message bus so you have an advantage of an architecture so this sends an event over Kafka one of the consumers is our client gateways that picks it up and in purses that we then compare that against our state machine transition through the lifecycle say hey deposit received we now need to Pender withdrawal we update the user and say hey we receive your deposit we're now going to initiate the request for you we then make a call back to the whole wallet and send the amount we wish to withdraw and the deposit address that was sent from the client originally again that's them broadcast out on the public network the client will then receive the funds in due course usually within half an hour and we notify them via push by email SMS I mean one of the interesting cases that happen recently is that these public blockchains can have many different use cases apart from just transferring a store value and one of them is actually being a leverage for marketing so what that means is actually every time anyone sends a transaction on a Bitcoin cash network and someone is listening because you have this public ledger they're listening for this address any new address that appears they didn't send you a little marketing message and what does that mean materially it means that actually we as a company on a repositories receive more funds than the user actually sent and also the user receives slightly more funds than we send them they also receive two transactions that are one so this was kind of a very interesting use case where we had to be flexible and defensely program for this in the future and finally the the note gateway to the bottom are really the data ingestion service platform that I mentioned previously and our our way of wrapping each of the underlying blockchain notes so one of the other interesting things that we've managed to do is build out a hardware device which is a secure way of storing your cryptic currency assets offline this has full instruments with all of our platform and software so you can use our swap product as I show you before and your keys never have to leave the physical device so this is hugely beneficial to all users who are security conscious and maybe they'll trust the terminal or workstation they're using and we've managed to achieve this leveraging our existing interface and software some of the key benefits of using Google so I mentioned a few of these already but I wanted to kind of summarize and highlight these before finishing up so one of the things that GSP is really allowed us to do is scale up our infrastructure on demand when you're dealing with tens of millions of what accounts globally it's important that you're not constrained by the infrastructure that you are using we've had many cases when the prices moved significantly and suddenly the number of users that were onboarding everyday has gone up five or ten times and we've had to actually scale poor infrastructure significantly during those periods I mean in the peaks of the last few months we've seen over a hundred thousand new wallets being created every single day and up to 101 million in a given week so the significant strains on our infrastructure that we have to account for and one of the things we do do as I mentioned previously is adding a number of caching layers take a lot of advantage of CDN and do a lot of load balancing across many instances for a most part all of our infrastructure is stateless so means we can horizontally scale it on demand also on the previous architecture we're leveraging cloud services where possible it means that our team can focus and hone in on some of our very specific domain complexities and challenges and don't worry about running our infrastructure scale and solving the problems that Google have been doing for many years today it spend less time energy and effort Imaginarium structure and more time focusing on building what we believe to be the future of Finance as I mentioned we have high availability so we're leveraging cloud sequel that we're leveraging spanner we use a number of other services quite broadly across our architecture as you can imagine we have a lot of American micro services within our architecture so being able to just quickly spin up a highly available redundant and scalable database at a click of a button it is very powerful and we're using both Postgres and MySQL engines for that our third point is that it's engineering friendly I think all of our engineers whatever their skill set or focus enjoy the GCP experience whether that's because of using the CLI and programmatically writing scripts around that or using the interface itself to dive into problems and debugging issues and finally the fourth one which I mentioned earlier of our spanner story is the technical support I think a lot of people didn't realize the amount of support that Google offer you as a company we can tap into a wealth of knowledge and domain expertise through our camera managers and customer engineers and we do that pretty regularly we've had many conversations comparing Google products to other open source technologies and the pros and cons of using them so another story that happened last year we were just trying to decide on the correct message bus architecture for this training product and for many others one of our key requirements was sequencing so we then spoke with the technical PM's from the pops up team and had a real candid conversation about what were the pros and cons of using pub/sub above Kafka and a net result of that conversation was that we used Kafka and that was their recommendation I mean it's quite refreshing when you can actually connect with the engineers at a cloud company and they recommend a product which they do not support or sell themselves [Music] you [Music] 