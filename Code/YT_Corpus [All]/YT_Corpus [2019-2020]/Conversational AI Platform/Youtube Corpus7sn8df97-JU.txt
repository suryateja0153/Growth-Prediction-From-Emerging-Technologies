 all right we are 15 minutes in and oh it doesn't doesn't look that compelling i'll be [Music] [Applause] honest it's the holidays and there is nothing that that makes me want to do more than machine learning today i'm going to build a machine learning model that will analyze recipes and then dream up an entirely new recipe that i'll bake and eat right before you hear today and to make the project a little bit sweeter i'll add just a sprinkle of model explainability so we understand why our model is making the predictions that it is i'll be joined by sarah robinson sarah is an ai expert and baking extraordinaire who works with me at google hey sarah hey dale thanks for having me i heard that a couple of months ago you used a machine learning model to come up with a new recipe that you baked can you tell me about that so i've been baking a ton over the past few months and after following a lot of recipes i started to notice that a lot of baking recipes follow a pattern so i started to wonder since machine learning is all about finding patterns and data could i build a machine learning model to predict what i'm making given a list of ingredient amounts so i built a model to predict whether a recipe was a bread cake or a cookie so we're gonna do exactly the same thing here today we'll build a model that takes a list of ingredients and then predicts bread cake or cookie and then we're gonna use that core model to come up with new recipes that we'll bake right awesome let's get started so step one is to collect a data set of cookies cake and bread recipes we gathered about 700 recipes next we have to do a bit of data preprocessing for example there's a lot of consensus that banana bread and pumpkin bread are actually cakes even paul hollywood agrees so we had to move the banana and pumpkin breads from the bread category into the cake category next we slimmed down the recipes to just their core ingredients like flour eggs butter sugar and a couple more we also converted all of our ingredient amounts from cups and sticks and teaspoons and tablespoons into one single measurement unit we use ounces okay so here are all of my recipes they're converted into ounces i'm cleaned up and labeled in a google sheet to build my model i'm going to use a tool in google cloud called automl tables which is a no code tool for building machine learning models to analyze tabular data like spreadsheets or databases okay i'm opening up tables and i'll import my data from that csv i just showed you i have to select the bucket where i want data to be stored and it'll take a second to import when it's done i can click on my new data set and as you can see a couple of stats about the data are automatically generated like whether certain columns are missing values and also this useful field correlation with target which says in isolation how good is each of these columns that predicting whether or not something is cake bread or cookie i've also selected a target field which is what we're trying to predict which is in this case type that i've already selected to train a model i'll click the train model button name my model say how long i want it to train for specify which columns i want to include i don't want to use the name of the recipe or urls or ids or anything like that and then i click train model and wait this part could take a couple of hours when my model is done training i can see how well it did in the evaluate model tab here i can see lots of stats on model accuracy and if i scroll down to the confusion matrix i can also see how often my model correctly predicted recipes so it was most accurate for bread which is labeled correctly 93 of the time and a little less accurate for cookies which it confused for cake 21 of the time when i'm ready to use my model i can hop into the test and use tab and here i can make predictions right from within the ui so i can fill in the values for a cake recipe click predict and boom the model thinks this is cake which is correct so sarah was able to build a model that takes a recipe and then predicts cookie cake or bread but the inquisitive baker might want to know what is it that makes a cookie a cookie what gives it that chewy crunchy property that cookiness if you will and what makes bread fluffy and cake spongy in other words we want a model that not just makes a prediction but also explains what ingredients it was looking at when it made that prediction and that's called model explainability right we want to understand how important each ingredient is to the model when it's deciding whether something is a bread a cookie or a cake i can take a look at feature importance which tells me how important different ingredients are to the overall model's predictions so in this case butter sugar and yeast we're really good at helping differentiate the baked goods now even though butter might be important to the overall model it might be that different ingredients matter more depending on the recipe so if i go into the test and use tab i'm going to put in a cake recipe and then i'll hit this generate feature importance box hit predict and then i'll be able to see how ingredients matter for a specific recipe here egg and fat got the highest future important scores so we can assume that they're the most important thing the model was looking at when it decided that this was a cake okay so now i'm gonna try something really radical i'm gonna bake not a cookie or a cake but something that our model deems to be a split between the two a cakey if you will and i'm gonna bake something that's a half bread half cookie i'm gonna call it a breaky to find a breaky recipe i adjusted the ingredients in the model ui until our model predicted that our recipe was about equal parts cookie and bread same for dale's cakey all right sarah are you ready to bake yes let's do it on your marks get set bake [Music] none of my training prepared me for this right here's the thank you [Music] good luck little cake cookie kiki here is what we've got okay i guess i'll try to pry it from the pan it does taste like a cookie but it is like a little bit more airy i can't tell if it's cooked all the way [Music] did not work exactly the way i had poked it might work this is actually pretty good [Music] okay it's kind of nasty so yeah i guess it's a success i wonder if i put i put the right amount of flour or double the amount of flour so i think i kind of flubbed that recipe something with the flour but sarah then went back and baked it herself and her kiki came out just fine so i guess we'll have to attribute that to human error if you want to know the details of this project and steal our recipes make sure you check out the blog post linked below happy holidays and see you next year you 