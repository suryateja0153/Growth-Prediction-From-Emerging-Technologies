 I don't know where you arrived from but if you didn't arrive from these the previous videos about training your own neural network you might feel a little bit lost because what I'm gonna do here entirely depends on the previous few videos where a trained model to classify musical notes based on mouse clicks in a p5 canvass so what I'm gonna do in this video is change this word from classification I'm gonna do it right now to regression and this is going to drastically change what the neural network outputs and how I use that output but before I start changing anything else in the code let me talk about what I mean by regression in the context of machine learning first let's recap classification the idea of classification is that the neural network is going to receive some input and end up with a discrete categorical output meaning it's going to assign a label C D or E we can think of that as there's three light bulbs are those like little drawings of lightbulbs each light bulb is associated with one of the possible labels or categories classifications and if a neural network decides that this particular input corresponds to the label II then maybe this light bulb would light up and you could do this you could build in Arduino with some LEDs and have the results of machine learning classification light up a particular LED a regression you could think of the output being a slider or maybe a dial as the data comes into the neural network the dial ends up at some value between some minimum and maximum the output is numerical continuous output so classification is one of a discrete set of possibilities and regression is any value between a given range now you can still have multiple outputs in a regression because you can have multiple continuous values but in this case I want to redo this example by having a single output and then output be the frequency value so if I change the task to regression now I want my output to be tied to a frequency no longer do I want during the training process to give target labels I want to give target numbers so that it will guess a number as part of the regression output so this is my code for data collection when I click the mouse the inputs are an x and y and the target is a target label but I don't want it to be a target label anymore I want it to be a frequency and I can figure out what that target frequency is by looking it up in this particular JavaScript object so I can say let target frequency equal notes target label and in fact that's something that I'm already doing down here so let's replace this with target frequency now ordinarily I might remove target label completely as a variable in this system because I don't need the label anymore for the machine learning model not using CDE and not using the note name for training the model but while I'm collecting the data I still would like to see the note C or a or G because I think that's less awkward than drawing the frequency number in the window so crazily I think I'm actually done with the with all that I need for the first two steps the first two steps being collected data and train the model I've changed the task to regression and now I've changed the output to a single output node that just has a frequency value so I should be able to run all of the bits of code that I did before and have it train the model let's see if that works [Music] all right collected some data let's train the model and it worked I mean it worked in the sense that I didn't don't see any errors in the console and I see a nice graph with the loss going all the way down incidentally that lost like it went like way down very very quickly so I probably don't need 200 epochs maybe this regression problem is a little bit easier for it to learn more accurately who knows but it optimized very quickly so now that collecting data and training the model is done I need to just do that last stage of basically deploying the model and making predictions with new data and I don't think this is gonna work I didn't I haven't adjusted the code at all it's still looking for a label and all that so who knows what will happen you yeah it's just it's first of all it's writing the word frequency here and just playing one particular note so let's go look at the prediction code and see what need to adjust for a regression first thing is because we're no longer doing classification we shouldn't call model dot classify with the given inputs we want to change this to model dot predict so predict is the function name for a regression classifies the function name for a classification let's collect it again and retrain the model [Music] I mean it's trained let me click into the canvas and let's look and see what came out here so this is what I get back I get back an array I only have one output in this particular model and so I look at the zero element of that array this is the value it predicted and I have a label that in case I had multiple things I could sort of know which goes with which so based on what's here I want to change this to results index zero dot value that's the frequency that I want to play now what do I want to draw maybe I'll actually look at the number so let's actually also draw that but maybe we'll take away the decimal place by using floor just so it's less busy' takes up less room in the canvas itself okay let me add the save data feature before I collect the data let me just change them for v pox to 50 because I clearly don't need 200 epochs now I'm gonna collect a bunch of data so let me make a bunch of C's I clicked around somewhat arbitrarily but let me now actually save this so I don't have to always collect the data again every single time so I'm save that to a JSON file I am now going to train the model what do I expect to happen before when I was doing classification I would expect to hear a see when I clicked near the C's and F when I click near the FS and I would hopefully get something similar to that like does this sound like a C to you you can hear it's changing though F but look I'm getting a different note every time [Music] because the regression once again remember is like a dial so if I have the note C over here and I have the note e over here ideally when I click here I'm gonna get a note that's in between like a D but the notes are completely irrelevant here it's really all about the numbers the idea being that if I have the number 200 here and I have the number 300 here clicking in between is like having a slider or a dial going between 200 all the way up to 300 and while this works in a somewhat obvious way in this two-dimensional space with me putting a lot of C's over here and a lot of G's over there you could imagine how this could become a much more sophisticated musical instrument or the output doesn't even have to be outside to a musical frequency a sound frequency there's so many possibilities but now we've seen that in addition to using the ml5 neural network for classification you can also use it for regression so what's next let's think of some exercises for you to do so first of all I right now I have to like click around to hear the note but there's no reason why in this particular example I couldn't move the mouse around and have that frequency adjust so have it could take I don't need an envelope anymore maybe I'm this continuously playing a note so that might be something that you try you can play around with saving the model saving the data all that stuff that I showed you in the previous two videos with this regression example as well but ultimately I think what I want to look at here and I will come back and do another video is what what's what is some what are some ideas for inputs that allow for more creative or surprising results than just mouse clicks and I think the one that I want to show you is using pose net so post head is also a machine learning model that takes an image as the input and guesses yours where your parts of your body are so it can find your nose and your eyes and your hands and your elbows a whole set of key points on a human body why not training a model to recognize as the inputs certain poses and then have a particular output associated with that so I'm going to build a project using all of this stuff in the next video I think I'll make a coding challenge build a project that does pose classification with the ml5 neural network library or maybe it'll be posed regression I don't know we'll see it'll be in the next video thanks for watching and look forward to all of your questions and comments and all that sort of stuff good bye [Music] 