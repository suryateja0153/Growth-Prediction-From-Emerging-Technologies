 hello and welcome to another beginner's guide to machine learning video tutorial with ml5 yes very excited about this one typically excited about the video just like me but this one I'm particularly excited about because I'm gonna look at something that has recently arrived in the ml 5 jazz library so first of all used version zero point four point two or more recent version perhaps but that's the version I'll be using in this video and I'm gonna look at this functionality in the ml 5 library called ml 5 neural network it is a function in ml 5 that creates a empty or blank so to speak neural network most everything that I've showed you in this video series so far has involved loading a pre-trained model so a neural network architecture that's already been trained with some data and in this video I want to look at making an empty a blank slate configure your neural network collecting data training the model and doing inference and the context that I want to look at that is with real-time interactive data so I'm gonna come back and maybe use some more traditional data sets there's a data set that I that that's on the ml 5 examples with a titanic survival data set I have the data set from my color classifier series so I'll come back and show you some examples of those as well but in this first video I just want to do something very generic which is create a blank neural network use mouse clicks to Train it and then then move the mouse around for it to make guesses or predictions and that might sound like a weird thing to do it hopefully will start to make sense as I build the code and step through all the processes I also want to highlight for you the Weka nater project which is a free open-source piece of software created by Rebecca free brink in 2009 for training machine learning models and I would especially encourage you to watch Rebecca free brings talk from the i/o conference in 2018 where she talks about creativity and inclusion in machine learning and goes through some demonstrations of with Weka nater and processing and other pieces of software so a lot of the work that I'm doing with ml 5 is Alma is entire really based on recreations of many of the example demonstrations that Rebecca fie brink made and has done research about for years and years with the weka Nader project so in fact the examples that I'm going to make in this video and the next one and the next follow-ups are direct ports in a way of some of the original weka Nader and processing examples but I'm gonna do it all in javascript in the browser with p5 and the ML 5gs library there's also a fairly lengthy history of Creative Artists training machine learning models in real time to control musical instruments of performance a visual art piece and I would encourage you to check out some of these projects our guide for figuring out how to write the code is going to be the ml 5 website and there's a page on the ml 5 website for the neural network function but before I start diving to the code let's take a minute to talk about what a neural network is now by no means in this video am I going to do a comprehensive deep dive into what a neural network is and how to code one from scratch I will refer you to many other wonderful resources where you could do that deep dive starting with the three blue one brown video what is a neural network and some of the subsequent ones I have also I have a 10 to 15 part video series where I build a neural network from scratch in JavaScript based on a particular book called make your own neural network that is in Python I have other videos where that our guides around machine learning concepts where I talk about different kinds of neural networks so I will link to all of those in this video's description but here I'm gonna use the white board over here just to give you a very zoomed out high-level overview of what I'm talking about so a machine learning system in the most basic sense involves inputs and outputs so let's say for a moment that the goal that I have is to train a machine learning model to use my body as the input so maybe how I'm moving my arms and legs and head that will be the input and the output would be a music instrument a note that's being played so I could somehow play different notes based on how I move my body this is an area that's covered in great detail in Rebecca fee brings course machine learning for artists and musicians one way that I might boil this idea down into its very simplest version is think about a 2d canvas and it's very convenient that I'm using p5 because that's the thing that exists in p5.js and what I'm going to do is I'm going to say there's a mouse in that canvas and the mouse is going to move around the canvas and based on where it is it will play a particular note now of course I could program this same idea with an if-statement but this is really what it means to work with machine learning instead of programming the rules explicitly into code what I'm going to do is give the code a whole bunch of examples and have it learn those rules so I want to demonstrate that process in a scenario where it's very obvious how it's working so that then we can build on that into much more complex scenarios the steps are collect data to train model then three I guess we can call this prediction so we could that's also sometimes referred to as inference that's really when we're deploying the model we're making use of the model right here this is my representation of the model so in this case if I want to start with a classification problem and I will show you demonstrations of classification and regression I'm going to have two inputs input one and input two often refer to as X's in a sort of machine learning context those inputs are going to go in to this machine learning model the output is going to be one of let's say three different categories so I'm going to have three outputs C D and E so two inputs and in this case three outputs my diagram looks a little bit weird so I'm gonna fix it up for a second now all this time I've just been putting the letters and in here for machine learning or maybe referring to this as a model because in truth other things other kinds of algorithms other types of ideas beyond a neural network could slot in here but the ML v generic blank machine learning model that you can train is a neural network one so if I were to try to zoom into this for a moment what I would actually see is something that looks something like this this is my zoomed in diagram of really what's going on in here a neural network is a network of neurons technically this is a feed-forward multi-layer perceptron because the inputs which are represented right here get fed through these connections they're weighted connections and get added up all together and arrive in this layer which is known as the hidden layer and there can be multiple hidden layers and different kinds of hidden layers but that data is summed and processed through a mathematical function called an activation function and then fed out of the hidden layer and into the output layer and the output layer after all of the hidden outputs are summed and passed through an activation function we get a set of numbers out and those numbers might look like this point two point seven point one meaning a 20% chance of being category C a 70% chance of being category D or a 10% chance of being category E so there's a lot more details of what's going on in here and I certainly once again would refer you to the various things that I'll link in this video's description the idea here is that a neural network is a machine learning model that can be trained it can be shown a lot of examples of inputs with their correct corresponding outputs and it can tune all of the weights of all these connections so that when it later gets new data it can make appropriate predictions this is everything that the ml5 library will take care of for you and for us we're going to really just be working with the inputs and the outputs collecting our training data training the model and prove addicting outputs now that I've gotten through that explanation I'm I really want to just write some code and show you how this all works sorry to interrupt it is me for about four days in the future I did actually continue this this was recorded during a livestream and I did go all the way through and make this example but I made some pretty significant errors in how I used the ML v library so I've come back to re-record and and try this again I'm sure I'll make other mistakes and things will go wrong but if you want to watch the original version I'll link to that in the video's description but I'm gonna start over right now quickly want to point out that in addition to the p5 libraries I've added a reference to the ml 5 library version zero point four point two in index of HTML in my blank p5 sketch I can add an ml 5 neural network so I need a new variable I'm gonna call that model and I'm gonna set that model equal to ml five dot neural network whenever I create a neural network object I need to configure it I need to give it some information about what's going inside there and the guide for doing this is the ml 5 website so here on the ml 5 website you can see this QuickStart which has some sort of sample code a documentation of the usage of the neural network function and a bunch of different ways of initializing a neural network and all of these involve a variable called options the idea is that I'm creating an object that's going to store the properties of the neural network and then when I call ml 5 neural network I pass that object in so for example looking here at my diagram I can see there are two inputs and three outputs that's something that I could configure in the options inputs to outputs three at a minimum this is all you need to configure an ml five neural network how many inputs how many outputs if I scroll through the ml five documentation page you'll see there are a variety of other ways that I could configure a neural network for example I can actually give it a data file so ml 5 has functionality built into it that can take a CSV or comma separated value file or a JSON data file and configure inputs and outputs based on what's it that's in that file so I need to come back to that and cover that in a separate video but actually the way that I want to do it here is actually this particular way instead of specifying the number of inputs and the number of outputs it's much more convenient for me to name them so here are the inputs an X and the y and here are the outputs of label now this is not something that the actual mechanics of a neural network uses inputs don't have names outputs don't have names these are just numbers and flowing through this feed-forward Network but for us from a zoomed out view we can maintain the neural network and use it more easily by naming things adjusting that in the code I'll have an X and a Y these are my inputs there's two and they have names x and y the really confusing thing here is what to do about the outputs so while technically speaking the way I diagram this is correct and there are three output neurons each scoring a probability for all three categories from the zoomed out view we can think of it as the neural network ending up with one singular result what is the label it's classified the input data in so ml5 is going to handle the number of categories and how to score all those things for you so if we're naming stuff I can actually just write here say label and as I start to create the training data I'm gonna come back to this and explain where that number three comes back in there's one more property to the options that's very important for me to specify and that is the task that I want the neural network to perform and in this case the task is classification the other task that I could have specified is a regression and I'll come back and do other examples that use a neural network to perform a regression we'll see what that is and how that works in future videos in this case though it's a classification because I want the neural network to classify the input into one of three discrete categories so now we are ready for the first step collect data and this should really say collect training data collecting training data means I need to have a set of inputs and they're correct corresponding outputs and in this case I want it I want to collect that data through user interaction and I'll do that with mouse clicks so I'm gonna write a function called Mouse pressed and I'm actually going to get rid of the draw loop and just to get started every time I click the mouse let draw a circle on the screen now sex mouse Y with a radius of 24 and let's also put a letter in the center of the circle so now as I click I'm collecting data points I'm collecting x and y's that go with the category c but i also want to collect x and y's to go with different categories so let me do that through a key press I'm gonna create a variable called target label and I'm just just give that a default value of C and I'm gonna add key pressed and I'll just set target label equal to the key that I press then I'll draw the target label instead so here's a bunch of C's now I'm gonna press D here drew bunch of DS it's lowercase let me chain let me add to uppercase let's make sure this works a bunch of C's some DS and E now of course I could do other I could do any letter right now so I probably would want to add some kind of like error checking or determine what I want to let be the actual target labels but for now but I'll just let it be a free-for-all and just restrict myself to C D and E I didn't actually collect potato though I'm just showing you a very crude user interface for indicating where I've clicked and what letter I've pressed so let me create a variable called training data I'm gonna make that an array then whenever I click the mouse I'm gonna say my inputs are now because I named the inputs when I configured the neural network I can create an object with an X and a Y and also another one with a label you'll see X is Mouse X Y is Mouse Y and then I'm gonna make one called outputs and really though this isn't these are the outputs but this is called a target that's a word I can use here because this is the target output that I want them neural network to learn given these inputs so I'm gonna say target equals label and the label is the target label and actually I don't need this training data array I was thinking I wanted to use that so I could store all the data myself in an array but and that that could be useful in a lot of contexts actually all that I need to do here is just say model add data inputs target so this is a function in the ml five neural network class where the model can accept training data as pairs of inputs and target and I need to make sure that the inputs and the target match up with how I configure the neural network and they do because I have an X and a Y and a label and now I have an X and a Y and a label here now rightfully so you might be asking yourself what happened to the fact that we were restricting ourselves to three possible categorical outputs and this is where a higher level library like ml5 comes in it's just saying I know you're gonna do classification I know I'm gonna give you a label I know you're gonna give me some training data so just give me all the training data I will count how many possible outputs there are after you've finished giving me the training data so as long as I give it a bunch of examples with a see a bunch of examples with addy and a bunch of examples with an e it will configure itself to work with a limit of three possible labels as the output let me quickly test to see if I get any errors c d e that seems to be working good I am ready for the next step training the model this is a really easy one for us because the ml5 neural network class has a function called train so I can just call that train function certainly it would make sense for me to build some kind of user interface here but I'm just gonna keep going with my keep rest method and I'm gonna check and say if the key pressed is T then call model dot train when I train the model I can also give it some options that set various properties of the training process itself so I'm going to create another options object information on what those options are is on the ml5 documentation page I'm gonna just use one option I'm gonna set something called an epoch so I'm gonna set the number of epochs to 100 so what is it epoch if I look at my training data I have 30 data points and I'm gonna feed all of those things into the neural network I'm gonna say hey neural network here's an X Y that goes with the C here's an XY that goes with the seat now importantly one thing that's important that ml5 does for you behind the scenes is it shuffles all those into random order because the neural networks not going to learn so effectively if I send it all the C's and all the DS and then all the es I want to send them in a random order sending it all 30 of those is one époque typically that's not enough for the neural network to learn the optimal configuration of weights so you want to send it in again and again and again so if I have 30 data points and I train for a hundred a pox that's sending stuff through the neural network 3,000 times now in truth there's more to it than this there's something called a batch size because I might consider the data in smaller batches out of those 30 and that can affect how I adjust the weights but we don't need to worry about that it's setting the number of epochs is a good starting point for us to start thinking about the process of training a neural network so I can pass it the train function the options and then the train function also has two callbacks one is optional but I'm gonna use them both there's a while training callback and then a finished training callback the idea is that there's a number of events happening while you're training the neural network the wild training callback is executed every epoch so that'll get executed 100 times and the finished training callback is executed when the whole thing is finished so let me write those functions in finish training I'm just gonna add a console log while training actually receives information about the training process and it receives two things an epoch and a loss these callbacks really worked as debugging tools for me to look at how the training process is going oh that epoch finished what was the loss and I need to come back and talk about what loss is but I can really look at what's happening while it's training and then know that the training has finished and they'll five however has built into it visualization functionality that's part of tensorflow j/s itself particularly library called TFS so and I can enable that by adding one more option to my neural network configuration and that is debug true if I add debug true I'm going to get much better tools than what I've got here with my own callbacks there's one more thing that I've missed here and that has to do with normalizing the data what does our trading data look like remember I've got this p5 canvas maybe it's 400 by 400 any given input is a mouse click into that canvas like here and so this might be the mouse location 100 comma 100 so that would mean the literal number 100 is being fed into the neural network but neural networks are generally tuned to work with data that's all standardized within a particular range and there could be a variety of ways you might want to use one range versus another but in many cases you always want to squash your input data into a range between 0 and 1 and that process is called normalization so that would be really easy for me to do myself because if I know the width is 400 I could just say 100 divided by 400 is 0.25 so I could apply this normalization math myself in the code but ml5 has a function built into it that you could call right before you train the data that will look at the minimum and maximum of all of your input data and normalize it so coming over here I can call that function right before I train the model by saying model dot normalize data and now I think I am ready to actually train the model for the very first time and complete step two let's give it a try let's add a console.log to know that the training process is starting let's collect a lot of data now I'm clustering all my C's and DS and E's together because I want to create a scenario that should be easy for the neural network to learn again I don't need a nurse or to figure out that there's season the top left and DS at the top right and E's on the bottom but if the neural network can learn this scenario more complex and interesting ones it could possibly learn as well so again if you remember my exciting interface was to press the T button so I'm now going to press it and this is the debug view that pops out this comes up because I put debug as true and what you're seeing you so you saw the epochs being console.log here you see that it says finished training but this is showing me a graph of the loss the x-axis is the epoch and the y-axis is the value of the loss so what is loss if this particular data point that I'm sending into the neural network is paired with the target of see when it gets sent in right it gets the X gets sent 10.25 I should make the Y something different like let me say the Y is 200 the Y gets sent in as 0.5 the neural network is gonna guess C D or e then it has to decide did it get it right or did it get it wrong was there an error so if it happened to guessed C it's gonna I've gotten it right you can think of the error error as zero if it's gotten it wrong if it gets to D then there is an error now what the value of that error is actually has to do with the scoring that it's doing based on its confidence that it's one label or another maybe it was like 99% chance sure it was a D it's gonna have a big error then but it was only like 60% sure it was a d and 40% sure it was a C then that error is gonna be smaller but that error another word for that error is loss so as it sends all of the data over a given Apoc through the neural network it's going to summarize all of the errors into a loss value so as the neural network trains the model with the training data over and over again EPOC by epoch that loss should be going down it's getting better and making more correct guesses over time based on what the graph is doing here this indicates to me a couple things one is it's learning kind of slowly so one possibility could be just give it more epochs so maybe what I actually want to do is go back into the code and give it 200 epochs instead of 103 the matters have very very very small data set here so with lots of little bit of data I need a lot more epochs it kind of makes it feel like it's more data another way that I could tackle this issue is by adding another property to the options object when it configure the neural network and that property is something called a learning rate the learning rate refers to how much these dials should turn based on the errors that it's seeing as the neural network is looking at the training data so it got an error should I turn the dial a lot or should I turn it just a little bit if I turn it a lot I might get closer to the correct result but I could also overshoot that correct result so this kind of hyper parameter tuning is on a fancy word for saying well I want to try this learning rate on this number of epochs these are the kinds of things that you could experiment with by training your model over and over again with different properties but for me right now I'm going to leave the default learning rate and just experiment with the number of epochs and maybe in some future videos I'll come back and look at some of the other parameters and what might happen as I tuned them let's try one more time collecting data and training the model ooh wacky [Music] so this is really good I want to see that loss go all the way down we can see at the very end here it gets down to zero point zero nine six three one four and you could also see that it's starting to level out that indicates to me that if I'd given it more epoxy maybe I would squeeze out a tiny bit more accuracy but this is pretty good enough and that my friends is the end of step two guess what only one step left and this one is prediction meaning the idea now that I've trained the model is I want to give it new inputs I'm not giving you a target let's tell you what the answer is neural network you've learned you've thought about this a lot I've taught you all I can teach you now make some guesses for me to implement this I think something useful could meet for me to create a variable that's like the state of the program and the beginning the state would be collection and when the state is collection that's where I want to set the target label and add the data to the model when I press the key key then the state is training and then when I'm finished training I could say the state is prediction and ultimately I think I just want to draw those circles during the collection process because if the state is prediction then I want to ask the model to classify the inputs the idea being that there are no targets the model is trained here are some inputs classify them for me so where do I get the results back I need a callback I can define a function called got results just like all the other ml 5 stuff that I've looked at in previous videos there can be an error or there could actually be results if there's an error don't do anything otherwise let's take a look at the results let's try this again I can't believe I have to collect the data again wouldn't it be nice if I could save the data so that I don't have to collect it again if I've made changes in my code in fact it is and I will come back into a separate video all about how to save the data and in fact I could also save the Train model so I could load that train model to another sketch all sorts of possibilities and I will also come back and look at saving data and saving the model and reloading those things but for right now I'm just gonna because I have I have the time to do it and I can speed through this when you're watching it I'm just gonna constantly recollect the data over and over again [Music] the model is trained to do things correctly it'll now show me some results when I click into the canvas I'm gonna click over by the C's this is good I got an array back that results array it has three objects in it what are those objects the first one is the labels see with a confidence score of 88 1280 8.5% that's good that's what I should have gotten the second one is D a confidence score of 7% third one a confidence score of over I guess around 5% this is exactly what I expect these confidence scores are what the neural network is really producing behind the scenes but and that the ml5 library has taken those confidence scores associated with in with given labels and then sorted those labels in order of confidence so I will always have in result index 0 dot label the label it thinks it should be so what I can do is grab this drawing code and I can put it right down here maybe I'll change it to blue with some alpha and instead of target label I'm looking at results index 0 dot label now the truth is I shouldn't be using mouse X and mouse Y here I should be actually saving those inputs maybe in a global variable of passing them but I think that prediction is gonna happen fast enough that I'm not really gonna be able to move my mouse so I think it'll work out ok let's give this a try oh I gotta collect all the data again and train the model now I should be able to click here and see you see oh I did and addy I did Annie let's move along here and see when does it change to see it you just see there that's like a decision threshold like thingy you don't would be interesting to do we could draw a map of what all the decisions are across all the pixels that's a project you should do and click over here I should get addy see what's over here addy addy addy Andy oh this is fascinating what I love it this works so guess what this is actually done but the whole point of what I wanted to do here was to have it play sound because I want this to be the beginning of an idea that I could maybe play musical notes by moving my hand around imagine again the inputs being instead of the X Y of mouse clicks the X Y of some type of hand tracking or I could actually have more than just two inputs because I could take the X Y of this and the X Y of this and the X Y of this or whatever kind of other data maybe you've walked up a whole bunch of sensors and you've got a bunch of different force sensors and an Arduino and those could be the inputs to your neural network so many possibilities but I'm not gonna explore all those possibilities right now at least but I do want to show you at the output of playing a note I made in a video tutorial that you could go back and watch if you want about how to use a sound envelope with a sound oscillator in p5 to generate a tone and so I'm just going to pronounce a Toronto lope I'm gonna paste all that in set up here and this by the way has changed to the full word envelope since I last made that tutorial and now whenever I click the mouse I should be able to say envelope play so if I do this when I click you hear this note play but I want it to play C D or E and honestly I could make a lot of notes right now since I can have more than just three categories but let's just stick with C D and E what I need to play a particular note is the frequency of that note and I can find this on this Wikipedia page about frequencies and piano notes so I'll start with c4 d4 and e4 I'll make an object that's look up table for those notes so I have the C D and E all matched with their frequency I should make sure that the envelope and the wave are global variables because now when I play the note I could set the frequency to notes index target label this will look up the numeric frequency associated with that label and set the sound oscillator to that frequency CCC D D D EEE now if I press F it's not going to change because I didn't put F in that lookup table but you could add more notes add more notes or notes then guess what all I need to do is take this exact same code after prediction instead of the target label and let me just put this in another variable so it doesn't look so insane results index label draw the label then play the note associated with that label I think this project is done let's try it I'm going to collect the tape again I'm really coming back and showing you how to save the data [Music] I'm treating the model moment of truth time to do prediction I kind of want to do this as I just drag the mouse around oh and guess what this is such a good demonstration of a regression so I should come the next video I should do it just come back and do this exact same thing but with a regression what would that be instead of having categorical output which you could only have a scene II or D or an E a regression would have numeric output if you think of it as a slider so maybe if the frequency of C is around 262 and the frequency of D is around 330 maybe in between I play a note I play like C sharp that's in between C and D right over here that would be a regression but I'll come back I'll explain all that and do that in a separate video tutorial so there's too many directions you could go in just from watching this at a minimum you know if you're watching this video and you want to try it see if you can recreate this process you're gonna find it quite frustrating to have to like collect the data over and over again so you might want to skip ahead if one of those well if I have those videos ready to see how to save the data you've collected but certainly doing this with more notes and thinking about the input in a very different way would be a good starting point for you to try so thanks so much for watching many more tutorials about the ml 5 neural network functionality to come and I'll see you in those where we treat more bubbles [Music] 