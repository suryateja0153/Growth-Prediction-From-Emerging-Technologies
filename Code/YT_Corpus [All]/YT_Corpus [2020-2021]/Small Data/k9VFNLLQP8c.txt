 hello my name is eric chow and i'm from the university of california san francisco and today i'm going to give you a talk about single cell so brief outline we'll cover what single cell sequencing is with a big focus on rna sequencing we'll cover plate-based methods microfluidic methods combinatorial indexing methods and then talk about other single cell sequencing methods that don't really necessarily relate to rna so a big question that comes up is why do single cell sequencing and a good analogy of this is this fruit smoothie analogy so let's say that you're working with a blood sample and you want to take a look at the expression profile of within that blood sample so blood is a complex mixture of many different cell types you have b cells t cells macrophages and neutrophils similar to a smoothie where you have lots of different types of fruit and let's say you're really interested in the characteristics of say a raspberry or an orange but instead of analyzing that raspberry or orange you mix it up with a pineapple a banana some strawberries blend them all together and then that's what you're tasting it's going to be very difficult to figure out what tastes are coming from that raspberry and so the same thing when you're trying to analyze data from a single cell versus a bulk sample it's really advantageous if you can get data specifically from individual cells as opposed to making a bulk measurement and one really cool thing about single cell sequencing is that with the data you can identify lots of different cell types and so this is a representation of a data set from a blood sample and in this case many thousands of single cells were processed together in parallel each of those indic individual single cells transcripts were sequenced and analyzed and you can detect up to you know the 20 000 different genes that are present in the human genome and so it's really hard to depict data in 20 000 different dimensions so one common method is to collapse that down into two dimensions using dimensionality reduction there are many different methods which we won't be able to go over today but you end up with a plot that looks like this where each small dot represents a single cell and these dots are clustered and cells that are clustered closer together are more similar to each other and so you'll end up with these clusters of different cell groupings that are represented on this plot and so this by itself isn't useful you can tell that you have different cell types there but you have no idea what they are but you can dig into the data and for instance if you can go into each of these clusters and ask what are the transcripts that differentiate say this cluster at the top from this cluster next to it and you do this for the different genes you can use this information to then classify the different clusters and identify them so for instance in blue you have b cells in red you have activated cd8 t cells you have dendritic cells in this purple color cd4 monocytes in green nk cells in gray and you know the list goes on and on you can identify lots of different cell types by looking at the transcriptional profiles within each of those clusters and so if you've watched some of these flow cytometry videos on ibiology you'll note that you can get the same information from flow cytometry so why do single cell sequencing and one reason why is that these clusters can be further broken down and analyzed by those genes and so again we can make measurements on up to 20 000 differentially expressed genes that are present that might be present in samples whereas with flow cytometry and mass cytometry you might be limited to a few dozen markers and that's it and so for instance if we were to break down this cluster and ignore the rest of the clusters and just analyze this cluster and try to differentiate this a little bit more and zoom in and re-cluster the data we can take that green cluster re-cluster it to get some better separation and then ask what are the genes that separate these and you can go through this process iteratively so if you identify an interesting cluster you can dig down to see whether a gene expression signature is specific for a subset within a cluster and this is really the power of single cell sequencing is that you get a very high dimensional readout of the data that you can't get with other methods and so the output of single cell sequencing methods has really increased significantly over the past decade so initially back in 2009 was the first study where they sequenced one cell and that was it and over the years you can see that there's been an exponential increase in the number of cells that have been processed in different studies with each of these circles representing a different publication and the number of cells analyzed and so we'll start looking at the techniques that were used um you know about uh you know five years and ago and earlier um that really analyzed individual cells by sorting them into separate wells of a plate preparing libraries from each of those individual cells and then sequencing them the most common method uh was this plate-based smartsee technique and in this technique you use a flow cytometer and you sort your cells of interest one cell into each well of a 96 or 384 well plate you lyse that cell and then you do a reverse transcription reaction using a smartseek style library preparation and with this library preparation method you have a oligo dt that will prime a rich transcription reaction off of mrnas that are polyadenylated this oligodt has a handle on the end and during the reverse transcription process dna gets made using rna as a copy and at the end with certain virtual chip dates is they'll add a couple of non-templated c bases and these c bases are used in conjunction with a template switch oligo that has these g's at the end so this template switch all again on top hybridizes on to these non-templated c's got added and the virtual strip days is able to use this template switch oligo as a template for further polymerization and in the end you wind up with a cdna that has pcr handles on both ends these undergo amplification so that you get many many copies of each cdna and then this goes into a sample preparation a dna library preparation method to complete the library prep process and that's depicted here and the most common one used is this nextera dna library preparation method where you would have your amplified cdna up here then exterior transposase will fragment that cdna into smaller bits add partial alumina adapters and then through pcr you amplify up this material and complete the library preparation process and so with those methods you're able to process a few hundred maybe a few thousand samples with a lot of work because you were processing each cell in a separate tube of a well of a plate and so this required a lot of pipetting a lot of manual work and is fairly expensive because you're essentially doing a separate sample dna library sample preparation for each cell and so a few years ago there were a few methods that came out that paralyzed this process taking advantage of uh of different techniques that we'll go into next and the first one we'll cover is method drop seek so this is a method that uses microfluidics or essentially different methods of creating very very small volume droplets in doing molecular biology within those droplets and in this method you have a chip where you have beads that flow in from the left-hand side cells will flow in from this first junction and so they'll get mixed together in the next junction you have oil that flows in and this oil will cause this aqueous phase to pinch off and form an emulsion and because of the uh way the system works you wind up with a lot of droplets at the end most of those droplets will be empty some droplets will contain a bead some droplets will can sell and a small fraction will contain both a bead and a cell and that's depicted over here and again this is a a small minority of the droplets will contain both one cell and one bead what's special about these beads is that each of these beads has many bar-coded oligo dt oligos on the surface this will allow it to capture the rna that comes from each of the cells that are co-encapsulated and again each of these beads has a different barcode from all of the other beads and so what happens is you get capture of the rna onto the beads after that you pull down the beads out of the solution and you do reverse transcription reaction again with this template switching process and at this point all the contents of each cell are stuck to one bead and all of those cdnas have the same barcode because they're attached with the same bead and again that bead has many oligodts with that same barcode on there you can amplify up the cdna just like we discussed before by using pcr and then you can prepare a dna sequencing library that'll sequence the ends of all of these transcripts and because we've tagged each of these transcripts with a barcode that corresponds to a cell essentially we've been able to process many many cells in parallel in a couple of tubes and with this method you can sequence thousands even tens of thousands of samples or cells in a single sample using just a couple of tubes so you wouldn't need you know 30 000 different wells which would be incredibly laborious and logistically just almost impossible to do so this was a commercial effort uh that came out of uh um that they came out of an academic lab and one issue with this method is that again most of those droplets contain nothing and only a small fraction of those droplets contain both one cell and one bead and the reason for this is because those cells and beads randomly get encapsulated into those droplets and so it looks something like this where you may have a lot of partitions that are empty in gray and then you have a fraction that have a single bead or a single cell and then because of the random nature although you don't have most of the the wells or the droplets filled with a cellular bead you do have some droplets that contain two or more beads or two or more cells and so you could do something where you increase the concentration of cells and beads so that you get more single droplets that or droplets contain a single cell or single bead but your doublet rate increases by a lot and there's no way to really distinguish this from the sequencing data so this is the reason why with this dropsy technique both the cells and beads are loaded at a low concentration to avoid those multiplets so about a year or two after dropsy came out 10x genomics a commercial company came up with a very very similar method if you take a look at it looks extremely similar you have barcoded beads that flow in from the side cells and reagents come in and then those get mixed and then oil comes in to generate an emulsion but you can see in this picture most of those droplets contain a bead it's because they are able to engineer both their microfluidic device and these beads so that you know greater than 90 of the droplets contain one bead and only one bead and so this increased the efficiency by a lot because they don't have to load the bees at a low concentration another difference with this technique is that inside of these droplets you don't just have capture but you also undergo reverse transcription within these droplets which is one other difference so at the end of uh this reverse transcription reaction you break the emulsion you take the cdna you amplify up in a single tube and then you construct your sequencing library again in a single tube and then you can sequence this on the sequencer and depending on how many cells you load in the platform you can sequence up to um 25 000 cells in each of the lanes of this trip and this chip has eight lanes on there so potentially in a single chip you could process 200 000 cells and this process on the chip actually only takes 15 minutes the downstream portions over here take about half of a day but that's pretty impressive that in essentially in one long day you could process 200 000 cells at a time or more if you ran multiple chips so another method to parallelize this process of generating single cell sequencing libraries is to use micro wells so instead of using an emulsion to separate your cells from each other you have a really really tiny um array of wells so each of these wells may only be a few tens to a few hundred microns in diameter and so there are a couple of open source and also commercial platforms that do this such as sequel celsi and once from bd and essentially the way these work is that you have this microwell array and there can be thousands tens of thousands or even hundreds of thousands of wells on a chip you lay down barcoded dna beads in this case these are colored blue and these beads are engineered so that most of the times you get one and only one bead into a well they kind of coat this array of microwells and then you apply your cells on top in this case in this example from celsi these cells are labeled in red so you can see them and again in most of these wells you have a blue colored bead that's present and then the cells will just settle down into the wells and then you go through lysis and all the enzymatic reactions to tag the rna from each of those cells with a unique barcode go through this library preparation process to generate cells and so what's to generate sample libraries and with some of these methods they have wells again that have hundreds of thousands of wells and potentially a million or more wells on a chip so that you process many many samples so um within this past year a paper came out that had over a million cells processed in the study and this method actually used a method called combinatorial indexing which i'll go over next and so with combinatorial indexing uh what happens is you do a lot of in-situ reactions which means you use a cell as a compartment and you're not working with individual cells at any given moment but you do multiple rounds of barcoding and mixing so that you generate this combinatorial barcodes that will allow you to to generate single cell data and this is a method uh from an academic lab at the university of washington that used a combinatorial indexing method and the way this works is that you have fixed cells on the right so these are fixed and permeabilized cells so that reagents can flow in and out of the cells you sort maybe a few dozen cells into each well of this 96 well plate so you're not dealing with single cells there's still multiple cells in each well of the plate you undergo a root transcription reaction with a barcoded oligodt so in each of these wells you have a different barcoded auger dt so all the cells within each well will have the same barcode at this step okay and this is depicted by these colors over here so let's say you put pulled from three wells um and so you have you know many cells that have green blue or red you combine these cells together you shuffle them up and you randomly redistribute them into a new set of wells of a 96 well plate at this step you take your cdna that's present in each of those cells and then you do a different reaction that will then add a second bar code again each of the cells in each well will receive the same barcode but chances are each cell and this well came from a different well in this first plate and so with this combination of barcodes you know with 96 and 96 you have about 10 000 combinations if you're only sequencing about a thousand cells you don't have a very high chance of having two cells with the same barcode and this is essentially what the the final library looks like you have a rt barcode or transcription barcode you also have two different barcodes that are in the illumina adapters that can be used as well so you can potentially barcode up to three times with this method and the power of this technique really comes in as you uh add more of these levels so for instance again if you had two sets of 96 well plates and you're barking them you have almost 10 000 combinations if you're to work with 384 well plates you'd have almost 150 000 combinations and it's actually isn't ridiculous to work with several 384 plates at each step and so if you had four 384 wheel plates at each step or 1536 combination of each step you can generate about 2.4 million different combinations and so this is just with two rounds of barcoding if you were to do three rounds of barcoding and add another barcode in this case 96 or 384 for a third level you really scale the numbers and so in this case i'm actually representing these numbers in millions now just because the number would be too big to fit on this chart and so in this case if you were to do 96 by 96 by 96 with three levels you'd have about a million combinations uh if you did 384 by 384 by 384 you'd have almost 60 million combinations and so this is the reason why this scales uh really really well especially if you add that third level of barcoding so changing gears a little bit we focus mostly on rna sequencing but it is possible to do other things with single cell sequencing platforms and one of those is to quantify proteins and so you might ask how do i quantify a protein with dna sequencing and the method that's been used called sightseek is that you have your antibodies that will bind onto proteins of interest so this is similar to an antibody that you might use for flow analysis but instead of conjugating a fluorophore to be read out by flow or a an isotope for scitov you conjugate on a dna barcode and so the cna barcode has a pcr handle at the end a barcode that tells you which antibody it's attached to you again this is just a dna sequence barcode so your a c g's and t's you just have some unique sequence for each antibody and then a poly a tail so this poly a tail will allow this antibody sequence get captured by the single cell sequencing methods and then you can read out the barcode essentially as a transcript that will tell you how many copies of this antibody were bound uh you know to that particular cell and so this is just some data comparing rna analysis with protein analysis uh just using human and mouse cells have been kind of mixed together uh to show you that the method works and they're currently panels of antibodies about 100 or even more antibodies that you can use in conjunction with single cell sequencing and the cool thing here is that you can get not just protein abundances for those proteins that you have antibodies for but you also get the transcriptional readout in terms of which genes are also turned on and off in each of these cells so you get this kind of a multi-ohmic approach where you can analyze both protein and rna so one issue i told you about earlier with some of these methods is this uh issue of multiplets so if we ignore uh just speed multiples and just focus on cell multiplets this is one reason why we're limited in terms of the number of cells uh that come out of these uh both these microfluidic and microwell platforms and again you don't want to load very many cells because you want most of these droplets to be empty so that you avoid these doublets so again if you were to increase the concentration of cells that you load in to maximize the number of singlets so for instance over here you have four singlets you do increase the rate of your doublets so that these increase here and here now if there's some way to identify these doublets you could remove them computationally from your data analysis and so for instance if you had two differentially labeled samples that you pulled together and then you flowed into your microfluidic device at a high concentration you would get multiplets but if the multiplets came from two different cell types and you can identify that you can exclude those from analysis and then actually get more single cells for the same cost and so one the first strategy to do this was a method called demuxlet and this is multiplexing by genotype so this group here at ucsf was working with different patient samples and with different humans we all have different dna sequences and some of these sequences are found in our transcripts and those can be detected by single cell rna sequencing and so this example they had eight different donors that had different genotypes by different colors here they got combined and then run in a single cell sequencing platform so you get a whole bunch of single cell data and if you take a look at each individual cell let's take a look at one cell here we see a certain genotype in the transcripts and we can match that with one of the original donors so we can tell that this sample or this cell came from this patient sample and you can do this for most of the cells in in the in the data set what's really cool about this method is that if you have a doublet two cells in a single droplet and you have eight different samples chances are those two cells came from different samples and they'll have two different genotypes so if you analyze the data within those cells if you see the presence of two different genotypes you know that's a doublet and we can move those from analysis so this allows you to bump up that concentration and get more single cell data for the same cost so if you're not working with genetically distinct individuals this method won't work and so there are a couple of non-genetic strategies that came out the first one was from the same group that developed sightseek they realized that if they use an antibody that's binds to some type of universal surface antigen on cells they can take that antibody and split it up in a couple of different aliquots and with each aliquot you can give it a different barcode then you can take your different samples and then add them to these different aliquots of antibodies to allow them to bind at that point you can pull them all together run them in the single cell sequencing platform and you look for the presence of which barcoded antibody showed up and this will allow you to assign each of these individual cells to a particular starting sample because you knew which barcode the antibody used for each sample and again this also has advantage where if you have two or more cells in a droplet you can detect those because you'll see two different barcode sequences assigned to a single droplet and you can exclude that from analysis more recently in collaboration with other group at ucsf we develop a method that is a universal method that uses lipidated dna that embeds into the membranes of cells so this doesn't depend on the surface antigen it just depends on an accessible membrane that this barcoding dna molecule can insert into so it inserts into the membrane of cells you can insert a different barcode into each pool of samples and then pull them together in this case we were able to barcode 96 different samples pull them together and we can identify all the singlets and the doublets and you can see all different 96 samples represented here in this plot so in conclusion there are actually many different types of single cell sequencing i've only focused on rna today but there's dna there's protein there's chromatin accessibility and many many new methods coming out uh you know every few weeks so it's an exciting field to be in single cell sequencing also generates high dimensional data especially if you're looking at rna because you're probing the quantity or the expression level of all 20 000 different genes that can be expressed in cells and so this can reveal biology that's hidden from lower dimensional techniques so single cell synchrony does have some disadvantages it is lower throughput and more expensive compared to flow cytometry and mass cytometry you know with those methods you can easily analyze hundreds of thousands or millions of cells at a time and i also didn't mention single cell analysis that doesn't use sequencing so there are microscopy-based techniques that are out there as well that have some very interesting um you know properties including the ability to give you some spatial information so if you're working with with tissues um with most single cell sequencing techniques right now you have to dissociate those tissues into a single cell suspension and then run them so you lose a lot of that spatial context that might be important for the biological question that you're trying to answer and some of these microscopy methods can offer you some additional information that might be valuable and so again thank you for your watching today and i hope you enjoyed this video you 