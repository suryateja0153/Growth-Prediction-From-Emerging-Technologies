 hi I'm Tommy Thompson and this is a eyeing games a series on research and applications of artificial intelligence and video games were back in the Mushroom Kingdom to take a look at academic research in Super Mario Brothers Nintendo's ever enduring franchise has cropped up a couple of times on this channel having looked at both the Mario AI competition that ran academic conferences between 2009 and 2012 as well as how AI researchers have sought to better encapsulate and model Mario level design for procedural generation purposes in this video we're catching up with some of the new and ongoing research and applying machine learning to Super Mario level generation I'll be looking at the kinds of levels of generating how these algorithms go about building a Mario level and the opportunities that still lie ahead for this research field it's time to meet the new Super Mario makers before we look at the Vedic projects and systems and Ernests let's cover some basic theory of what I'm talking about and the big changes that have happened in the field in recent years if we cast our minds back to the original Mario AI video I posted in 2014 I explained how the Mario AI competition introduced several strands of research involving everyone's favorite plumber while some of the challenges set with a competition such as rating BOTS were overcome pretty quickly courtesy of Robin balm gardens a star player the challenge of procedurally generating Mario levels was only just getting started the competition tasked researchers to not just create a system that made levels inspired by Super Mario Brothers but also attempt to customize them based on some simple telemetry data about the user that was playing the game the resulting systems over the next couple of years were pretty diverse both in terms of how they operated and the subsequent levels they created well this video is focused on more recent work replicating Mario level design if you're interested in learning about the more formative research and player driven PCG for Mario I'd highly recommend exploring work but dr. nor sheikha but looking more contemporary research one of the largest transitions is moving away from building levels that adopt player telemetry but instead seeking to mimic the original designs from mario titles what prevented this from occurring up until now was that these earlier research projects all embed their own design knowledge about what a Super Mario level actually is know this is an interesting area of study all in itself what makes a platforming level a Super Mario level it's something scholars have engaged with in recent years to better understand the new ones required of Mario level generators see the thing is that well there are certainly aspects of the overall aesthetic that influence the process what is more critical as the logic and structure to the léo of even the simplest mario levels if you give someone a piece of paper and a pencil and ask them to sketch you a Super Mario level they'd probably differ in many respects due to that person's knowledge of the franchise but there would no doubt be some common elements that be brick blocks maybe even question blocks pipes goombas koopa troopas there may even be a pet to fall into and die or a stairwell that would head towards the flag at the end of the level we have a collective understanding of these core elements but often like the intimate knowledge of how these things should link together and the relationships between them that make the Super Mario series are continually fun and engaging franchise heck Nintendo is so confident in their mastery of this concept they've developed not one but two editions of Super Mario maker will they give you a fairly flexible tool for building your own Mario levels to play on a Nintendo device without any real concern of whether it would impact the sales of the main series so bring in this back on point Super Mario level generation research has continued to thrive however the biggest shift in recent years is the efforts to understand Super Mario level design to address their small recent work avoids having researchers directly inject their own interpretations of Mario level design given as mentioned there is no absolute and complete set of rules that dictate how Mario levels are built that we can lift from even when given the tools to do so in Mario maker we ourselves not only struggled to reproduce the Mario method but we often do something else entirely a point that I'll come back to betta no the most recent rhetoric using machine learning has sate stab this issue by letting the algorithms study levels themselves as we'll see in some of the projects I'm about to explore in each case the system is fed Super Mario levels to a limit to build its own internal models the manner in which this date has fared ranges from annotations of design patterns to tail grids reading in level graphics all the way to watching YouTube videos in each case the system infers its own logic of how tile should be grouped together what tiles are used in certain contexts and in some instances what texture should be applied to those tiles themselves the process is enabled for these recent level generation systems to more accurately interpret and reproduce aspects of Super Mario level design but enough my babbling let's take a look so I'm going to explore four notable bodies of research in recent years and while this is far from exhaustive it gives you an idea of the sorts of avenues researchers are taking and the progress that's being made bear with me as the range of AI methods and techniques employed here is pretty diverse I do my best to quickly summarize what each system is doing and why it makes sense to go about in this manner for those of you interested to learn more I've listed all of the relevant research papers in the video description for you to peruse in your own time first up let's take a look at the work of dr. Steve Dahl skog a lecturer the University of Malmo in Sweden Steve's work sought to assess Super Mario games using design patterns identifying common elements in the layout or structure of levels or mechanics and games there's argument being that by establishing rules of how game elements are constructed AI systems could adopt that knowledge as means to make intelligent decisions on how to make new levels or even games this research has led to him exploring procedural generation of dungeon levels as well as player expedience evaluation systems but much of his research particularly in the early years of his PhD revolved around Super Mario Brothers now scoggs research starts in 2012 under the supervision of yulian to galius by identifying 23 unique design patterns within 20 land-based levels from the original super mario brothers emitting underwater levels and those in castles these patents range from micro level behavior such as genes of goombahs or gaps presented in the level to macro behavior where level construction is more abstract such as multiple paths or stairways constructed using pipes with gaps in between if you want to learn more about this research check out my second video on Mario from back in 2015 where we discovered that not only do these design patterns hold ground and subsequent sequels but they're the crux of her many entries in the series envy on Mario level design using these patterns as means to identify properties that would reflect real game levels dolls cogs second phase of research published in 2013 employed evolutionary computation to build levels and then assess them based on the number of patterns found in each example this is achieved by breaking levels up into 200 vertical slices and then examining how those slices connect to one another and what patterns exist within subsets of those slices the resulting output generates levels that reflect some of the classic Mario design patterns but fail to respect the pacing of these patterns to create a more natural flow this was followed in 2014 with two projects one that rebuilt the level evaluation to record micro and missile level patterns distinct from one another resulting in increased level variety followed by a new level generation process the multi level level generator that built levels at varying levels of abstraction starting at macro power and level then working down to missile and micro his final body of research in this space was published in 2014 with assistance from dr. mark Nelson and well it's not machine learning it's worth checking out given it calculates continuing sub sequences or engrams of vertical slices in order to construct a Markov model of the level creation process Markov models are a smart approach towards this given their design to predict the subsequent action made in a decision process based upon probability of subsequent outcomes that it learns from existing data by using a collection of the most commonly found vertical slices used in Mario levels as shown on screen now the system can then analyze a set of one or more levels build the Markov model and then attempt to produce levels with similar properties as you can see here the resulting levels not only appear to reflect specific Dane's from existing Mario levels but concatenate them in ways not previously considered next up let's swing over to the united states and the work of Adams Summerville who completed his PhD at UC Santa Cruz in 2018 and is at the time in this video an assistant professor at California State Polytechnic University Adam has worked on a variety of fun research during his time as a grad student but he tried two distinct approaches to Mario level generation using machine learning first up is a project published with shredder Phillip and Michael Mateus in 2015 they share some similarities with the final project by Dao Skog and that it also uses Markov chains but tries a different approach at validating the outcome one element of the Engram levels that can be problematic is that there's no absolute guarantee that resulting levels are playable it's at the mercy of the Markov chain producing something that makes sense in Somerville's paper takes a similar Markov chain approach but the decisions made by the chain are validated using Monte Carlo tree search an approach we've previously seen when I explored the strategic diplomacy AI of total war Rome to the Czechs the decisions being made will not only be playable but tailors them against specific design parameters to get started the Markov chain is generated in a similar manner to dowse cogs by examining vertical slices of each level identifying tiles that are either solid or breakable as well as enemies pipes coins question blocks and hidden power-ups once the Markov chain is established every step of the level generation process relies on the MCTS algorithm to validate the quality of each possible action that the chain can make if the Markov chain says that our three commonly used follow-ups to the current vertical slice the MCTS scores them in a number of ways with the system taken the one deemed most suitable the MCTS evaluations are multifaceted given that they're designed not only to ensure that the resulting levels are playable but also relies on additional metrics that the user can parametrize based on their personal interests first each level is assessed for completeness by taking Baumgarten a star ball mentioned earlier in this video and using it to test the level in a into having the bot test the level there are independent parameters for desirability of certain level features such as the number of gaps enemies coins and power-ups this hand tweaking allows for the designer to have more control of what type of levels are made all the while relying on MCTS to ensure the resulting levels make sense the second approach was to use a variant of recurrent artificial neural networks known as a long short-term or L STM network LS TM networks date back to the late 1990s and are great for handling sequences of data given they have a memory component to the input sequence allowing it to not just read in fresh information but dictate when to remember or forget data from previous embas cycles as a result LST m are often used in speech and video recognition processes given it works well with continuous sequences of data Sommerville attempted this in late 2015 by training ALS TM against 15 levels from the original super mario brothers as well as 24 levels from the japanese release of super mario brothers to often referred to in western markets as super mario brothers The Lost Levels different configurations of networks were experimented with to enable the system to reach and generate the corresponding output with the best configuration known as sneaking path depth changing direction from up to down then up again when generating levels but also embed special characters into the generated level that reflect the potential path a player could take as well as recording the current column is generating for the level thus enabling the system to have an understanding of how far into the level it's working having trained the sneaking path depth network to within a certain level of confidence that is then tasked with generating new levels as we can see now these levels are assessed against a variety of metrics these metrics as Summerville himself states are not intended to assess the believability of the level coming from an original mario game but instead enabling new levels to be created that share similar properties are nonetheless still novel the evaluation considers not just whether the level is completed once again using an a-star driven ball but the percentage of empty spaces in the level then negative space in the level which is the empty space the player can actually reach the number of interesting tiles placed the number of jumps involved in playing the level optimally as well as measurements of how linear and lenient the level is to play the third strand of research to examine is by matthew gus dial who at the time in this video is close to completing his PhD at Georgia Tech University Matthew's work is arguably the most famous of that discussed in this video given its appeared in the lakes of Vice The Verge wired the register and New Scientist one of the big reasons for this is the element of novelty employed in capturing Mario level data as we've seen already each researcher is inputting Mario level information in different ways Dao Skog annotated levels were design patterns while somerville fed tile they are from levels but Gus dials initial work in to capture not just level information but an understanding of how players navigate these levels in real time so it learns about Mario levels but watching people play them on YouTube so how does watching a youtube video result in an AI making Mario levels as detailed in a 2016 paper co-authored with a supervisor dr. Margaret Dell Gus Dale's project adopts OpenCV an open-source computer vision toolkit that processes each frame of a given playthrough video the project aims to achieve two distinct elements first determining what can be learned about level layout from scraping video footage but also then how to represent the design knowledge hidden within the footage such that it can be reproduced for the purposes of a level generator to learn what it can from the level layout it runs a process of identifying and categorizing what Gus Dao refers to as high interaction areas a segment of the level in which the player spends more relative time Anette compared to others thus can refer to areas with jumping puzzles floating coins in the map or our question blocks and hidden items such as power-ups these high interaction areas are identified in the video footage then analyzed to understand how sprites are placed within the sequence this is more easily achieved in the original Super Mario Brothers given that are only a hundred and two sprays the system needs to consider videos are broken up into distinct sections of level by assessing the differences in contents of each frame the interaction areas that are then found are subsequently clustered such that they can be categorized effectively resulting in 21 clusters were video segments ranging from 2 to 250 frames and size carry specific interesting properties such as being underground or up in the treetops given that Mario dying which causes a black screen to appear would interrupt this analysis process only video footage where players don't die is used the second phase is then to build a probabilistic model that's based on the clusters pulled from the video data this model encodes design rules whereby level nodes or l and ness diagram can be generated in a variety of different ways due to the data learnt from the clusters based on a specific style this requires the G and D nodes in this diagram to be properly calibrated the G note of the model represents the geometric information about a given shape in the world that is comprised by one or more sprays the tree bark and the treetop segments are a common shape that the system recognizes and learns to generalize them across a variety of different permutations but there's also the D node of the model which stores the relational information of a G node to all other G nodes in a given level this is essentially including design knowledge of how objects are placed relative to one another so the system has effectively grabbed all this video information parsed out interesting shapes that use specific sprays then learned how those shapes relate to each other the interesting part of this is that it's not learning how to make a Mario level nor does the system really understand what mario is instead it's learning how sprites are positioned relative to one another n segments of video footage that just so happens to come from a video game when the model is ready it can generate segments of level by considering the shapes that would typically appear in that segment which in turn need to consider not just the sprites they would draw on-screen but their position and their relationship with other shapes that would also appear at the same time the resulting levels are astoundingly accurate for a system that's only learning from video footage project was but the star of a longer body of research explored in subsequent years about how video footage of games can be harnessed not just to understand how sprites can be put together for level designs but how it can recreate actual in-game behavior such as collisions jump physics and scoring mechanisms last but most certainly not least as more recent research by dr. Vanessa voles a PhD graduate from the Technical University of Dortmund and is a timeless video a research associate at Queen Mary University in London volts his research can be found in a paper published at the 2018 gecko conference with co-authors Jacob Schram Jalen Lou Simon Lucas Adam Smith and Sebastian Ricci that explored how to build levels using a process known as generative adversarial networks or Gans for short ganzar a process of unsupervised learning that has proven popular since their inception in 2014 but is based on existing research on adversarial learning between noodle networks that dates back to the early 1990s a generative adversarial Network is a deep learning technique comprised of two distinct convolutional neural networks known as the generator and the discriminator the generator is creating solutions to a given problem while the discriminator evaluates their quality to make this happen the discriminator is learning to recognize a specific set of examples from a dataset while the generator learns to create samples that fool the discriminator into thinking what is created is authentic over time each system becomes increasingly better at their respective tasks with the discriminator becoming better at recognizing authentic data while the generator becomes better at filling the discriminator into believing its output is authentic and as a bonus the output of the generator improves in quality this approach has resulted in significant improvements in fake AI generated imagery and style transfer of photographs but arguably the biggest impact it's had on gaming thus far is the recent work in modding communities using machine learning to upscale textures to 4k resolution for games such as elder scrolls morrowind doom metroid prime and Final Fantasy 7 which we could explore as an episode and itself if you're interested let me know down in the comment but bringing it back to Mario how did vaults in the rest of her fellow authors get this running from Mario levels to do this it's broken down into two distinct phases the first part is training the desire generates our network the discriminator is trained against one level of super mario brothers while the generator is trained to start learning how to fill the discriminator once this process is completed the generator can now create new levels that fool the discriminator and thus enables the beginning of the second phase of learning the second phase uses a process known as covariance matrix adaptation evolutionary strategy or CM AES for short to further train the generator such that it can build levels that reflect specific design properties such as the number of drone tails and enemies placed but is also evaluated based on whether robin Baumgarten x' a star bot can complete the generated levels and the number of jumps it requires to do so this ultimately results in levels such as this one here that is based on snippets generated by the system the ordered and progressively more difficult segments while it isn't always perfect and requires the encoding used by the system to be properly calibrated the real benefit of this approach is that levels can be generated very quickly to the point it could in theory generate new levels for the player while they're in the middle of trying ur existing ones if you're keen on trying out this generator yourself the code is available up on github and you can find the link down in the video description within the last seven years machine learning techniques have been shown not only to provide a viable option for procedurally generating Mario levels but they're doing so a level of quality that surpasses much of the existing work in the field there is great potential for these techniques to be employed in similar to detail based games but with their own unique level design principles a level generator that mimics the rules of Megaman something that Gus dials work has already started to replicate what about expanding the studio to the metroidvania genre where there are rules of interconnectivity and backtracking that need to be considered maybe even Legend of Zelda dungeons actually Adam Somerville has already conducted some work in that space and we could look at that in the future but beyond that I have another question what other kinds of experiences could these generators make using the Mario template to surprise us to challenge players with something new and exciting back in 2016 I presented a paper looking at the most popular levels on the original Super Mario maker for the Wii U that were hosted on the online service and voted for by the community why found was a diverse range of levels that take the basic template of Super Mario Brothers and try some fresh new ideas to innovate on the formula referring back to earlier in this video when I mused about what humans do when given their own Mario level creation tools the results I phoned were fascinating with a variety of unique and novel designs that completely break from Mario level design principles the sense of creativity that transcends its origins represents a new space of possibilities to explore in the future and it's clear from the ongoing investment in Mario level generation that this is far from a closed chapter in the world of procedural generation research and funnily enough just as I was putting the finishing touches to this episode a new and improved version of the Mario AI framework was made public and ready for a new generation of researchers and hobbyists to use the framework is being built by Ahmad Khalifa currently a PhD student at New York University and seeks to not only integrate many of the original features from the 2009 version but adds bill nai players and level generators contains thousands of generated levels from previous competitions and aims to bear support continuing research in the future although and is using the original mario art to head on over to mario a i.org to learn more and download the latest version have also placed the link in the video description so be sure to go check it out thanks for watching this video on AI in games it's just under five years since I published the video on the Mario AI competition and it's great to get a chance to return to this ever popular corner of academic research don't forget to give her a cheeky like and subscribe for new explorations of artificial intelligence and video games each and every month special thanks to Steve Adam and Matthew who provided me images from their level generators to use in this video as well as to Vanessa who's existing video footage was adopted for this episode this video was voted for by my supporters on patreon to have a say in the topics explored in this series and to have your name up on screen right now head on over to the AI in games patreon page via the links on screen now and in the description [Music] you [Music] 