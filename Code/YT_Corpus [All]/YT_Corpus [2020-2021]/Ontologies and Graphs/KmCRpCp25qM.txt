 oh okay and we're back sorry about that I'm not sure what happens for this it's all good so you can see we've loaded the data so if we've loaded the notes so the next thing to do is we're going to load the relationships so I'm going to go away again I'm going to copy my query here oops I need to remove the comments from that so good Oh what was I going to say as well and for those of you who are using browser if you're wondering hey how is she managed to make the the whole screen go white and bigger if you click inside these space and press Escape key it will make it bigger and smaller so it's quite handy if you want to sort stretch out and have a look at large bit of text okay so let's have a look at what's going on here so we've gone away and created on notes in fact let's have a look case if I click here you can see we've got countries problems why don't if I click on country let's bring some of those up you can see we've got some got some countries going on here great so we've loaded some data for that and then what we need to do now is want to connect up four wineries provinces and country so we're going to do that now we have the interesting thing because we still need to deal with those nulls so we still need to know whether or not something didn't exist with the with the country we still need to go away and do with that so we're still using this idea of this sort case when so so my dad latest view were getting each row and then same idea so if the if this value here so for Country Road a country is not then we're going to use that you're going to basically use the value of no country because bearing in mind we created the no country and now we're going to connect things together and if it does exist then we're going to use robot country I know what we're doing is with we're basically saying using the with statement we're saying you know create an alias to that as country and again do the same thing for products and same thing for winery so that's going to allow us to find either if that country province or when you exist and if it doesn't then we've got the appropriate default value associated so we're going to be doing that for at the data within our CSV and then what we're doing then is we're then matching those three different notes so going away matching those because we know they already exist and then we're going to merge them together so the reason why we're merging the relationship is they could well be a lot of repeating data so for example winery is undoubtedly creating more than one type of wine and we don't want to have all of those relationships connecting the winery to Provence as an example there so that's why we're doing the merge there so you can see we're merging the winery to Provence and we're going to be merging the province to country it's the same idea I'm going to run this and I was sneaking suspicion well see what happens if this knocks out OBS again so that's let's just make it smaller and let's run that query and again actually probably take maybe about 20 30 seconds so let's let that do that and whilst that is running let's have a look at the questions so I've suggested some questions on the on and the repent I thought you know why not I still think we can answer some interesting things with those questions so we can answer you know I think what be interesting about you know which countries have the most wineries and this is actually based on the dataset that we've got and uh do we have wineries across different countries I mean maybe that happens maybe if you're a very large winery maybe you are at creating why four different places I don't know that might be fun to have a look at which minor is across multiple provinces so that certainly will be one or is that soon there will be wineries with different provinces so we can have a look at that so what we might do is well is we can have a play with bloom too and for those of you not come across bloom it's a visualization tool that uses near natural language so I find it really really helpful to be able to go away and just start exploring my data without necessarily worrying about what the cypher Cory's going to look like so actually let's do that let's have a quick peek in bloom to begin with and then we can go away and write those cipher queries and again if you've got any other questions you want me to answer that they day that's sort of springs to mind let me know pop them in the chat and we'll we can do those together so let's see okay so let's get this up and going in bloom so those of you bloom is now free you can use bloom free in near future desktop so you can use on your local databases do go and have a play is really really cool and it's great for this kind of thing where you just want a quick peek you later we aren't necessary to worry about writing any queries so to launch bloom you pressing little arrow there next to open and you see an option there called blue so I'm gonna click on that and what's going to happen is it's going to it's going to ask me to create a perspective okay alright so I don't have don't have a perspective on this so let's create perspective when I click on create prospective I mean if you can generate perspective and what's going to happen there is it goes away it does some stats on the database and it tries to figure out all okay so these are going to be sensible labels to use these were properties that you want to be looking and so forth it goes wait does that work and then it's going to suggest perspective for us so it's gonna be this one time this is what I want to use and I'm going to perhaps rename this and I call it my boy in perspective okay I'm gonna save that and let's use this perspective so one of the questions that we asked was and I are any of the wineries across different countries and what we're going to do is so if we remember um so um so you had winery province country so what would what might work we'll see how it goes is we're gonna have to eat I have these a pattern because we have to go for province to find about wine to remained upright and this is a size of query anyway but it's all good we like to experiment so what we need to do is we need to do this thing called a palindrome pattern so let me let me bring up arrows and you can see what do I mean but actually let me bring up paint it's all of champions so let me just make this a bit put this into the screen okay so just something to bear in mind is if we think about so we've got so we know we've got wine I'm doing what's going on here okay so we know we've got wine we know we've got Robin and we know we've got country and what we what we know at the moment is for us to find out whether for us to find that whether wine is in wineries in more than one also schrab why nourishment it so for us to know whether a winery is it you know is operating in more than one country we have to go by problems because if you remember got some areas as well excellent so as you know if you may recall for us to go through to find out with a winery long small one country we have to go by department so that's our link so we have to go across province to find that now we still have to do that in blue so we will do the same equivalents like the Korea it's all don't worry about that but what we need to do is we kind of we're going to treat winery as a pivot point and we need to repeat country more than once as a way of trying to bring back that cardinality so what that means is we're going to do something like country province winery province country in bloom and then what that will do is it will bring back if there's more than one country something to bear in mind is because it only goes down the path once if we've got province what we shouldn't have a province associated with on country because we actually know he might we might they should be fine actually look at this and so we may have province going to move on country but we can only cross a path once so if there happens to be a situation where there's a winery that's in a province that's got the same name but that province is two different countries we're not going to get that data back never thinks you've burned and mind as well is that winery may be associated with more than one province that goes back to the same country so we may get this little circular thing so that's just try to stress on explain what's going on let's have a look what actually happens so let's do that we still we're going to use country as a pivot point let's do country province winery and what's happening in the background is blooms basically going off to see if that pattern exists so you can see it exists winery let's go back to province so just curious if it starts suggesting things oh yeah so we have a winery modeling province that's exciting and let's do country and let's wait you're gonna wait for the pattern to show up so it's basically in the background it's trying to figure out whether that exists Oh excellent so let's grab that let's just hide this out the way oh my goodness it's a lot of data coming back so something to bear in mind with bloom is it will cap and you can change the cap but it will limit the number of notes that actually are returned from your query so they could well be more than one but let's zoom in and see what's happening so this quickly remind ourselves what colors were so country's orange provinces purple so let's zoom in and have a look what's going my goodness there is a lot of stuff going on here so it's a good Romania I think I know um I'm going on that's that's okay so there will be a winery let's see if we can pick one of these apart okay so what wineries this stone craft so let's let's pick up let's make this a bit easier so let's say and what we can do because we're going to look at stone craft is I'm going to replace winery with stone craft just don't want even my foot it is I can't spell it okay so I'm just gonna quickly clear the seat and that's how it look ah now that's interesting so stone craft have are more than one country so that's cool okay so we wants that question we do have we do have vineyards who different countries so what we're going to do is we're going to go off and write slide for query and what we can the nice thing about going right in writing the slide for query is you can be a bit more specific with investigation so maybe there are some wineries that uh working across more than two countries maybe there's many countries so let's go have a look at that that should be very interesting obviously the thing we've got to bear in mind here is we're making the assumption that stone croft is a unique winery name it could well be that there's more than one winery called stone croft and there's one in New Zealand and there's one in the US so that's something for us to pick up and have a look later but for now let's just explore this and maybe we need to crack this later but that's okay so that's cool so he looked at the that's quite recent what was the other question had another question we had was wineries across multiple provinces so again we can do a similar idea let's click the scene and we're probably going to have loads of these coming back but that so okay and again same idea because we know that wineries directly connects its province so we're going to use wineries a little pivot point and the provinces can you know in buy dunes of winery province winery province that gives us a lot like that cardinality type very so let's do that same province winery province and there will be many of these I suspect but if we had loads of a country we're gonna have loads for this so let's just have a look and we're gonna zoom it and I'm gonna go off and right it's like a query of this I think we're gonna have some great fun later if we start analyzing the relationships with the Hat with the graph algorithms though let's pick on it random let's see [Music] the forager okay I like the Sun but all that Sun at the foragers let's let a quick peek of a forager let's clear the scene Hey okay so there in you know said of foragers in two different provinces obviously they're both going to connect to United States okay so we start skiing on this you get a rough idea of what you can do with bloom it's a really great way to just have a quick peek at your data so just to give you as an example with this and you know maybe I couldn't be bothered to write the cipher query or even as much not been bothered but let's say I I was looking for something oh I think I'm bothering okay so about that and so let's say for example and I I wanted to ask a question but that might have been bit of a convoluted quote as an example this is a great way of just figuring out there's a beta exists does that pattern exist and we figured out that that pattern exists so great we can go away and write our queries knowing that you know that stuff exists so that's cool and I think we asked question about most wondrous oh okay that's enough playing around with bluem let's go and let's let's go off and write some cipher queries I'm just going to close bloom I don't need this anymore let's bring up browser right okay so let's have a look at this so one of the questions we're gonna ask is which countries have the most wineries let's do that can I spell all right so let's do that so let's have a look and again if you've got any you know anything else you want to ask of this beta let me know and we will have a look at it right okay so let's have a look which countries have the most wineries so we're going to do something so we're going to bear in mind we've got that pattern so again we know that a winery is connected to a province which is connected to a country so we're going to be interested in that path so I'm probably going to do something like this so much that P equals how we're going to do W wine are you know I don't know what countries didn't we will did country that's fine we can do this you so we go to winery from province province country see country and then what we're gonna do oopsy-daisy I want to do he returned see that name and we want to return count count P so we're going to count the the paths effectively what we're watch country is mine were name is yeah that's right so what we're saying is we want to count the number of paths that are going from winery to country now something to bear in mind is that there are going to be multiple paths between winery and country potentially because a winery may be in many provinces that belong to one country and those each of those are valid paths so we're going to need to deal with that so let's have a quick peek what happens I think fitting in let's have a look so that's what's gonna happen so probably gonna see a crazy number and let's have a think about how we're going to solve that in a second so let's start with this I'm going to give these some sensible names so we're gonna get crazy number don't panic it's because we talked about there being multiple parts so we'll ever think about how we're going to build on it second let's look what comes back whoops oh yes I can't do that is this quick path excellent and let's see so we're going to see some crazy numbers because we wouldn't expect which country the metal wineries oh no no that's correct sorry sorry my bad no it was quick yo-yo no counting that's we need to get rid of the duplicate when there is one to Provence so let's ever think about how we're going to do that because I think what you'll find is the total number of wineries is going to be less than if we added up all of this so let's check our understanding on that so if I did return that's just gonna comment this out so if we did return count part that's going to count it all up the paths that's gonna give us 19050 5 and winery turn count suddenly we've got total of 16,000 16,000 wineries all 16,000 point 7 wineries so you can see what's happening there is you've got some wineries that are that effectively have more than one province but that province is associated the same country which is why we get in those additional pods so let's have a look at getting rid of those the really interesting thing here though that I find is that there's only I mean that's what um [Music] 2,300 wineries I've got one more than one more than one province which is interesting that's a lot lower than I thought it might be so that's interesting but back to the the other task let's try and dish and think about those um multiple multiple provinces so let's ever think how we're going to do this I say think nice let's go to this part the second we don't want pack so it will last a couple of days and then we're going to go off and include some more data but I think you get the idea that just pick it you know we've got a small amount of data but already we're starting to get some very interesting insights as to what's going on so never underestimate the power of just getting smaller bit small amounts of beta in there so you can explore it okay all right let's have a look how we're gonna tackle this okay so what we can do is a little bit cheaty but if we do count province so did node account winery and we're going to do distinct winery that will let's just was going to do just five three seven five oh yes okay there we go so that's done that so there we go soon that's our query and I think if I get rid of this this you probably still work because we shouldn't be having repeats of winery so that's a quick peek oh no it's not okay so we needed this thing so there we go so that's how we can answer that question there so that's what query so we're using province because we need to we need to both to walk across Traverse across that relationship to get that and then we just get in the country name and we're looking for distinct count of the wineries so there we go so you can see that the US has sent for this dataset has got a huge number of wineries and then so we've got France you know not big surprise that Italy not big surprise there so that's that's really fascinating so obviously this is going to be skewed against what wines have been reviewed in this magazine where the date has come from but I still very interesting and you see certainly like the world wines are quite small it's quite cool but some global Greece has like got 99 ways and Israel as well that's very very cool we got sorry 27 27 of our wineries are not associated with any country that's all cool Oh Bulgaria but they dish in very nice wine in Bulgaria okay so let's gonna grab a copy of that we're gonna pop that in the repo later and let's do we want to have a quick peek at let's have a quick peek of wineries with more with multiple provinces because I think that's a little bit fun given that when we had to look it was only something like 2300 I think that 2300 had more than one province so that's for a quick peek at that because I am very curious and they're going to go away and we're going to put some more data in right okay so let's have a look so what we did is match pots and we still keep this popping we can we can swipe this query and reuse it and we want to want to return Robin I should note winery even so you want to get the one who named and we want to count so this time we don't need to do distinct because it should be distinct so we're going to count that is a total number of provinces and we're gonna older that's we're gonna have a look at which ones have got the most of a so that's a quick peek oh okay so I've got to mention that so what I'm quite curious about now is something look what all those problems is so let's do it quick change the cruise I'm just gonna grab a copy of this so we can pop that into the repository later I want to do is I want to list up the names so what I'm going to do is I'm going to collect those names Peter name provinces and how we're going to do this okay so it's not going to order them for us so we need to with performances total order by total systems I just got to retrieve them to retrieve all the properties that might be quite expensive quickly oh no I did not want to do that i winery's up now you collect Pete to do don't want to return thee oh okay property doesn't exist there you go third time's the charm there we go brilliant there we go we can look at all of the different provinces that are associated with each of those wineries and that's quite amazing that you've got something somebody's got nineteen provinces as huge so I guess a fun thing actually it might be that might be something for us to have a look at in the future and so still I one of our community members put together this girl fat but you've got effectively maps so maybe a fun thing for us to do in the near future will be to go away try and get some of the long information for these vineyards or these provinces and then pin them up a map and have a look how they look like something I'd be a bit of fun social save that for the future but there you go you can you can have a look at these and you've got some you get some idea of some of these one company so I guess global wine mixin global wine they're gonna have a lot of provinces get the idea there so that's that's quite interesting again bearing in mind that were looked at that the dataset only three 2300 have more than one prominent so that is very interesting so let's grab a copy of that and let's go away and put more data in okay so that was fun let's bring up the aerosol so for those of you who are interested what I've done again if you go into the repository I will keep a copy of the various arrows models like put together if that's of interest to you so if you go into the docs folder here you'll notice a monocle mock-up ignore the extension just copy the text in that so you see you've got this if you copy all of that text and then what you'll be able to do within arrows if you go to export markup you can sort of select everything clear it and then replace it with that and then if you hit save it will bring up that model so if you wanted to go and have Flair with that model or modify it in error if you can so that's how you can do that okay so right what's let's have a look what we're going to add in so as you recall what we've done is we've got we've got country we've got province and we've got winery so those of you who were joining in previously we had this really interesting thing to try and figure out what we were going to do with region because you've got effectively a region and a more granular region so in region one it's like the data option region and then at region two is the more granular region and the reason we can't let that is because lots of wines don't have any regions they stick to just province whereas if you looked at the look at the upper California they've got like Napa Valley and that's like a huge space that I will see you got province of California massive massive you know place and then they're gonna have like Napa Valley which again is huge and then you're gonna be splitting off as well so you know think about what we're going to do I was again so we had that conversation around you know what's the right wave CMAs in how would we link them bearing in mind that you don't always have that data so we kind of left that for now and I'm kind of tempted to leave that for now as well just because there's going to be a whole whole host of fun with that but what I do suggest we do is we've got winery so what probably makes sense now is we're going to add white so we've got that information in our data set and what we want to do as well is we can add the the tasters name to that wine and we can add the variety so for some of the options there do have the grape variety so again these do have I mean obviously wine won't have an old on you but for taster and for variety is quite possible that we have no values and burying the mines as well the taster also has might may have a Twitter handle so maybe we want to capture that and for those of you who joined in so just as a quick reminder the really interesting thing about the wine data was that the wine in fact let's have a quick look again I think let me bring up that data survey of me one moment so the interesting thing with the wine that sort what the wine title was they had a lot of information in there so it wasn't just the case of say you know it's some Shiraz no separate year for it was it's like the whole thing is in the title so if I go to the and a couple of things we had the designation so we need to decide what we're going to do designation so we'll have a quick peek at that and but if we have a look at the wine title so what you'll spot in here and this is where it becomes quite interesting is we've got a year in there and that is interesting because maybe we want to have a look so there's going to be certain wines where they come out every year and they're gonna have different year but you know based on the conditions are in that year you're gonna have perhaps you know different tastes different flavors maybe one year was better than this other and so forth but that doesn't exist in separate columns at some point maybe next week we want to stop thinking about how we're going to pour that year out as an example we've got other fun things going on as well is new information but in there we've got some character she's going on it's all good it's all fine and but simply the point here being that we've got a lot of excess information going in here maybe there's going to be a situation where we've got the great variety title but we don't have it in the variety column so we need to add that that's all fine we can look at in the future about how we're going to pull that data out so inevitably we're probably going to be getting rid of some data and loading new data in that's fine that's part of this exploration I think now let's have a look at adding in more why fix these that's fine as quickly that's quickly fixed Lee so you notice there's this equal sign that's okay we're going to just replace that because with okay um so we've got some so we've got the bit the thing around that so we're probably need to think about how we can extract that and then that was one of the things that we were thinking about if we go back to the go back to here we're thinking about what we're going to do back yeah so are we going to connect do we have the wine title in its purest form here and then we extend out a year and the wine title so that we can sort of click the families do we actually want to split it out at this point and then from wine it then goes off to a year and then we attach the review to yes there's a couple of things about you know what we want to think we want to do around that that's fine all right so but first we need to pull that year out so let's leave that for next week and we going to have a look at some and substring extraction approaches we'll have a look at what we can do inside fur we'll have a look at maybe we do that so I don't know we can we can balance what's better than that but for now let's get in the wine and we'll get in the taster and we're getting the variety because then what we can do is although we need to figure out how we're going to sort out the wines we can split out the verse years that can't excuse me that title is being it we can at least now do some fun stuff about having a look at what wines reviewers done are they reviewing a specific time a variety of grape in so for so we still do it fun stuff and those questions so let's quickly revise this model so what we're going to do now we're going to say well I'm going to get rid of this flap here that so our data model is now going to that's just let me stretch that a little bit better okay so now we've got a data model what is going to have this so we've got these these bits that we've already got it and what we want to do now is we're going to add in the winter we're going to add the title of the wine we've got the description so that's the review that the wine had we'll leave the description for now I think let's let's keep that off so we'll have the wine we'll have the price I would have the title I'm probably not going to bother with the doorman to put those put the wrote in let's put a little bit of air in because it means it will probably be able to load the data a bit quicker in the future buffering sure give it a couple of moments okay I think what back what would that excellent so let's and so I'm going to do that so we're like the wine so we went the description in just yet we probably want to leave that for now because maybe we want to do something with it but live in the wine title we'll put in the price we'll put in the road just because maybe a bit a bit quicker for us to so if we do if we put an index on the row number then if we we do REME puts in the future there'll be a lot quicker froster golf and bring it in via that so let's that seems a sensible thing to do we'll bring in a variety name so we're going to go off so that's going to sit so here we're assuming that the wines are unique and they certainly the will be for keeping the year in there right obviously that's not going to be unique so it probably ain't in use merge on that to pull that in and you've got the taster name again there's going to be many tasters so it's the same taste that tasting many wines so bring it in so this is what's going to be our extended data model so let's think about what we're going to do with regards to the Dixie's so I am just going to minimize this that we can oh actually it's not gonna work see well that's okay let me just pop these into browser so we know we're going to create an index on a wine on variety and on taster so let's do that now so actually in wine ID and that's just the ID that's in the the CSV and what you will perhaps notice they're all a bit a jumble that's because I was removing the duplicates from data earlier and I was sorting by properties and things to go to do that so they're a bit jumbled don't worry about that in fact let's go on and let's sort these back into order you'll notice there some gaps and that's just because I removed some of the data so let's just quickly so they Sunnis or by Heidi its most the largest excellence let's say that okay I've just realized that I changed the hmm right so I just one thing I've just spotted is I'll have changed the things I don't worry about this I'm just going to quickly change what imported so to get to the folders where you input data if you click on the three dots in a database and manage and then you have an option to open folder and I want to be the import folder so I'm just gonna quickly I was using the github repo I have that have no that's fine that's fine so that's why it was taking a bit longer to download so yep so don't worry if you copy the if you copy what I've put in the in the code you'll notice I'm pulling it from the github repo that's fine but you can update it and get it from v3 rather than v2 so that is all good so sorry about that small spot of confusion okay so let's create some indexes so we're gonna create one on the on wine we had a taster and I'm going to assume that all the tasters are unique and we haven't got tasters with the same name she's four now that's fine let's do that some not the into the world and we want to try it in index on the variety wasn't it named let's have a look at arrows variety tasters name like okay brilliant so that our index is let's create those there we go so the indexes are in place and now we are going to have a think about building out how import queries so I'm gonna go back I'm you know why I'm all about reusing if I've got something like I think so let's go back and swipe okay so same idea we're going to be placing some nodes so I'm just going to change the dress to this to v3 let's listen figure that's what's going on so I'm just gonna change this to the survey's because we want the new one right I'm not too worried about countries and things I should all be fine so same idea as well so we've got just quickly check the names of our rows so we know we've all got designation as well let's leave designation for now I'm not too sure what we're going to do with designation Oh Nouveau oh yeah now let's let's bring those it let's bring the designations in as well so let's quickly update our model so a wine has a designation and then again to wheat you know we can we can change this if this isn't if this isn't quite right it's designation name I'm not being very inventive with the names last fight this is all good we can do this that's designation name and has the designation is Sig okay all right okay so let's add index with designation as well before I forget name that's great that that in excellent okay now let's get some data in so we're gonna use some approach so we're going to assume pop from the wine where that should be titled for that we're going to assume for everything else that it probably doesn't have it doesn't have the nothing so let's just quickly check our road name so we had one row which was descript formally descriptions now I've got the designation so we know there's ignitions name sorry about that if I dropped off there so we were just I was just checking through the row header so we're gonna keep the same pattern then we can decide if we want to get rid of these so I let's say no designation no well so we had we had we had a taster name let's taste it under school no you such a knife as a coffee oh that I'm going to leave the Twitter handle for now because we're gonna end up with many many many for each if for each case one and it gets a bit messy but what I'll do is I'll upload the script bringing in the Twitter handle on to the repository so keep an eye on that and you'll have that there okay so we've got designation we've got taste the name taster oh let's make sure we're designation I should be taster we had a wine so that's going to be wine was it just title it's just called title wasn't it oh and variety we mustn't forget variety so oh no we know that title is gonna happen so let's leave this one for now let's go for variety I think we said it was right she wasn't it very yet a variety and then we're gonna add cm we pulled these all knows wine ID oh no no no we did this one I didn't we so when ID is going to be rolled up D and I'm gonna do title a title hey did that's just option I'm gonna give these more sensible things not that we need these but you know it's nice okay so what we're gonna do so this first one we're going to do our fun stuff to check for designations no land that's accordingly check the taste tasters null and deal with accordingly say for variety and now we just created wine because the wine must exist with an ID and the name otherwise this state sets fairly pointless otherwise okay so let's say hopefully I should or run without problem famous last words aha okay let's just have a quick look at what is going on why does it not like why does it not like that sound quick peek let's go up see okay let's I will okay what I'm not sure what's going on there but that's all fine I will go away and fix that so I'm going to do for now is I'm just going to copy this into my import folder I mean we could we could run it from we could we could run the previous one that's fine so I'm not using the Twitter handles it's just got some duplicate fields and I would quite like to avoid those so I'm just going to quickly import that file into here and I'm just going to do it from that so don't worry the queries that I upload they'll be corrected and working to run off the github repo but for now just so it gets some data in there and explore I'm just going to do it from local and get rid of this right let's run this okay well that's going to that's loading some beta we're then going to go away and we're going to add the relationships after it so similar idea I'm gonna go off and reuse at what we've done previously we're gonna hook in those relationships and away we go oh there we go that's all in fantastic right okay again I'm all about reusing stuff so I'm just gonna quickly grab a copy of this query and I'll show updated accordingly on the repository but for now let's grab that other one because then I don't have to reinvent the wheel with regards to dealing with null values and so forth okay it's nice fit big I see what's going on so I'm just going to use this now and then I will get that working so you can use it from from github if you copy/paste the thing so rays that are interested that we are interested in designation no basic nation otherwise and designation I got right taste it taste a name and do we have all the variety and variety okay to be so good at spelling write it into this okay and we now want to match our wine oh yeah so we can do that and we're going to do that from the eye because we know that it's so we want to also send you line able to row we want to keep um Road dots my D is that the work we're doing this yes right I do that should be okay how's my deep which it's not fried paneer and there we go and fix it so it's all good so let's have a look okay so you want to match we want to match d designation that's going to be named it's ignition I could call it that ah called epic name place stops me from getting confused it's a D designation to taster and they do be variety name that's variety and more which is we want to get our fine oopsy-daisy value that w wine and it's going to be ID : like it because that's what we named our property from earlier and now we are going to do a bunch of connecting so I'm just going to so just quickly remind myself of what this looks like so what we're saying is wine you've got a relationship from Wayne to winery and that's going to be a create relationship because we expect we don't need to do a merge on that so let's do that soulless what we're able to do this and I said quick look well these are all going to be these are all creates okay that's nice and fast because bearing in mind so you know how we made that assumption that each wine was unique in the list so we're not going to be merging relationships they're all going to be crates can you think about it wine is the center of the universe so all of these relationships are going to be crates that's excellent us nice and fast right okay let's go do that then so we get rid of all of these because that we know what's happening we're gonna do create wine oops oh we said from winery wasn't it from winery ah okay you know we've I've forgotten to do I've forgotten to get the winery because we need to connect it up as well so okay that's fine that's not problem we're going to just copy and paste one of these that's great that's easy to sort out so um row winery okay nice and that was nice and easy one to sort out just make sure we did call it one or didn't we yes one re perfect okay now it's fine so from winery we started then we he was yep from winery winery oh I just got to match up here when winning name is winery okay okay sorted and you're gonna say win and gonna be eight so we've connected the wine to the winery let's now connect a winery to variety so as be trying to me if I can do it some comments that's no problem it's not a fit ticket you know they'll give us a helpful error and then we can correct it so it's all good so wine has a taste is what did we say Oh rates wine okay we added okay I'm going to leave the school for net will add the score later that's fine so host designation and taste the rates wine okay let's do that so taster great wine and we also said the wine has designation and I was for designation okay right says quick checks we're saying wine is from a winery at wine has a variety tastes the rates of wine and a wine has designation okay let's see what happens let's run this and I just well okay it's not complained so we're doing well and then we'll ever quit look at the schema afterwards as well to see what's going on I'm just gonna quickly grab a copy of this whilst it is running that can do any tweaks about all right will and I shall update accordingly I have there we go it's all in so let's quickly have a look at the schema and this is just basically just showing us what have we got loaded in what's connected to what and so forth so let's do a quick peek what's going on there excellent right let's see what's going on it so we have got okay so we've added to our data we have got country province and way from before and we've now got wine and wines connected to winery wine is being rated by taster one has a variety and it has designation okay cool so it will move right breathe okay so you've got some daydrian as we discussed so we've we've refactored our datum also we can add a bit more information in there we've brought in some more data that's a quick peek where we're at now lots of nodes Oh lovely lots and lots of data okay so we've got that in so I'm right I mean let's ask some questions of this and then I think we can we can call it today so if you've got any ideas of what your as a query Chuck them in the chat them in the chat I'm gonna have a quick look at this myself and have a think about what we might ask I mean I think certainly oh what's a horse a popular variety maybe that might be interesting bearing in mind that this 30 that this data is putting in a bit 30 just because I don't know how strict people have been about sticking with the variety names in fact let's let have a quick peek of that so let's let's do that what's in it let's do much the variety turn bingo name that's named order by name just going on in there so we can put it have a quick peek if we've got any sort of funny spellings oh that's too bad I guess the interesting thing here like Alec Antonella Cantor was that you know did we treat those as the same so that's going to be a fun one for us to have a look in the future do so another one will be Aragon Eze and Aragon is you know I suspect these are probably the same variety so probably won't ever think about how much group those I've actually done some stuff on it stuff in the past about trying to join things with a similar name so I got a city cursory Kiko so we've got some interesting data cleaning that we can do here so that's fine we can do that that's not problem and the a pop libraries have got loads of really useful functions that we can use where they can do things like looking at sadly no words that sound similar we can do things like Levenstein distance or the others of fuzzy text matching approaches so it's a bunch of stuff we can do so we can try and join some of these great varieties the varieties we've got here together if we think they're the same tell you're having a quick look here we can we can see we've got some of this going on so yeah this is this this is all good stuff so okay so we've had a quick look at the look at that so the interesting thing is well you've got like sort of carbon carbon a Franek cabernet sauvignon like you know do we want to split these out do all to say that this is some kind of a family an interesting thing as well will be do some of these have hyphens like Cabernet Merlot and then maybe cabining but - Merlot so there's some interesting stuff we can look into that that's again Cabernets Shiraz Cabernet Sierra so that's the sorceress your s same grape so there's a lot of interesting things we can do that so that's definitely something we can explore in one of our sessions where we look at some of the approaches we can do to clean the data that we've already got in the database and figure out what they some kind of DGP entity resolution that so great that's great stuff so that was interesting about variety going on in there what else did we say it was interesting also look at texture let's see who's our most prolific taster I think that's something we can definitely do now before we call it a day so let's have a look so most I feel like I want to call it the tip sister taster that be tasting with someone so that's the most prolific most prolific taster I can't think about busyness this deluxe so let's let's have a look at what's going on that ah so we're going to do let's do match taster right wine okay poor dumb about this cuz cinnamon ratio that's so good we can be complete wine and then what we can do is return t dot name actually gonna let's do this I know you like turn t dot name yes taster let's return count W as total order by two Sundays so here is who is our most or most prolific tasters of the wine interesting ok so I think we may have had a had a problem with how is imported the data as well maybe we should have tested this because you can see this because we've only had one taste to come back and that's that's probably every single one that we've got in the database that's fine let's go and fix that so let me have a quick look what if what have I done so have I put the I don't taste the underscore name what did I put in when we loaded in taster so we can't do this quickly I'm just going to quickly grab this and what we can do is this turn wrote limits five I bring back some data yes I forgot to add my all to don't need that anyway we're just telling them what's going on so let's just quickly do return taste the name okay so what did we what went wrong that's okay so let's really get rid of taster for now because obviously there's something not quite right going on with tasting see if I do let's do match team taster turn T okay getting becoming more and more curious isn't isn't it okay so we do have taste is in there so we've loaded the dates for okay it's just that something strange has happened with what's happened so let's double-click on Mike is Mike connected to some wines no okay so something has I suspect what's happened is something has gone wrong when oh I just spotted what I've done here so I'm just gonna quickly show you a clip so what happens and this is the bit of the import so the when we were creating the rotating the notes the taster that was fine that's look on it but this was the bit when I was trying to link together taster with wine and you can see what I've done here I've accidentally added an extra row so understandably that conditions always been wrong so it's always been defaulting to no taster so that's okay we're going to fix that that's not a problem so the first thing we're going to do is we're going to drop the relationship between basically no taster and the wine and then we're going to just report the date so that's fine so let's first drop that relationship and we're going to do that for doing wine refused by rekhs whiter Oh rich wine taster Oh taster I never gonna do please oh delete oh and then that's just basically get rid of all the relationships between those who knows - let's do that and then we're getting suggest three important that's fine we're just going to I'm just going to take the previous query and we're gonna just correct it and all be good with the world once again let me just quickly that okay so let's just expand this so don't need designation that's history for exit let me run it again so this we don't need taste that we want and we're going to want the wine so let's do get rid of this I would row ID as ID so that's going to give us some wine ID and we want to match the taster so don't need this and we want the wine let's get rid of that bit and let's get rid of it come for that and then what we want to do is taste the roots of wine let's do that okay right and let's run that and then hopefully we'll be able to go away and answer our question there we go okay so let's go back to our original question now what you can do as well and I'm just gonna get rid of some of these frames if you really written your query and you just want to run it again what you can do is you see it's a picture of like a loop that that will refresh your query so this we know this query that I wrote is basically going away and finding the you know who's who's rated how many wines so I'm just gonna refresh that and you just run the same query again oh okay as exciting oh the plot thickens what if I'd done this time I you know I've done I corrected one line but not the other line that's okay we can we can fix that so if you want to cycle through historical cruise that you've run just press the control key so I'm going to go back to my delete statement I'm going to get rid of those relationships and then I want to go back to my port query and I'm going to correct that this time I'm going to check that I've corrected all of it there we go so you see this I missed this one here so it's all good these things happen it's fine right okay so let's get that in but it's not it's a nice quick query so that's not a problem at all okay we are done right so third time's a charm this should this should now be correct and working there we go excellent so I send you thing they've got a huge number of no tasters going on which is which is quite fine so that's something we're going to investigate and see why have you got a large number although very new mind we had something like a hundred and twenty thousand wines so that's what about twenty percent don't have a taster associated with them okay that's cool we can interesting so maybe a really fun thing we can look at as well is can we make recommendations about who the tasters should be for a wine that doesn't have a taste this and maybe tasters taste certain wines or wines from certain regions so maybe a nice fun thing we can do is build like a taste of recommendation engine so we can go away and say hey you know because you always review like say New World wines these are ones you should be looking at next so there goes just fun we can you know it's interesting things we can do the data so part from mr. no taster we've now got the other tastings at the wine and as you can see you can we've got the groups that we've got so Roger my corker in fall and so forth and let's just for a bit of fun how about we extend this slightly and let's change rather than just having the total of wines are reviewed maybe we will do the variety of wine so I'm hoping this isn't going to be a crazy number of varieties coming up but let's just change this query every slightly and let's bring back the varieties of that the that these tasters have been testing I'm going to exclude no taster because that might be a bit crazy so I'm gonna just do this less so remember wine it was a wine has a variety doesn't it okay so let's do that that's variety the variety and I don't want no I don't want no taste it so let's do this I'm just gonna split this curry out a little bit let's do match to taster where Twp name why not it's tea alright let's do like this okay and I want to return the taster I want to t count oh yeah we do we do think we okay I want to counter the varieties actually I don't like everyone this kinda line count wine as faithful and Colette we go name our distinct feed of names as well because they they're going to be doing there could be many wines that got the same variety so I thought let's do that so let's just do this name as varieties and then let's return the taster we're going to return the total because actually you know actually very interesting here we made that we've liked tasters who've tasted loads and loads of wines but from such a tiny variety and the interesting stuff they will be like the tasters who reviews you want to read will be the ones who have got like much better and wine tasting to wine variety ratio so you will want to try lots of different varieties of grapes some of interesting so let's have a look at that so let's do we're gonna retain toasted to taste the the let's see the varieties let's do the total are we gonna order it by smell less if there's any new lines it looks big nicely all right let's have left I'm intrigued by this i am very intrigued by let's let's see what comes back oh my goodness okay what's going on here did we say that Roger tasted that many I don't think that looks for I know he did oh my goodness that is one perfect wine drinker okay so I I hate to imagine how many years it take to taste that many wines my goodness yes wow so look at this huge a number of them varieties wine going on here I say my dear as well so it's starting to get the view of this so I mean I'm not going to do it now but maybe we can try and figure out how we might sort this list so it's a little bit of a fiddly thing to do but okay nice is interesting so what I think will be really great as well is so we covered the fact that there was a fair bit of and there's a fair bit of Jupiter dating the varieties by the fact that the spelling slightly different or they using different names of grapes so like for example Syrah and Shiraz is a great example so I think a nice fun exercise will be what can we do so it's the ones where there's there's a nameless light spelling you know those ones we should be able to quite quickly figure out and join those together but the other thing as well to have a look at will be it can we use an external beta source to help clean these up and just as an example we get things here like red blend and I suspect there's a few of those which talked about some like a red blend or what have you so I think what would be good is if we could do something to neaten those up so I think one last thing because this is actually quite fun for me I'm hoping you guys have fun it's interesting in the feeling inspired there sort of inspire to go away and experiment with a dataset but I think something that was really interesting as well is let's have a look at red how often does word red appear in the variety name so I'm gonna just grab this query so that we can say we we looks at it but let's have a quick let's have a quick peek how often there's a word of red appear that is probably not the look so when I use I'm going to basically say anything with the word red in there so we might catch some things I've got over it right inside there but that's fine we can we can tweak it later so let's do the variety where the name contains red and I'm going to lower this so that we catch everything so lower name contains red returned VDOT named order by name so let's see what happens with this so let's let's see what comes back what is very exciting about it's gonna be a lot of red oh okay no not too bad not too bad not too bad at all so we've got got that so of them six-six redstone I think what would be really fun at some point where we can look out and this is so many ideas we can do and but you'll notice some of the varieties don't mention what color while mayor and I think certain blends will always be a red or white so there's going to be a fun bit of work around try to figure out how we can do that how can we try and calculate those but this is all good okay so let's let's do the same thing with white how many whites do we have I hope it green I look at green one as well so in the Madeira they do like a young wine this green wine I'm intrigued to see what comes up oh wow look at that we have we have lots of whites in there so things like I mean I try to forget what we do likes of white blend what would we do with white blend you know it doesn't lend itself to anything but that's fine that that's for another day so last but not least so I'm kind of a quick cheeky look at Oh Roe same green as well as big green do we have any green wine I'd be excited if we do I think they call it sings specific yes I need to look up what do they call it I mean they call it a bird a bird of wine a big green so that makes sense uh-huh okay no not quite we can have a look at that later but I said quick look at Rose I and then I think we will call it a day it's been a it's been a good session I'm looking forward to doing this next Saturday when undoubtedly we have a lot more questions oh oh look at that no roses have come up just the the invite word so that's interesting okay that's cool so what we covered today so we have covered we we looked at the original import stuff that we did from last week and I've talked to you through what we're doing and that were handling nulls and decisions we made about what we were going to do those we had a look at some of the questions that we could ask from that so that cut down data set we still could ask a lot of interesting questions and we made him you know some very interesting discoveries the fact that only 2300 wineries had more than one province so they were safety too which was very interesting I was expecting there to be loads but actually a lot of them not subtly so maybe there's something to come out of the come out of the region Batum when we finally decide how we're going to handle that we had an interesting thing to look at that we've got a large number of wines that haven't been reviewed so an interesting thing around looking about what we do to do that so jumping around the place I said we hadn't looked so we had a look at wanting questions we could ask from that cut down bait sir we then went away looks at our dates model and thoughts about what more we can add so we've added to some additional data so we added that the wine title the we added the variety we added the reviewer and so forth so we haven't that dates are in there we also then started to have a look at some simple questions so things around having a look at which review is a most active we had a look at the different wine right and so forth so it's a very rich data and I guess we're still going to be doing a bit more of that they exploration so as we're going through the data it's helping us to figure out more things we need to investigate so more things around something basic cleaning dealing with duplicate Beto's we see the varieties we still need to think about what we're going to do with regard to the wine title and getting the year out I'm not kind of think so plenty more to come on with but we've covered a lot very interesting ground here today so what I will say is do go go away have a play that yourself you've got the repo to give me a few days and I will do a write-up of what we've covered today up in the repo you'll have all of this cycle scripts to run you'll have the data set I'll figure out what's going on github there so you've got loads of things there to just go through and click if you have any questions so again I mean I'll hang around for a couple of minutes from the chat today for you want to ask anything but otherwise do tweet me if you've got any questions something comes up you're watching the recording and you've got question ping me on Twitter or comment coming out to do the best I can helpful you can post post them to github as well if you've got a query something else I'd flagged as well I will be doing these on Saturdays I think this is great because it's an hopefully this is more accessible to more of you it's just probably hope hopefully the time zone I've been doing this for a few Saturdays and also means you've got like more sort of freedom to go away and explore things without being a mad rush what I will say as well is I just want to make you aware that I also do Monday's as well so I do Mondays at around 8 o'clock Eastern Daylight Time so it's 1 o'clock at UTC 1 1 o'clock British summer time and those slots are very much about you know do you have any questions jewelry to try something out so the kinds of things that we've been doing on those sessions we've been doing creating browser guides bloom perspectives of playing with graph QL so there's a range of things so if there's something you want me to have a look at you've got questions let me know this Monday I'm going to be looking at entity resolution so I've been playing with the food they'd set which is quite relevant given that we're going to be looking at the duping some data in this wine set so it's really a lot of common things are there but that's on duty preserving in particular you want me to cover on next Monday slots let me know again just ping me on Twitter and I will look into it but apart from that I hope you've enjoyed this as much as I am I find this really fascinating it's really great to work with a real dataset and it's brilliant when it throws up more questions that you're expecting I'm hoping you found that helpful and I look forward to you joining me next week when we do it again take care have a marvelous day bye 