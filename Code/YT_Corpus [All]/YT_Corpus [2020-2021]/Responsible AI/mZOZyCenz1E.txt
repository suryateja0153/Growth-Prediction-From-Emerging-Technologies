 [Music] hi I'm Tommy Thompson and welcome back for part three of the AI of sea of thieves here on AI in games in parts one and two I looked at whole rears online pirate game bounces the AI systems at play across each server Plus how skeleton and shark AI are built to keep players on their toes both on land and in the water in this penultimate video we look at the three biggest threats players face across the sea of Thieves Megan Karen and scaly what is it there's it's Kevin and it seems to be open to debate all of the AI we've seen today in this case study is built to facilitate a specific design element the pigs snakes and chickens bring life to the tropical islands the skeletons present a threat that seeks to thwart your quest for hidden treasure whilst the Sharks seek to keep you from sitting too long in the water while other crews of players present a threat as you sail the sea of thieves Reyes ought to add even greater threats that could sink even the strongest of galleons launch players could fall prey to the kraken as a hunted ships on the open seas meanwhile the hunger in deep expansion introduced the matey Megalodon plus the curse suit sales event brought haunted galleons commanded by skeletons to open waters each of these act as larger event battles on the sea that have varying conditions that enable their activation the Kraken has always been hunting the open seas ready to attack ships whilst the Megalodon originally could only be summoned having completed Marik's quest lane and traveling just south of the devil's Ridge similarly the haunted galleons which first appeared during the custard seals event but constrained to three specific size near smugglers be shark bait Cove a Marauder zosh however since those expansions both the Megalodon and the skeleton ships have expanded the limits spawning in the open world and attacking players in a more dynamic fashion more akin to her the kraken operates as such this has seen each of these experiences add new features such as varying Megalodon personalities and no two sizes of skeleton ships as these changes were being made it leads to new constraints that need to be managed within the core gameplay systems do you allow these systems to interact with each other can you be attacking a skeleton ship only for a Megalodon to enter up there's a Kraken or Megalodon attack skeleton ships as well as players as Sara Noonan explained at one point there was a concern about having more than one of these systems in play at once for a given crew however upon experiencing it themselves been testing internally the opinion of the team shifted pretty quickly I remember we had a task of on the ward to stop Meghan's warning when we had the cracking up we didn't know what would happen but then it just happened once in the play test then someone just took that ticket off the board really like no we need like now we need to spend time making sure that this encounter is good because it was just those layers that we hadn't expected to happen together just emerged in a play test once and it was like okay yeah we definitely need this from the game yeah essentially anything that's like twitch herbal right of it no you know all this will be a gift we have to leave those things in as a result there has been a more concerted effort in recent updates to ensure that these interactions continue to prove interesting and fun whilst also enabling them to interact with one another all the while keeping all those AI overheads discussed in part one to a minimum during my visit sorry I had the chance to sit down and chat with the developers whose work had proven critical to the release of each of these features Andi Bastable who discussed his work on the shark AI in part two was largely responsible for the development of the Megalodon while Chantal Porat and Tristan Bale had a big hand in the ongoing development of the kraken and skeleton ships respectively but during my review and skeleton AI with robin sarah from back in part two i quickly discovered that each of these systems goes by slightly different names internally i remember i always remember when we were working on mega and on the Megalodon yes we've got nicknames further Megan and Karin and so Karin is cry so while the Kraken and Megalodon became Karen and Megan respectively it seems like there was some disagreement on the scale in ships what was the name for this ship never really that was terrible in the skeleton ship did we settle on seven yes so so Andy Andy has I think named them all and he came over and he was like so we've got Kelly no it was Karen and we've got Meg we need probably like a boy's name for the skeleton ship just to break them although what should we do is like sceva but Lee are talking about it with Andy it seems there was some method behind the madness of the naming conventions I thought it's going so I thinking of it was all of our kind of creatures were named after women so we had Karen the Kraken and we have Megan the Megalodon and ships were traditionally named after women like they're traditionally kind of like you refer to them as she and her and so we thought oh we should flip the gender like we've like we've done with our creatures we should we should do the same with the with the ships and so we thought that's where we good to give him a male name and then it was like well what male name starts with SK and as we're skipping from but hey I know you're here to listen a bit the AI of these enemies so let's do just that let's look at each of these threats in tongue the basics of how they work the tweaks and updates made since launch how each of them fit within the existing AI management systems discussed in part one and the fun treks required to have the skeletons run around and take command of the haunted ships let's begin with the easiest one to explain Megan the Megalodon or as she was called during development baby shark it was a good name that sought to keep the developers and tensions hidden from data miners always spying for the next update she's arguably the easiest AI to explain because well already did much the legwork in Part two given that the mega dawn is for all intents and purposes a larger version of the original shark AI only she no attacks ships instead of players the Megalodon basically came out of a conversation when I came in one day and my producer drew basically said Andy how quickly can you scale up a shark and and that was when I that was that I knew that liked my work my week was going to get a bit more interesting and obviously the Megalodon is more than a scaled up shot but that's effectively where it started first of all we started by going if we were to take the standard shark stuff we've got and just scale it up does the part thing still work for a start the animations still work then can we put modeling that makes it look more aggressive and scary at that scale because obviously as the standard shark at that scale doesn't necessarily look as kind of scary and then after that it was like okay we knew that we had that working so we had the technical side of that kind of sorted and we had to make a few adjustments here and there but by logic just kind of like works however it's not as straightforward as just beg sharp Megan's behavior does rebalance to better fit the pacing of naval combat yeah well we had it differently because I'm it's different from the hunger indeed to the actual women when she's in the world because I think the hunger in deep we had it where she will just spawn in a specific position and rise up out of it yes angry raw but then when she's releasing the world now and she's just there she were kind of just a Pierre and then she will just come up and I think it completely depends where you are as to where she will appear but she will generally like attack you from the side and come round and get you but the way she will just appear or if she's feeling dramatic she will just do the big roaring drone Jim fallows the third the sea as well and come Gaia a set of gameplay timers are used to balance the frequency of her behavior say this includes popping out of the water to swim alongside your ship swim under the boat and of course attacking and taking a big chunk of the hull mo she presents a big enough target to shoot at for the most part there's still a need to ensure players can take her down and not feel like the experience is unbalanced this not only resulted in custom visual effects been employed such that the fin on top of the Megalodon are better visible when on the surface but the existing shark navigation systems discussed back in part to unemployed to ensure that Megan is often positioned such that she is within cannon range we make a decision about whether the megladon when it comes in for a bite is going to come in cannon sight ie you can hit it with a cannon or front and back of the ship where you definitely can't hit it with the cannon but what we don't do is we don't allow it to come in at an angle where you feel like you could hear them with the cannons but you can't because it's in that funny zone where you can understand quite twist a knife so in order to get in order to and for the player to not feel frustrated we don't allow it to approach in those way you either no you definitely can't hit it or you know you've got a decent shot hitting it and we stop it from attacking in those gray areas Megan can spawn in to attack a crew once her cooldown timer has ended after which point any crews that are out on the open waters can potentially suffer her wrath however despite this there's actually a good chance Megan will pop up just to mess with you the updates since the hunger in deep have added a lot of variety to the Mega Dawn's look and behavior with different skins as well as the chance she can spawn in a passive mode whereby shall only attack you when provoked there are random chance is dependent on whether she will be aggressive when she spawns or whether she is just passive and then I think I'm dependent on him if you go after her she will become aggressive so if you antagonize if we start shooting her she's gonna get alright she's gonna come back to your zone depending on how much damage she takes yes and she will eventually turn on you and become aggressive next up let's deal with the boss monster released at launch Karen the Kraken the Kraken periodically ops to attack a particular ship somewhere in the open world upon triggering the attack the seas nearby ton black and several tentacles rise from the depths each time the Kraken spawns n the tentacles surround the ship and yeah it's just tentacles as many players have suspected since the beginning Karen doesn't actually have a body our tentacles are a mixture of those that are actually going to attack players and the ship as well as those that are merely set dressing and are designed to add some scope to the proceedings Karen is unique in that she's the only AI character in the entire game that isn't relying on the behavior tree architecture an unreal engine for each tentacle is its own unique AI component which can either attack a player attack the ship or simply sit in the water and not engage however the tentacles are built such that they all receive instructions from a system known as overlord which dictates which tentacles should be active and selects the valid targets the Overlord has built more or less as a finite state machine and its job is to keep an eye on the time between attacks whether a tentacle is attacking the ship or players and the types of attacks currently being employed much like Meghan Karin's tentacles are deliberately spawned in such a way to ensure that you can defeat them with them deliberately positioned around the ships such that they are within cannon and pistol firing range plus each player and a given crew that is going to be attacked by Karin has their own corresponding cooldown timer when that player is attacked by one of Karin's tentacles the cooldown timer is reset so that you know for a period at least you'll get a breather and either recover or start attacking once more plus more critically this distributes the damage being delivered across all the crew in the ship henceforth a bit of coordination and even a little bail luck you can send Karen back to the depths of the ocean every time Karin attacks a ship on the server she'll wait a certain amount a time before doing so again hence as a chance for all crews to go about the business for a short while before they're attacked again while the time between attacks is still a secret the Krakens attack cooldowns late the mega Dawn's has changed and received tweaks throughout the first year of the game's development however one interesting thing I did learn was that she doesn't discriminate and will happily attack any crew that is out in the open Wars even if it's a crew she's already attacked in the same play session so while you may be safe for a time most attacking a skeleton 4 on land you better be quick a bit dropping all that loot off at the nearest outpost what I think was one of the play tests here where we're testing ports and someone betrayed us as Oh work together we got all the treasure and then they they killed us all and then took the treasure and then when we came back we saw them sailing away and then get attacked by last but not least let's look at the skeleton ships as recently as the schroederd Spoils skeleton galleons can never appear on the open waters and proceed to attack players if they get a little too close each ship has its own crew of individual AI skeletons and as an interesting combination of real-time AI behaviors being deployed with smoke and meadows to streamline the overall process for the developers whilst attaining the desired effect it's actually the most complicated set of AI systems in the entire game and took months to come together from original concept all the way to finish product the ships themselves are relying on their own unique ceiling and steering mechanisms given much like the issues had with the shark AI there's no navigation systems built in ue4 to handle ships atop water so each skeleton ship has its own collection of sensors not only for detecting nearby obstacles but calculating where both it and nearby ships be the human or AI controlled are going to be a couple of seconds from now this helps anticipate collisions with nearby islands rock outcrops and even other ships unless of course it wants to RAM you and allows the stealing AI to move the ship accordingly this projection is also applied to the ship's rising over the ocean so that they don't land the top another ship like the Evel Knievel the actual movement speed is being calculated based on the potential it can achieve based on wind direction and adjust it accordingly now if you consider the makeup of a haunted ship it has numerous skeletons running around the deck each of these are reliant on the skeleton AI framework as detailed in part two well the interface with a virtual representation of the players input to do the same things we can however that are some limitations they can man the cannons and repair damage using the planks in their inventory but they can't bail water which has led to some creative solutions for defeating them by players but it does employ some smoke and mirrors to sell the effect of a skeleton crew manning a ship the anchoring sales aren't controlled by the skeletons the ship itself corrects their position Plus having explained all of the navigation systems a minute ago this actually removes the need for a skeleton to try and calculate the navigation itself but despite that the ship can steer less this fella right here is at the helm the captain so yeah well the captain has to be at the helm in order for the boat to sail the ship is sailing itself so what happens if the captain's on the wheel then everything's fine if he comes off so you can cruise around and stop that from happening but if you aggro him off then it kind of breaks the tracking and he sails off and then if he survives or he kills you you leave then he'll go back onto the wheel and then so so only the captain skeleton and captain the ship however despite how cool all this is the real success that has been achieved in the skeleton ship eaj is one that most players would never think twice about the skeletons and the ships are actually moving around both on the deck and in the hull the capable of moving two holes in the hull to repair them as well as head for the cannons to fire them no this is something that for most players isn't all that groundbreaking but from an AI perspective this is actually a really big deal and the one thing upon playing sea of thieves that really took me by surprise let me explain as I discussed back in part two we typically use a system called a navigation mesh for characters to walk across 3d environments and in fact all the skeletons on the islands are using the nav mesh system to move around however navigation meshes are typically built or baked into the level in advance or like in my recent case study in horizon zero dawn calculated at runtime based on changes by rocks or other small items being moved around on the surface of the nav mesh so yes they can adapt to changes in objects and characters being moved around on the nav mesh itself but the navigation mesh itself doesn't move if the surface itself was moving it would have to recalculate not just the nav mesh but also the paths of all characters standing on it every time it moves by even the smallest amount that's simply far too much CPU and memory resources to consume it's a massive bottleneck but here in sea of thieves the surfaces of the hull and deck just moving in lane with the waves of the ocean always moving but they're on a moving ship at first I thought it's faked that the skeleton simply moved from one point on the ship to the other but if you look at how they move on galleons they're running around as they wish all the while adhering to the topography are standing on a moving ship with respect to the physics of the ocean how did they do it the big secret is that the navigation mesh for the ships isn't actually moving it's baked deep into the ocean the navigation mesh for the entire ship is baked deep down on the ocean floor and each skeleton is plotting their movement on that nav mesh this nav mesh doesn't move with the ship and it stays at effects point meanwhile each coordinate on the navigation mesh is translated from the ocean floor onto the ship's deck and hull respectively this has the fact of the current orientation of the ship with regards to the ocean surface meaning the navigation paths need to follow the actual rotation of the ship as it crashes through a wave it's a really creative solution to an otherwise horrendously complicated problem and whilst not perfect it achieves what the team wanted really really well [Applause] while players present a real threat to one another as you seal the sea of thieves the AI characters are sterile in their way throughout the past three videos we've covered all of the AI systems that are running under the hood during your sea of thieves experience crafting missions for you spawning a variety of friendly and aggressive AI characters on both land and sea and balancing the overall experience for players across the server but despite all that I'm not done yet a game like sea of thieves takes a lot of dedication from the entire development team at rare from artisan animators to zone designers and programmers and it can prove challenging to steer a project of this size so my closing entry and the AI of sea of thieves we're going to look at testing and deployment systems used throughout the game's development and how its streamlined working practices I'll be chatting with Andy and Rob to have the leads in the project that were responsible for stealing this new direction on the sea of Thieves codebase have a testing system helps prevent bugs with AI and other gameplay systems from reaching players and how automated builds enabled for continued rapid development of the game long before I ever appeared on the Xbox Marketplace stick around for this one folks it's gonna be something special 