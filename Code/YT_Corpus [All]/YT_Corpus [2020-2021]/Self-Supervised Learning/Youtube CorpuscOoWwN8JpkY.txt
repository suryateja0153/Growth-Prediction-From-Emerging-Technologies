 Hi my name is Franco Matzkin and i'm a PhD student at the research institute for signals systems and computational intelligence - sinc(i) in Santa Fe Argentina. i'm glad to be here to present our work on Self-supervised Skull Reconstruction in Brain CT Images with Decompressive Craniectomy made in collaboration with researchers from University of Cambridge and Imperial College London. In this presentation we will be talking about the development of a set of methods for performing a digital skull reconstruction from CT images, in patients that underwent decompressive craniectomies after Traumatic Brain Injury which is a disruption in the normal function of the brain that can be caused by a blow, bump or jolt to the head, the head suddenly and violently hitting an object or when an object pierces the skull and enters brain tissue. Decompressive craniectomy consists in removing a portion of the skull, which can be reused in a posterior stage or may be replaced by a custom-made implant. this procedure is performed to control the rise of the intracranial pressure associated with traumatic brain injuries or other type of head injuries allowing to alleviate the risks associated with the presence of hematomas or contusions with a significant volume of blood. In clinical practice, an indicator that may useful for evaluating the decompressive effort is the skull defect volume, which can be calculated by multiplying approximations of the flap dimensions (this is known as the ABC method). This method gives approximate results, and has to be done manually. Here is an example of how those measurements have to be done, which when multiplied, give a reasonable estimate of the volume. Here we propose a different approach to estimate the skull defect volume, by first reconstructing a 3D model of the defect and then measuring its volume. This is done by counting the voxels of a volumetric representation of the flap, and scaling with the physical dimensions. For this, from the CT scan, a volumetric representation of the skull has to be obtained first. There are several works that use this kind of images with the aim of designing implants. Some of them aim to leverage the symmetric properties of the skull and design the implant by mirroring However, in cases like the one shown in the image, this kind of methods cannot be used. An alternative approach to obtain the flap reconstruction  is register the post-operative image to the pre-operative one, and then subtract them. This method could introduce noise, since not all pre and post-operative images always contain the same amount of slices  and depending on the bone extraction process, spurious segmentations may appear. Moreover, this approach requires to have access to the pre-operative image, limiting the applicability of the approach. The method that we propose in this work operates on post-operative CT scans and is able to handle any type of DC (not only unilateral). Here are some real examples of decompressive craniectomies that will be used to evaluate our method. Our reconstruction method consists of a convolutional neural network which operates on binary skull images obtained after pre-processing the CT. For the preprocessing, the images are first registered to an atlas using rigid transformations, bringing all of them into the same coordinate system. This encourages the model to focus on variations in the morphology of the skull, rather than learning features associated with its orientation and position. After registration, images are  resampled to isotropic resolution Finally, a global thresholding is employed to extract the bones due to their high values in terms of Hounsfield units. We used a threshold value of 90HU. We designed a virtual craniectomy procedure to simulate the effect of DC on full skulls. This process implies removing random intersections of the skull with binary spherical masks that could be located in the surface. This procedure allows us to use of head CTs with the complete skull to self-supervise the learning process, avoiding the need of manually annotated craniectomy images where the flap is segmented. We used the virtual craniectomy to train various CNN architectures following two different approaches: after preprocessing the CT image, the first approach consists of  reconstructing the missing flap only. The alternative approach consists in reconstructing the full skull and then subtract with the original image. These two alternatives define what  are the inputs and outputs of the models. We implemented alternative encoder-decoder CNN architectures to address the flap reconstruction problem which are based on fully convolutional neural networks,  but following different reconstruction strategies. The First one, Direct Estimation-UNet, consists of standard 3D U-Net architecture. Regarding the Reconstruct and Subtract strategies, the first architecture is a convolutional denoising autoencoder (AE) that has the same structure as the U-Net, but skip connections are excluded. We also explore the use of the U-Net following  the reconstruct and subtract strategy. during training, a random virtual craniectomy is applied before the skull enters the model, and sometimes, salt and pepper noise is added with the goal of removing eventual noise that would occur by the thresholding. The images used for this work were provided by the University of Cambridge. They consist in 98 head CT images of 27 patients with TBI, including 31 images with decompressive craniectomies and 67 cases with full skull. All of the 10 pairs of pre and post operative available images were used for testing, using their difference after registration as Ground Truth. For training, we used the remaining full skull images, excluding those images of patients in the test set, which resulted in 52 train images in total.  Note that since we perform Virtual Craniectomies, the actual size of the train split is bigger. We also implemented a baseline model based on PCA for the task of flap bone estimation which follows the reconstruct and subtract strategy  (RS-PCA). PCA was applied to the vectorized version of the pre-processed complete skulls from the training fold. Therefore, for reconstruction, we take  the incomplete skull and project it to the learnt space to obtain its full version. These are the first 10 components for the PCA latent space For the task of flap bone volume estimation, we also compared our methods with the manual state-of-the-art ABC approach. This method requires to annotate manual measurements on the DC images and estimates the flap volume following simple geometric rules. We used ITK-Snap to manually measure the A, B and C segments. We performed experiments for bone flap reconstruction and volume in real and simulated craniectomies. In this figure we compare the obtained reconstructions using the different approaches in a real DC.  It can be observed that those based on the reconstruct and subtract strategy using autoencoder and PCA produce spurious segmentations in areas far from the flap, and the best reconstructions are  achieved using the U-Net architecture, highlighting the importance of the skip-connections in the network architecture. Here we can see the Dice coefficient and Hausdorff distance between the ground-truth and reconstructed bone flaps for all the methods in real and simulated scenarios. The simulations were done by performing 100 random virtual craniectomies to every pre-operative skull from the test fold, resulting in a total of 1000 simulations for test. We can see that in all cases, the Direct Estiation U-Net (in blue) outperforms the other methods, since a higher Dice Coefficient indicates higher overlap between obtained and desired flaps, and a low hausdorff distance indicates less spurious segmentations or noise. Here we can see the accuracy of the bone flap volume estimation: we compare the predicted volume (in the x-axis) with the expected volume (in the y-axis). Here we also included the manual ABC method for the real DC. We can observe that Direct Estimation UNet outperforms the other methods in both tasks, producing even better volume estimations than the manual ABC approach. We observed that Reconstruct and Subtract methods usually generate spurious pixels as prediction, and a post-processing step may be needed after subtracting. This does not tend to happen with Direct Estimation, what explains the gain in performance. We would also wanted to share that we are participating in the AutoImplant Challenge, that is taking place in this conference. This encouraged us for testing our techniques in a new scenario, with higher resolution images and different kinds of craniectomies. To summarize, In this work, we have proposed and compared alternative self-supervised methods to estimate the missing bone flap on post-operative CTs with decompressive craniectomy, employing a virtual craniectomy procedure to generate training data from complete skulls, avoiding the need for annotated DC images. We studied two different reconstruction  strategies: direct estimation (DE) and reconstruct and subtract (RS). We found that direct estimation outperforms RS strategies, since the last ones tend to generate spurious segmentations in areas far from the missing bone flap. The proposed methods were also compared with a PCA-based implementation and the the ABC method used in the clinical practise which requires manual measurements and relies on a geometric approximation. The proposed direct estimation method based on the U-Net architecture (DE-UNet) outperforms all the other strategies. The performance of our method was measured in real cases (in our case, TBI patients who underwent decompressive craniectomy) as well as simulated scenarios. You can find the implementation of the algorithms here mentioned in this GitLab repo, the CNN models are implemented in PyTorch. Thank you for watching! 