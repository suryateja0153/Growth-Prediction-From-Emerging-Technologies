 [Music] [Music] matching in in general graphs at one blossom algorithm recap of previous lecture in previous lecture we have discussed factors perfect matching in a journal graph cuts one factor theorem and effector of graphs content of this lecture we will discuss the matching Sinha journal graphs that is given by the algorithm which is known as advance blossom algorithm advance blossom algorithm if we see the details of why a separate algorithm is now required but we have already seen the matching in a bipartite graph using a woman ting path algorithm for bipartite graphs why it cannot be used here for matching in a journal graphs all this discussion we will see now now we have seen earlier that birch theorem stated that matching m in G has a maximum size if and only if it has G has no m augmenting path so the augmenting path algorithm called a PA what it does is it finds the maximum matching using successive finding of augmenting path this particular augmentation is carried out by the iterations of n by two different times and therefore all the augmenting paths are identified and the matching cardinality or the matching size is increased every time now after n by two iterations it is proved that it cannot be extended why because it will not find any augmenting path hence using birch theorem the algorithm terminates with a maximum matching in a bipartite graph now Adam and in 1965 presented the first algorithm which basically is generalized algorithm for general graphs not only confined with the bipartite graph but it's a generalized algorithm and his paper was called as path trees and flowers in bipartite graphs we can search quickly for augmenting paths because we explore from each vertex at most once an M alternating path from you can reach vertex X in the same part ID sets as you only along the saturated edge hence only once we can search and explore X take this example if this is the bipartite graph that means to part I'd set x and y let us assume that this particular vertex is unsaturated so you can reach to any vertex on the other part I set and then take a matched edge and reach on the same side and then take another unmatched edge and reach on other side let us say it is why so when it reaches here it takes in the matched edge best to come back to the same part I'd set so there is only one possibility to reach to the other side of the part I'd set because matching tells you that a particular edge is incident on only one vertex it cannot be incident on to what s so if it is taking up the matching edge to reach to the same part ID set then it has only one choice because it uses the matching edge hence only one choice will be there and we can explore X in this particular manner so that means in the bipartite graph searching a woman ting path is quite easy and fast also but if a graph is a general graph that means it contains an odd cycle then reaching on the other side may have more than one options to explore hence the exploration is not to that particular space in which bipartite graphs that is the graphs which are not having the odd cycles can function easily and efficiently can done so this particular property that it has to explore once exactly one search this particular property will fill in a graphs with the odd cycle that we will see why because M alternating path from an unsaturated vertex may reach X both along saturated and along unsaturated edges take this particular example this is not cycle if this is unsaturated vertex you when it comes over here these are all unsaturated vertices so there are two different openings of unsaturated vertex where to go if it is an odd cycle which way to go or both ways are to be explored at the same time so this particular property is failed here in the general graphs the graphs especially which is having out cycle hence at one blossom has given a new algorithm to do the matching in a journal graphs that is the graphs which is having the art cycle also how the augmenting path can be efficiently run out that is given here in this algorithm so same example let us illustrate it again regarding the problem in identifying the augmenting path when the graph is having an odd cycle this is odd cycle so in the graph below M is indicated that is the match as is indicated with the red color and the search for the shortest em'ly fomenting path from you when it reaches X Y are the unsaturated ax then we may miss the other path which is basically a longer one but it is reaching to xyr a saturated edge so in this case if we choose to go directly by unsaturated vertex reaching X by unsaturated vertex then we will be missing up this augmenting path that is UV a B C D X and then Y both are unsaturated vertices so this is an augmenting path which will be missed out if we only follow this particular path which is not a set so let us see the definitions let M be the matching in a graph G and let u be unsaturated vertex so a flower is the union of two alternating paths from you that reach a vertex X on thy steps of opposite parity take this particular example you start from unsaturated vertex you reach X with a different parity so this becomes a flower so in this particular flower this portion is called a stem this is called a blossom is an odd cycle and total thing is called a flower the terminology is drawn from the horticulture why because trees were also used in the computer science and in the graph theory also let me again read it out a flower is the union of two alternating paths from you that reach a vertex X that I have told let us say this is vertex X you reach Y at this path and you reach Y R this path from you and this is the union of two alternating path is called a flower reaching X on the step of opposite parity dye stem of a flower is the maximal common initial path so this both the augmenting path this portion is common and a blossom of a flower is the odd cycle obtained by deleting the stem if the system is deleted so this becomes an odd cycle and this is called a blossom so we have stated all these things again for your understanding that if this is the graph G this portion is called a stem this portion is called a blossom and this entire thing is now called a flower which is highlighted let us see the advance algorithm we will then take an example to understand the working principle of Edmund algorithm and then again we will come back to the same algorithm for a better explanation input to this particular algorithm is a graph G also there is a matching and unsaturated vertex U is given as an input idea of this algorithm is to explore M alternating path from u recording each vertex the vertex from which it was reached and contracting the blossoms on the way when from maintaining sets s and T are analogous to those we have seen in the algorithm earlier with s consisting of use and voltage is reached along the saturated edge reaching at unsaturated vertex will identify the momentum path let us initialized s with the unsaturated vertex and T is basically empty let us see the iterations of Advanta algorithm if s has no unmarked vertex then you stop there is no ma fomenting path from you otherwise it has unmarked vertex we to explore from we successively consider each neighbor of V let us call it as Y and Y is not marked that is not in T now if Y is saturated by M then trace back from Y to report an M augmenting path uy so if you start from to reach to another vertex Y which is also unsaturated so immediately you will get the augmenting path now if s if y belongs to s then a blossom has been found because you have already visited that node and is there in the s that means you have reached to a point which is already being visited and is available in s then a blossom has been found suspend the exploration of V and contract the blossom so blossom is contracted with with one what is one vertex replacing its vertices in s and T by a single vertex in s continue search from this particular vertex in the smaller graphs otherwise why is mass to some W by M include Y in T and include W in s after exploding all such neighbors of V mark B and it let us see all these step in a working example and then come back again we will explain you again in this example let M be the mask edges which are shown in the red color in the graph on the left side this is the graph and the edges which are shown in the red color they are in M now we search from unsaturated vertex U for an amalgam ending path we first explore the unsaturated edge incident to you there are two such edges so reaching a and B using this particular edge you can reach a and B since a and B are saturated because these edges in M they are touching up so we immediately extend the path along AC and BD directly go up to this point that is not a problem now s will contain you C and D that means you have reached up to this point from C and D you have to go ahead and you means starting from unsaturated vertex so other vertices from where you are reaching C that has to be maintained somewhere else now then if we next explore from C then we find its neighbor e this neighbor E and F along the unsaturated edges since EF is an M so we discover the blossom with the vertex at c EF c e f why because you explore e you explore F and from F to E and E to F if you basically see which is present in s then a blossom is discovered so this is a blossom so blossom is a vortex had c EF has been discovered because from two different parities we are basically touching either F or e now we contract the plaza contract means this entire thing is basically collapsed into one vertex this is called contract the blossom to obtain a new vertex and that is called C and now you have to change this s so that s will now contain you capital C and D because this will be C so this edge will connect to D this edge will connect to G so this will yield the graph on the right side this particular graph we have already obtained now suppose we now explore from the vertex C which is already present in s unsaturated edges this and this take us to G a and to D simultaneously we can reach here up to here using unsaturated edges since G is saturated by an edge eh we place H in s so H is placed in s and also D because D we can reach so now s will contain hew C D H since D is already there because we have visited D from the other side we have found another blossom when you reach D by this way you have already stood earlier then reaching B by different parity you will basically now identify another blossom so this blossom also has to be collapsed into one so the path reaching dr u BD and you a CD so there that will be collapsed into a blossom and we call it as capital u so we contract the plaza obtain a new vertex u and the graph on the right this particular with s is equal to U and H so H he will reach from the other direction and you when you reach Y Rd so we next explore from H finding nothing new why because this is saturated so this is not a commenting path nothing is being identified through H finally we explore from you reaching an unsaturated vertex so it will identify a path like this so starting from unsaturated vertex you reach to unsaturated vertex now we have to trace back our path so from X we have we are coming from you now we you we have to go and see within it and within you if you see you have reached from B D F a so having recorded the edge on which we reached each edge we can extract the emag eventing path ux we reached x from you so we expand we reach X from you so we expand you so when you expand you so we expand the blossom back into you a then B D and C C was again and find that X is reached from you along B X the path in the blossom you that reaches be on a saturated edge with c c DB since C is a blossoming the original graph so we expand C back to c fe e is not used here so we are not showing it note that d is reached from see from that blossom C by the unsaturated edgy D so the path from the base of C that reaches he along the saturated edge is CF e finally C was reached from a and from you so we obtain the full augmenting path is like this so we have started from you we have gone to a then we have gone to C then we have gone to F then we have gone to E then we have gone to e then we have gone to B then we have gone to X so this is a woman ting path is being identified remarks so admins original algorithm runs in of the order n raised power for the implementation in Ahuja montani Orlan algorithm runs in the order and cube that is faster way of implementing the same approach this requires appropriate data structure to represent the blossoms and to process the contraction and careful analysis of the number of contractions that can be performed the time is spent exploring edges and the time spent contracting and expanding blossoms are reduced in these algorithms so the first algorithm solving the maximum matching problem in less than cubic time was of the order n raised power 5 by 2 that is 2.5 in even care you in 1975 the best algorithm now known runs in the order and root and M for a graph with n vertices and emerges the algorithm is rather complicated and appears in Macaulay and watch Iran in 1980 and complete proof in Raja Rani is given in 1994 conclusion in this lecture we have discussed advanced blossom algorithm and also discussed the concept of flower stem and blossom in upcoming lectures we will discuss the connectivity and paths thank you [Music] [Music] 