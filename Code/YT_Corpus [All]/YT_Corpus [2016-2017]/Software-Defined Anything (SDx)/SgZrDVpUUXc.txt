 all right hollow wall busy screen here I have some issues with just recording I'm not sure what's going on so I'm keeping an eye on it I already did a video on this and I'll try to do a video on it crashed any taste this is a basically part two of arch linux lockdown or arch linux hardening and I know I'm feeling through a DM crypt again just to make sure everything's in place so I already have it on my system setup DM crypt for your whole root partition with a separate bootloader which isn't encrypted so I'm just gonna do my usual stuff for VirtualBox and just keep an eye on the recording there hopefully we can get through this okay so a couple of things before I get started is a solid-state drive you which I'm using you can enable it that is if you're if you don't have if you have a BIOS that enable that you can enable encryption you probably want to use that maybe there are some drawbacks is by default DM crypt and supposing never will enable FS trim or trim support you'd have to manually enable it which does compromise the security so I want a desktop tower computer it's not as much of an issue definitely a laptop you have to be aware of that all right because you don't want to if you you know are very concerned either somebody gets a hold of your disk it could be compromised and it's not you know not for sure but just be aware of that so in any case I have our clinics I'm watch a box set up with our clinics just one hard drive so it'll be device SDA will be working with only so with that said just do an F disk if you have multiple hard drive - list and you can see here I have s da and the loop is pretty much the ISO so it's only sta we're going to work with a solo fdisk slash de vie est a new partition just letter n primary will be fine for what we're doing default partition is one first sector will leave second sectors and ear boots and that's plus five 112 at least 100 megabytes so 512 should be good enough not very much anymore these days so press Enter I knew this will be a route I'm just going to leave everything I don't leave the swap out of the equation because you have to encrypt that - probably not it's hard to do because it's swap so it's volatile in any case partition two primary default first and last I'll just leave the same now for partition 2 we're going to type the letter T for type it's going to ask you which one I want for default number two and you can list out without and it's lit Linux LVM and which is 8 e number 8 and a letter e press ENTER change type of partition to Linux LVM okay so W to write that out and let's do an F disk - L /d v SDA I'll zoom in here you see SDA is Linux and SDA I mean SDA one is Linux SDA two is Linux l vm alright so we're gonna set up our encryption with I'm gonna believe it simple again I have notes here all up though these you can use a stronger cipher if you wish but it is CPU intensive so I'm just going to do loops format so loops press tab top left press tab / de v SD a - capital letters you have to type in word yes then you type in your past Ruiz okay then we open it with our passphrase oops on sorted by ripped set up to - just open I'm gonna knock - - I'm so sorry open and then two dashes type now UK s device SDA - and another space LVM for logical volume management the passphrase you just typed in and it should be open to create physical volume group volume and the logical volume so PB physical volume create okay de Vie mapper LVM i'm pressing tab on that and it's been created and then VG I'm so sorry VG create it's gonna call it root the group okay and then the device mapper oh we am finally LV logical volume create I'm gonna leave it always as root so it's much easier to set up lasso - L and then plus 100% free that's in capital letters of the word free and root and a - and read my apologies I forgot to put the % 100% for you there we go okay so we have the logical one I'm sorry I cleared this screen I shouldn't know but the notes are on the side there so now we're going to make mkfs dot extension for and it's going to be pointed to the device mapper LVM I'm sorry root - root that's why I set it up so it's fairly simple give that a bit of time and we're done I'll just melt that de vivir mapper root - root 2m Mt now for our boot it's the same idea can maybe extension two or three or four is fine slash devs ta one alright and then we mount that to you know we make a directory sorry mkdir slice TeV /mnt I'm so sorry boots now we mount the boot partition to so so de b st a12 /mnt / boot and apologies i am trying to keep an eye on the recording so that's I'm kind of a little slower today alright so those two partitions up and mounted I'll clear the screen LS /mnt you see boot lost and found all right now I'm gonna install Arch Linux okay I just made a video of a couple of weeks ago or a week ago installing Arch Linux so I'm going to skip through the process of installing that and I'll get back to let me generate the file system table okay so I'll be back in a flash okay so Arch Linux installed just want to mention when we generate the file system table okay I believe it would be easier to do without to do without using the unique universal unique identifier simply because in the grub command-line instead of pointing it to device SDA - you have to point it to the identifier number it's kind of hard to remember or type in so I'm just gonna do a simple generate GE and FS tap /mnt two dashes not to overwrite you can put whatever you wish I just got used to using two 2xe EFS tab and we'll just cEAT and make sure everything's right which looks fine to me so just arch see it routes MNT I'm not gonna bother with setting up a hostname obviously you want your root password to be something passwords another thing obviously in and security and after that that's going to nano XE m'kay in it dot config page down arrow key up a little bit and where it has hooks in quotes on some around after auto detect you can type in encrypt and if you make a mistake it'll tell you so you can always go back so save and exit and then just run that MK @ CP IL - P Linux and if I didn't type anything wrong it'll just do its thing basically and then after that we'll just download install grub and add the parameters to the grub configuration line and restart the computer or in this case VirtualBox so pac-man - capital ass drop and drop legacy or whatever you want to call it don't forget to get OS prober if you have another system another operating system install and then just rub install one device SDA of course alright so nano Etsy default grub okay and where it has this line here where the cursor is blinking grub CMD line Linux when I type in crypt device and this is what I was saying equals if you had to put in those long numbers it'd be very difficult so de V St a to remember that I'm : root I think don't call me on this one you have to check on the article in this documentation if you want another one allow - discards or allow discards one word for solid-state drive I'm gonna leave it as that sorry to get you confused so crypto bicycles DVS da to : root then root equals / de v / mapper another / root and a - root and then you write write that out and exit alright so that's it you just you mount I mean exit first and you melt /mnt and the - capital R and either power off or reboot okay so I want the ISO in and existing the less and we'll see what happens and I forgot to update the grab didn't I okay don't forget to sorry about that don't forget to mount the boot device as well because I'll grab will complain so I just did a grub install just in case and then we'll run our MK out grub I totally forgot to do that MK config - OH / boot from from dot CFG you know complaining about the mounted ISIL but it it should work I hope I got everything right if not not to go back into this mode which I won't let you which I won't allow you to supposition I'll do it myself of course volume out mm t - r and reboots and existing OS that's much better there we go now you gonna have to type in your past race to unlock the volume and there we go on your login okay so that's it for this part there now I want to go through a way of automatically unlocking or the passkey if you want to which I do on my system tower desktop and I'm not that concerned on the physical part of things especially in Linux there's nothing on here so give me a second I'll bring up the notes on not okay so here it is no password basically no password prompt so use DVD and the byte sector account equals and then I you random and the name of the crypto and so on you have a chmod mode not the the file and you're in it Ram FS and then we'll add this and so on so it's pretty it's it's kind of neat actually it works and finally encrypt setup all u KS add key like so and /t e v SG a to to that crypto key file and you type in your existing passphrase not to edit our MK init file again so Nano XE MK in it dot C alone F or it has files equals in quotes here you just type in that where it is in the root crypto key file so slash grip top crypto underscore key file dot bin alright and just write that out exit and we have to reinitialize deep reinitialized in it Rama Fastenal MK in it CPI OHP Linux and with any luck we'll do another reboot we won't be prompted for a password or passphrase okay so reboot the drawback to this even on a solid-state drive it takes longer to subvert because it has to encrypt it for some reason if you know the way around wife's slower well it's encrypted that's why so that's why and anyway so there we go it's unlocked alright login now you can do this as I you just up a point to the Arch Linux documentation but you can't put this on a USB Drive instead of on the hard drive if you want to do that if you want to automatically unlock alright so I hope I have covered everything sorry for the confusion and the busy screen but for all intents and purposes and we have to drive encrypted and you can do all your locale and your hosts and your protocols except for if you're using Wireless yet that you download the wireless tools before rebooting but other than that then we have it diem redone to follow along with the Arch Linux lockdown ok alright so that's it for this one and thanks so much for watching and we'll talk to you soon and bye for now 