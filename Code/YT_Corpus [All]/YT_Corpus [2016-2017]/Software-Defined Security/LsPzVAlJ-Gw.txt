 welcome to huawei firewall multimedia configuration course in this course we will learn how to configure security policies as we all know that the basic function of a firewall is packet forwarding control the next-generation firewall primarily relies on security policies to implement this function the security policies implements security checks on the traffic passing through the firewall the firewall permits the traffic allowed by the security policies and discards the traffic that is not allowed now let's see how to configure security policies choose policy security policy security policy we can see there is a default security policy with all conditions set to any and action set to deny if we try to edit it we can change only its action the matching conditions cannot be changed what is the function of this default security policy we know that traffic matches security policies from top to bottom and finally the default policy if we configure a security policy that denies traffic from IP address one point one point one point one and change the action of the default policy to permit the firewall then will discard the traffic from IP address one point one point one point one and permit all the other traffic now let's see what a security policy consists of generally a security policy consists of matching conditions an action and a content security profile the matching conditions of next-generation firewalls are more diversified and granular than the traditional Queen tuple based matching conditions all matching conditions are optional for example if we create a security policy without setting any matching condition then all matching conditions are any traffic must match all matching conditions to match a security policy if the traffic matches a security policy the firewall takes the specified action for the traffic the action can be permit or deny we can see that we need to configure content security only when the action is set to permit when the action is set to deny the content security configuration item is unavailable to put it in another way the firewall implements content security checks only on the traffic to be permitted if the firewall determines to deny the traffic it is unnecessary to inspect it now let me explain what each matching condition controls and when we should use it the first matching conditions I will introduce are the source zone and destination zone which indicate where the traffic comes from and where the traffic goes to on traditional firewalls security policies are divided into forwarding and local policies based on source and destination zones and different configuration portals are available for them the source and destination zones are mandatory matching conditions the next-generation firewalls blur the concepts of forwarding and local policies and provide only one configuration portal the source and destination zones as well as all the other matching conditions are all optional besides security policies on the next-generation firewalls also support the configuration of multiple security zones in this way cross multi-zone access can be configured at a time now let me introduce the source address / region destination address / region and user matching conditions which indicate who initiates the traffic and to whom the traffic is destined to we can enter an IP address or IP address range such as one point one point one point 1/32 or one point one point one point O slash 24 if we need to add this contiguous IP addresses or IP address ranges we can create an address group and reference the address group in the security policy we can also set the user parameter to implement user specific control of course we need to define the user in advance and then reference it in the security policy set access mode or device to implement policy control for different types of access authentication or devices in TSM SSO scenarios we can specify the services and applications to be permitted or denied a service is usually identified by a protocol into port number we can select predefined services on the firewall prettified services are well-known services such as HTTP FTP and telnet of course you can also customize services if you know clearly what protocols and ports need to be denied you can use service as the matching condition however the live network may have applications that use ephemeral ports to provide services in such cases using application as the matching condition can implement more effective traffic control the next-generation firewalls no longer rely on port numbers or protocols to identify applications they can identify applications based on the characteristics of application layer data for example an FTP server may use an ephemeral port to provide services and we need to deny access to this FTP server however we don't know the port number used by the FTP server therefore we can't use service as the matching condition FTP and service applies only to the FTP services that use port 21 can we select FTP in application to control the access to the FTP server now let's prove it in the simulation network environment suppose that PC and FTP server have been configured we use the PC as an FTP client to access the FTP server the FTP server provides services using port 21 21 not well-known port 21 we hope to configure one security policy to block the PC access to the FTP server is it possible now we create a policy and set the source zone to trust destination zone - DMZ and destination address to the IP address 192.168.1.1 because the ftp server provides services using port 21 21 not port 21 selecting FTP in service cannot implement effective access control but we can select FTP and application let's leave other matching conditions empty set the action to permit and check whether the PC can access the FTP server you yes the PC can access the FTP server we can see that the matching count of the security policy changes from zero to one if we refresh it this indicates that the security policy is matched now we change the action to deny and check whether the PC can access the FTP server the axis fails let's see the matching count after we refresh it it changes from zero to one okay now we are clear when to use service as the matching condition and when to use application schedule as the name implies is the time range during which the security policy takes effect note that the time range is timed on the basis of the system time on the firewall as mentioned above we need to configure content security only when the action is set to permit the next generation firewall supports seven types of content security checks including antivirus intrusion prevention URL filtering file blocking data filtering application behavior control and null filtering we can reference content security profiles based on different networking environments and requirements we can select and edit existing profiles or create new profiles we can also enable the logging function in security policies from policy matching logs we can determine which security policy is matched then we can verify the policy settings to see if the desired effect has achieved if a fault occurs we can use the logs to locate the fault these are the policy matching logs during a certain time range each log records the log generation time source and destination zones of the traffic source and destination addresses protocol and application however if the firewall does not have any hard disk the policy matching logs cannot be viewed we need to use a network management device to view these logs similarly after the session log function is enabled the next generation firewall logs the session that matches security policy to view session logs we also need a network management device the next generation firewalls have two ageing time related concepts an aging time and persistent connection aging time in actual networking environment there might be some special services that have no packet transferred in a long period of time in such cases the firewall will clear such connections to avoid performance consumption this is what we have mentioned the session ageing time if an ageing time is set for a session and the session does not have any packet transferred in a specified period of time the firewall deletes the session entry to release system resources the session ageing time here is the aging time of the session that matches a specific security policy however in some scenarios the session entries of special services such as database services must be kept UNAIDS for a long period time otherwise the services will be interrupted for such services we need to configure persistent connection the concepts of user-defined persistent connection and session ageing time are the same except that the user defined persistent connection takes effect only on the TCP applications that match the specified policy whereas the session ageing time takes effect on both TCP and UDP applications that match the specified policy moreover the persistent connection supports longer ageing time than sessions on this device the persistent connection can last for up to 24 thousand hours whereas the session aging time can be set to a maximum of 65535 seconds after we have learned the matching conditions in a security policy and in what conditions we need to use each matching condition you may wonder if we need to configure multiple security policies which one we should configure first don't worry let me explain at first we list the parameters of each security policy for example the matching conditions of security policies policy one policy two and policy three are listed in rows two three and four of the table then we rank the security policies from the most specific to the least specific in the preceding example if we compare the source zone destination zone source address / region destination address / region service and schedule fields the three security policies are the same but if we compare the user field management is configured for policy 1 and any for the other two policies that is to say the user fields of policy 2 and policy 3 are not configured therefore policy one has the most specific matching condition and should be ranked first then let's compare the application matching condition for policy 1 and policy two this matching condition is set to the same value but for policy 2 and policy 3 this field is set respectively to FTP and Ne therefore policy 2 as a more specific condition than policy 3 based on the preceding analysis we rank policy 1 first followed by policy 2 and policy 3 then we can figure these security policies one by one on the firewall the policies configured earlier are placed on the front the traffic that matches the security policies one by one based on the configuration order ok this is the end of the course thank you for staying with us looking forward to seeing you next time 