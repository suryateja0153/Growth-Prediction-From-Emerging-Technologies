 hi I'm Lauren Malfoy I'm a technical marketing engineer with Cisco in the NCMA bu I'm gonna talk a little bit about VMware integration I know you guys are networking people so hopefully you care a little bit or at least it'll give you something to talk about at the nexus s EXI party at vmworld or something Soho first we'll talk a little bit about just the high level of how we actually hook into VMware although we do work with other hypervisors hyper-v KVM etc so we're gonna assume that you have an APEC which is our application policy infrastructure controller of course and let's say you already have a V Center or several V centers of easier environment in general right within the APEC we're going to create what we call a EMM domain and that stands for a virtual machine manager and it's basically just right click and you specify your V Center IP fqdn and the credentials all of that good stuff and then it will magically through the use of the Center api's actually create a distributed virtual switch this could be vSphere distributed switch that comes along with you know VMware and V Center depending on the licensing that you use it could actually be a Cisco application virtual switch to the AVS is like a variant of the next time like nexus 1000v if you will so that's all well and good and in the apec as you know we create EP G's maybe web app and database as all of our applications look like that right all three tiers web app and DB the cool thing about this is once we create those EP G's again through the use of the api's we actually get the same port groups over here and they're called web app and DB aptly-named right so as carly had here earlier the application profile you know where we have contracts in between these and point groups we will do the same thing and put in contracts and all that good stuff right there apply the policy if you will apply layer four through seven devices like firewalls load balancers and that policy will get applied to those pork groups automatically that is the basics of how it works we actually use the hockey or lldp to communicate with DVS we will create a new DVS it doesn't work with one that you already have currently although you could do other things like just setting up a bare-metal association but you wouldn't get that natural VMware integration that way so any questions from a high-level there this is just kind of a prettier picture I have the writing of a junior high boy I've been told so the haircuts a match to so you know questions there all right so Carly already talked a little bit about micro segmentation I won't waste your time with everything she's told you but I'll give you a few more details as she said we automatically pull in VMs maybe by any one of these attributes VM named operating system cetera et cetera the cool thing is that the end point group gets created on the apex IDE for Cisco but you actually don't see that endpoint group on the DVS it stays in the original endpoint group so we're still applying policy in the same way but it's kind of invisible to the VMware administrator so one thing you could possibly do if you want depending on how you work with your VMware folks is create like a baseline port group really for them so they don't have to worry about the networking so much anymore right they don't want to go and learn all the networking and learn the policies and all that good stuff maybe something to you but maybe they don't so then you can actually go ahead and do that policy on your end worried about the networking and all that good stuff all the VMware admin can do their job as well so any questions okay entry EPG isolation and carly already mentioned this it basically turns off that communication between the m's or you know yeah VMs generally in the PG right so the cool thing about this though is actually you know that's great that they can't communicate it's very secure and all that good stuff but we still only have to create one contract between these two EP G's right so think of all those ACLs and ACPs that you have to create in order to accomplish this in a more traditional network right but with this we create one contract maybe it has one or several filters and we're good to go and then you can still have you know web one and talk to app one over HTTP or whatever protocol are using and web one can talk to app two and so on and so on over HTTP and whatever other filters here describing so this is really cool use case right because in general we don't want our app servers to be able talk to each other or they just need to talk to the web servers well let's think of a DMZ you know you don't want all of those those VM communicating because that's where we get issues if something's been poned or hacked or whatever you want to call it that's where we get those issues on the inside and network or especially in the DMZ because it's a little more open maybe and it reminds me of like a private VLAN isolated it is basically it is a PV LAN mm-hm that's the kind of technology that we use but it's literally just ticking a checkmark when you create an EPG so it's really easy to implement now logistically if you wanted to have web one talk to app one and app two you'd have to set up a separate policy in order to allow that just one policy yeah so this is all one contract that I created one time and I didn't even have to apply it several times you know it's not even that case where I'm copying it over which is a possibility if we were talking about putting that contract between two other EP G's but in this case yeah just one contract you can then specify to say this one using this contract for a connectivity between these two things can then talk to these two endpoints on the other no it has to be by endpoint group okay so if you wanted to do that you would actually have to break up put two of the app themes in a different endpoint great welcome and then apply the policy that way I think that answer right boys so if I want app 1 and app two to talk mm-hmm it's what app one an app - yeah okay I want them to talk I put them in different ap G's or or is it that checkbox on like a per basis so yeah if you turn on entry PG isolation nothing in talk inside there ever it means a PV lamp yeah yes you would have to either do that or not turn on entry PG isolation obviously but you know we are going even with a contract you can't make you - you can't put contracts in one API of any people right right mm-hm so if you don't want those hosts and the EPG to talk they really you really don't ever want it is the most secure I mean we're talking a peer whitelist model with a CI if you don't have a contract between my two EP G's they can't ever talk right but I mean and then instead if you check that box on an EEG there's not even a whitelist option inside that EPG yep yes so it is the most secure and you can you can turn into EPG isolation on on a per ug basis yes so you can have your highly restrictive EPA's and then you have your more open EVPs remained a little more liberal policies you know exactly and if you needed a test or something you could uncheck that tuck that in checkbox and you know go in and do your pinging or whatever you need to do of course we have a ton of visibility with a pic and other troubleshooting tools so you know some of the more traditional ways although I know that's more comfortable is get on the CLI and go ahead and start pinging stuff but but if you had hosts that were you had to keep there were old OSS and then no longer get patched that right that is a perfect use case for that yeah we're gonna put all of our windows XP VMS like there is such a thing happen oh right I've managed them they can and they can't talk to one another and then they can only talk outside of the EPG yes to host so important protocols achieves listicle a define the contract exactly gotcha exactly so this is just kind of like a little wrap-up where I'm going to talk a little bit more about security within the virtual realm really so as we know we can obviously isolate VM traffic and make it secure and all that good stuff with a CI but what you also get with a CI is the ability to do your V Colonel pork groups right so things like management fault tolerance the motion we those are all going to be in an EPG and all going to have policy applied of course any other hypervisor I mention hyper-v KVM and bare-metal servers because let's not forget if we want the security in the virtual realm we probably want the some more security in the physical realm and you know anything holding ESXi is going to be physical right or any of your hypervisors so we still want to secure those physical things as well and as it says I'm in fact some of our servers are bare metal which is a little confusing since 70% of our workloads are virtual but do you really think about the amount is gold machines still in a data center there's a lot and this doesn't apply just to servers and when we say bare metal at that point we can apply that to appliances that yes you know yeah they're physical you know layer 2 through 7 appliances yeah you could have switches you could have firewalls anything really in an endpoint group and then apply policy to those and virtual or physical appliances as well and from different members of the ecosystem juniper you know at five various things so it's not just Cisco a SAV S or something like that ok so next I'm going to talk about the vCenter plugin for a CI and I tested my own live demo and it's a little slow because I'm going over a VPN connection to the Netherlands so luckily I listen to Tom sage advice and made a backup video ok so this is our apec here we're looking at a view of the tenants you can see common infra mine my co-workers and the management tenant so far now I'm in my vSphere client and the AC I plug in and simply I plug in like any other plugin for V Center so we click on the ACI fabric plugin and I'm going to create a tenant this will actually create a tenant within AC I give it TFE of course just so you guys know i made this special for you take a fabric you know may have multiple fabrics so i've now created a new tenant i can go in my a pic it's automatically there I didn't even fast forward that part it's immediate like that so you can create a tenant from the VMware admin perspective just so you know we do have role based access controls so if you don't want them they can really consume as well I click on the ACI fabric I can see different information about it versioning the tenants from that view as well so the VMware admin will be able to see all of this I click on the networking portion I select my new tenant my tfd tenant and I can create a verb from here a virtual routing and forwarding and there's already a verb in bridge domain within this it gets created when you create the tenant you know you can delete it you can do whatever you like with it I'll leave it there up to you well it will create our verb and of course the bridge domain we're gonna need a default gateway to get out we need something to hold those sub nuts right and we'll call it CFD edy I'm being kind of generic here obviously we would have you know various bridge domains give it a default gateway one dot one dot one dot 1/24 or whatever some not maybe you're communicating with your VMware admin maybe you've given them a slash 24 and they can figure out how to break that up or you've given them several so I'm not fools to work with kind of up to the networking folks on how they want to work with that you know we're trying to break silos a little bit here right maybe talk to each other but not too much that's why we're giving him this so that uh they don't have to bug you with every single question right so I've my verb in my bridge domain and now I can create my application profile remember this is where we have endpoint groups and contracts in between maybe layer four through seven device it's literally as easy as dragging and dropping drag down my EPG onto my canvas give it a name abt FD web it specifies which DVS it's on and we can specify the bridge domain that we'd like it to be on probably that bridge demand I just created again that gives it that kind of asset II I to get out to other things and we'll just click OK now maybe my app EPG wants to be what we lovingly call you seg EPG although we probably call it music but uh but it stands for micro segmentation obviously and this is the one where it's going to pull in you know vm's maybe with a certain VM name or with a certain operating system or IP SATs and all that good stuff specify the bridge demand once again and here's my tick box where I turn on entry EPG isolation and when the traffic is forwarded then it just checks for that flag if the flags there it won't forward it if it is there or if it's not there will forward it you know what I mean here's where I specify those specific VM attribute whatever I want to use to do that and try a PG isolation or I'm sorry to do the micro segmentation and I just specified TFT app so any VM that has T FD - app in the name will get pulled into the cpg from an APEC point of view and then of course will apply a contract because we want these to be able to communicate somehow someway here's where you can specify anything FTP HTTP any any one of your thousands of protocols I'm sure that you have to apply within one contract we can specify this right I already have filters created or I'm sorry I don't yet so what I'm gonna do is show it creating a filter in the APEC it's again you can do this from the APEC side and then let your VMware admin just consume these you know basic constructs so let's create a filter that allows ICMP and it's pretty easy to create these filters I don't know how familiar you guys are with this GUI you could also do this using the CLI if you wanted or the api's click update and submit and again I didn't even have to fast forward this part it immediately is in my filters now I don't even have to restart that little wizard there strike and drop it ICMP now I'll be able to ping between the two you notice there's a bi-directional check mark that allows it in both ways I can uncheck that if I want but remember you know having create a Ciel's like that there's no such thing as really a bi-directional ACL right where you we have to create a lot of the command line style now I'm it's taking a look at the application profile in my a pic and this is what it created you see the contract at the top you see the regular EPG the you say EPG and then down here is where we've specified that it's attached to a certain VM I'm domain we could have done this all in the epoch to using the drag-and-drop or using Wizards using command line API etc you get the hint it basically you can do it all three ways for pretty much everything troubleshooting we have a troubleshooting tool you can specify virtual machines you can specify endpoint groups you can specify port groups etc etc just check how what contracts are between them and more to the point the filters actually within the contract because likely you're going to have one common contract that allows maybe DMS DHCP Active Directory all that good stuff so I'll specify two VMs here my source and destination just click a button and I can see which filters are allowed between those two things so if I'm not able to ping let's see it say go see if I see I'm peas in there it's not in there maybe that's the issue hopefully it is Oracle machines I can see all of my virtual machines in here and actually expand them and see which network adapters they're using so if I have something flapping or something like that it's very easy to find out which network adapter they're using so that I can go check that quickly and obviously from the apec we have a lot of a lot more visibility into that network getting we have atomic counters and and you know more troubleshooting tools but this is really nice for the VMware admin now here we only see one EPG does anyone know why that is in our vSphere web client because that microsegmentation EPG does not appear in the vSphere web client right that only appears on the apec so we saw it in the APEC when I showed you the application profile security we can create contracts and filters actually within the vSphere web client so I didn't have to go to the APEC if I don't want to external connectivity layer 2 and layer 3 I can create I can consume that after it's been created in the apex so that's going to be more of a consumption based thing same with layer 4 through 7 services those have to be created within the APEC and then I can consume them as a VMware admin so this shows you kind of a more complex EPG with Cisco is a virtual in the contract itself so the a SAV is in there you can see it's as simple as just dragging it into in between 2ep geez this one's unmanaged meaning that we are actually Manning managing it from the aasa' GUI instead of the apec you know we can get traffic stats for everything immediately again a lot of visualization and and pretty graphs and all that good stuff see faults get audit logs and all that from the VMware side and the APEC side so makes troubleshooting again a lot easier that's pretty much it so any questions before I let my other colleagues jump up here so what is the level of integration into NSX with this so NSX can ride on top of a CI no problem we see that as an application like any other application it's not necessarily integrated into the a CI plug-in but definitely with a CI we can work with MSX yeah that's one of the first things I can think of as if you're a NSX shop then when you're provisioning it out a new domain or whatever that's called you can provision out your routed links down what subnets they have push them down yeah to help that painful process they evidently have of deploying that type of stuff so one thing to is with NSX controllers you know which used to be these shielded controllers they can do the excellent natively so then you're actually instead of using VLANs from you know these your via up your you can actually do the X land at that point too and have it all be the excellent because obviously a CI fabric is all the excellent but there's just not that visibility into a CI with that type of level I mean we'd still be able to do all of the same visibility that we would with any other application or not work but there's no ACI plug it in or anything like that where you can configure it and go from there but it's all the vSphere web client right so it's all the the one one panel anyway right yeah well that's that's where I come from with it is you know start at one place have it blow out as much as it possibly can and then what it can't touch then you go absolutely so the more you can do in one central place with nice right right yeah I'll take that back thank you look at to questions you say we can do all this through the gooeys for pretty much everything you said pretty much everything other things we can't do that acquire us I just talk like that in bag no sometimes it's like you guys are everything well except for this whole feature set in advance the options you have to drop to a CLI for okay that's cool and we only see well we only see the one EPG and the other ones exposed to the APEC can't is it exposed inside of the center at all or or if I were you know running esxcli commands or stuff on science you know I don't know that I would have to double-check it's far as I know it's not but don't quote me I'm not on that double check on that one stay home 