 all right so I want to thank thank everyone for coming this is my third time doing this session today my last so a little tired so bear with me we're gonna be talking today about mobile device roaming behavior and client troubleshooting if you were at airheads last year you may have sat this presentation Sean from Aruba said hey would you like to come back and and talk on this subject but I asked if I could change up the slide deck to give it a more real-world feel and he said have at it and that's what I did so if you sat this presentation last year was great presentation went deep in 2d bugs and etc this presentation I'm going to share a little bit are a lot more about real-world experience with mobile device roaming and client troubleshooting so Who am I my name is George Stefanik I'm a wireless architect for Houston Methodist Hospital System I've been a Houston Methodist for a number of years I'm also a partner at free space Wi-Fi calm or free space Wi-Fi it's a new startup we started last year and it's it's been going really well for us we've been fixing more networks than actually deploying new right it's kind of a common theme we're seeing these days at Houston Methodist I managed a fairly decent-sized network I have just about 4,000 access point seven Wireless distributions we have an all Wireless office actually it's all Wireless we're gonna be touching on that so it's a fairly decent-sized network I blog at airheads no strings attached show my toe to 11 free space Wi-Fi those are our twitter handles that line right there it says cisco VIP and aruba MVP pretty much tells you I have no life I spend a lot of time in the community reading and doing blog posts there's a technical editor on the Cisco press book in the Cybex book so do we have any healthcare engineers or customers show hands okay you know my struggles are your struggles when it comes to healthcare devices this is just a short list of what's in my wheelhouse and in Houston Methodist we actually have a wireless mobility team it's not a routing and switching guy that has to do firewall and oh by the you do wireless we have four guys well actually one's a girl she will correct me if she sees this that focus solely on Wi-Fi and that has allowed us to go very deep into client troubleshooting testing and specifically one of the topics today is roaming so a quick poll how many Aruba customers do we have in the room a lot Wow what about a roof of ours partners okay how many see wnp certified folks okay what about a rubra certified folks well a lot of hands going up over here great it's awesome and do we have any bloggers or tech reporters in the room yeah okay my third session no one's raised their hand so I'm not sure if I'm believing it but the reason why I asked that I spoke at interrupts last year and I made a comment that we need to have Wi-Fi everywhere right and part of that ways is you know you need to have it in a restroom because it's a bad day when a CEO can't get Wireless in the can just made it in passing let me tell you it was not a great day when I got back to the office because on InformationWeek the next day one lesson learned at Houston Methodist if the CEO can't get Wireless in the can it's a bad day yeah I had a bad day doctor brooms a good guy and he pretty much said hey next time he's thrown so why community Twitter blogs of forums you know I'm often asked you know how do I eat started in Wi-Fi and you know where do I even begin that's where you begin Twitter blogs and forums there's a tremendous amount of knowledge in fact in Twitter you know you're one tweet away from talking to someone with a lot of Wi-Fi experience that could help in any way shape or form and the Wi-Fi community especially on Twitter it's fairly knit you know it's it's a closed community so if you're not on Twitter wholly totally advised that you're interested in learning more about Wi-Fi Twitter is the way to do it blogs a lot of great Wi-Fi blogs out there also forms airheads for example so in this session for the next 60 minutes if you could take two things away that you didn't know before that you could take back to the enterprise this session was a success and we're gonna start with this one what does Wi-Fi stand for Barros fidelity right it's a made-up word absolutely has no meaning whatsoever so if I'm worried ahead one right so you learned one thing today but yeah it's a made-up word doesn't stand for anything it's not an acronym it doesn't have any meaning if you had to guess what a wireless engineer look like there he is right it's somebody in the weeds because by the end of this session you're gonna see how deep we're gonna be going we're gonna be talking about client drivers and roaming and things that are taken for granted on the wired you plug in just works wireless isn't that way you have to be in the weeds and when and you know Dominick touched on it today you know when Wireless that when the bandwidth is slow maybe the pipe is slow or maybe you're having authentication issues or maybe this any other thing nothing has to do with wireless but since it's not a wireless device it's a wireless issue as a wireless engineer not only do we need to be fluent in our own technology but we need to understand how other people's applications work there's a lot of times they don't know they just know it doesn't work on wireless so you really to get into those weeds what's that you know I got it off the internet not really sure he from so today we're going to talk about roaming again real-world experience we're even talking about access point to access point roaming and then we're gonna be talking about roaming show a hands who uses EEP in their enterprise a lot of people did you know if you're not using an advanced roaming protocol and you're using EEP you may have you may suffer from poor roaming because of all the extra keys and we're gonna go into that so roaming from an 802 11 perspective is just transitioning from one cell to another but if you're using an advanced protocol wow you got something else to think about you got to make sure you use an opportunistic e cache and 802 11 are something of that nature and we're talking about rural troubleshooting so why is Wi-Fi roaming important the definition of being mobile right and transitioning from cell to cell seamlessly without application interruption now granted you're not gonna see a lot of pretty slides I hate slides so you're not gonna see any animations or anything that nature so I'm a Wi-Fi engineer the best you're going to get what triggers a Wi-Fi client to begin roaming a lot of people don't realize the wireless roaming mechanism is on the client the client dictates roaming imagine if you have 20 different devices on a table they could all potentially roam differently and they do while the Wi-Fi Alliance has done a fantastic job at interoperability one thing where they may have stopped short at is understanding and putting standards in place for clients like when do they roam how well do they hear the network so what triggers a Wi-Fi client to begin the roaming process meaning you know progressing to another cell typically degraded signal you're attached to an access point you're moving further away you have some attenuation low fire rate high retry percentage perhaps missed beacons elevated noise fluorescent are any one of these where a combination of the above could trigger a roaming event so how does a Wi-Fi client behave during a roaming process let's assume for a moment I'm attached to an access pointing that the the the video thing there is the the access point as I move away I hit a certain level of secret sauce in the vendor driver that I need to start looking for another access point to roam - I will do off channel scanning meaning I'm gonna scan the channels around me to see if there's another suitable access point when I do a probe on that channel I listen for the response and how well I hear that response is where I put my DB DBM level so I can hear this access point responded this is the DBM level then I move to another channel do the same thing I'm building a neighbor list when I'm off channel scanning I'm not sending data keep that in mind the Wi-Fi climb builds that neighbor list that I talked about then the Wi-Fi client chooses an optimal access point and does a reassociation from that neighbor list again these are things that are built into the driver that you and I as common folk don't typically see and then we reassociate so optimal Wi-Fi configuration and design is important for seamless roaming what impact is roaming have on applications like voice and video and I referenced 150 milliseconds 150 milliseconds has been around for years for voice what that really means is is that when I'm transmitting a voice frame from one handset to the other I can't exceed 150 not round-trip just the one way if I do that's where you start to induce jitter delay possible disconnection etc if you most times in a wireless network if you're not using security you can do it under 150 if you're doing eeep it's going to be possibly at 150 maybe even greater this is what a roaming client list looks like a client sending probes he's sending it out to broadcast on multiple channels now if I had more sniffers you would actually see more channels would be represented here but he's building a neighbor list also if you look here during the probe process you have a probe going out and then as a probe response now I only filtered on the probe request I didn't filter on a probe response so you're just seeing the requests going out then if I want to I pick the access point from the neighbor list I do an open system authentication and then Association not to be confused with any type of security this open system authentication has nothing to do with security it is effectively just communication in relations to plugging and cable into the wall they call it off the indication but it's not really that authentication that way here is the a total access point to access point you can see here this is actually a pre shared key I'm doing my pro request probe response here's my authentication in these two red bars and then my association and then a four-way handshake this is a pre shared key this is happening every single time that you go from access point to access point if you're doing a pre shared key network for example now what's interesting with the pre shared key there are four keys there the very first key in the handshake is a frame of a frame coming from the access point to the client this is building the pairwise transient key a lot of folks don't realize on a wireless infrastructure your unicast traffic on a client is encrypted separately from your multicast and broadcast traffic so the first part of the to a handshake is creating what they call pairwise transient key and this key is unique to the infrastructure in the client to agree upon an encryption key for that access point to then encrypt unicast traffic the third key is actually a key coming from the infrastructure and that's your deep gtk key group temporal key that key is used to encrypt your your multicast and broadcast traffic the last part of the four-way handshake is a key coming back acknowledging to the infrastructure that the client has everything everything's in order so another takeaway is you actually have two different types of encouragement encryption keys going on so this is what a typical process looks like there's a probe request it's going out to a broadcast saying hey is anybody else out there on that channel and then the client Reese the AP responds hey Here I am and by the way this is what I support if the client chooses to authenticate to the APIs that specific client he sends an authentication frame and you're gonna notice that the authentication frame has a status code and then there's another authentication frame that comes back there is not an authentication request and response in 802 11 standard doesn't say that it's just authentication going both ways and then you have the Association request this is by and far one of the more powerful frames in 802 11 mike albano does anybody know Mike or visit his website see if you had shaking Mike works for Google now he he worked for a university prior and what he had done is he set up some access points and he was sniffing the 8 the air and looking specifically at Association requests and he did this for a period of time I don't know how long it was maybe a couple months close to a year perhaps and he was able to see transitioning over time what clients actually supported right perhaps maybe over a period of months maybe more clients are supporting 802 11 are right so this was really important data that you can see in transitioning over time so the Association request is very powerful because it's the client telling the infrastructure this is what I support and the Association response is coming back from the infrastructure to the client telling the client this is what that supports now I mentioned the reason codes I did a blog post on air heads that may be helpful if you're trying to troubleshoot authentication in any manner perhaps the clients not getting onto the network and if you have a package sniffer look at the reason codes if it throws a number in here you can look it up against the standard and see perhaps why that client may not be authenticating so we learned that you know wireless clients are really a NIC mixed bag of nuts right they all kind of behave differently they all have their own type of algorithms and whatnot one way that you can enhance even some of the clients that are poor roamers is by having an optimal RF environment you know we look at where it says you know ensure 25% cell overlap but has anyone actually actually ever seen that right I mean what is 25% I'm gonna show you here in a few slides what that actually looks like but if you have a properly designed RF network and you have a mental check box that everything is in order the RF is fine your clients are configured optimally your infrastructure is configured optimally and then all of a sudden you have oh there's one or two clients that are misbehaving you can almost immediately start focusing on those clients so you can influence roaming you know for optimal cell size reducing access point transmission power disabling lower data rates those are some of the basic things that you can do to enhance roaming on a client but what you're looking at right here is actually that cell overlap we talked about for example if you're doing a site survey people love to see green maps they love green maps it means I have coverage everywhere there's a confidence level it's going to work but what a lot of times people don't see is what does my second AP coverage look like this is where the two ApS intersect to give you that roaming optimization right and looking at this you know maybe right here I might have a problem so if I start to get calls about hey I'm getting some disconnects in this area yeah that's probably where I might want to start looking at do I have proper cell overlap to have proper cell coverage now this is available in many of the tools this happens to be air magnet which I'm a fan of and it's a little nerd not it's just a drop-down you can do ap coverage one two or three and then you set it to next sixty-seven so what this is telling me is that this green that you see here I have neg sixty-seven or better between two access points so I know that I have enough cell overlap makes sense so Wi-Fi clients can typically roam under 75 milliseconds on an open or a pre-shared key network because there's not a lot of overhead right it's a simple authentication probe probe response getting on and off the network if you're doing a pre-shared key network we know we need to do a four-way handshake and again that happens at every room for every access point but roaming is often measured by the Delta between the last data packets sent on the old AP and the next data packet sent on the new AP right there are different roaming plug-ins for example if you use omnipeek or Wi-Fi analyzer you want to make sure how that roaming plugin is calculating some may calculate on this association to the old AP and reassociation to the new AP right I typically start looking at the data first if I see a problem then I'll use the other plugin and look at this association to reassociation something as normal folk like us we don't have access to is a lot of the driver information and you're gonna see here courtesy a mic from Tammis off he access to some of the driver information well you couldn't share all of it he shared enough to know hey look at this you know qualcomm atheros driver it's actually roaming on our SSI and fire rate it just happens to be that driver and that Nick but that's just an example of this particular device is using our SSI level and the fiery it's not doing retry it's not doing snr while other NICs may right this is why it's a mixed bag clients can interpret and do what they please and a lot of their devices again and Wi-Fi Roman who's ever seen this crazy right what does that mean lowest highest what am i changing you just don't know right so some vendors allow you through their supplicants to modify the roaming aggressiveness when you do this swaybar it's manipulating something in the back and that doesn't tell you what it's changing do we have any Microsoft employees in the room okay no one's afraid to admit it huh now I know we've changed we're you know to Skype business but this was in the document from 2013 and this is where I talked about getting into the weeds if the user is moving during a call however the wap association remains sticky until the wireless client signal becomes too low and disconnects think about that you have a perfectly designed network RF wise it's optimal configuration you happen to be running link and you're having problems right you have to get into these weeds because sometimes applications can influence how out how the wireless connection works now granted I don't again this is three years old I don't know if it's changed just sharing that you have to get into those weeds also for 802 11 access point roaming you know we did a big study on the iOS phones on the Apple phones iOS 8 roaming triggers we typically see that those actually roam at next 70 I was talking to a gentleman and on the surface approach 3 they typically start roaming at 70 what that means is is that when it hits 70 it starts to do the probe request it start to build that neighbor list right so this is important to know and understand now Aruba has a client match actually client match is actually a really great feature but it's not one of those things you just want to turn on for the sake of turning on you have to have a very specific need because sometimes because we have clients that are a mixed bag by enabling this you might be fixing a handful but breaking others in the process so by enabling client match you can do bands steering Cline steering and dynamic load-balancing but you know again understand what you're turning on before you do and again you know Wi-Fi clients are a mix nag about mixed bag of nuts now where you be looking at enterprise roaming a lot of folks raise their hand that they have this now this is where the rubber meets the road again think you have a mental checkbox RF is fine optimally to design your configuration is great your wireless clients are great you have no problems but all of a sudden you're getting people are complaining about roaming issues if you're using neat protocol and you're not using a robust roaming algorithm you can be exchanging a lot of frames every time you do a room forum access point to access point each stands for extensible authentication protocol it's really a wired standard it's more used in wireless than it is wired these are the different flavors of eep eep eep version 0 TLS TTLs and leet the more popular ones are EP version 0 and TLS so what happens when a Wi-Fi client configured for EEP rooms it really depends on the amounts were out roaming algorithms a mechanism supported on the client and the supplicant or the client supplicant and infrastructure that's so important as we start to talk about opportunistic e cashing 802 11 r for example both the infrastructure has to support and the client has to support it both of those need to be in sync expect rowing time expected rolling times could exceed 150 milliseconds for authentication during Romeo if no advance mechanisms are supported for example if you have a busy cell lots of clients annoying transmitter is adding contention a radius server is at capacity a busy network poor Wi-Fi client because remember when you're doing if what happens is the wireless infrastructure does not care what type you use when you connect to that access point and after you do your pro requests and pro response your association your authentication goes through the wireless network and talks to the radius server wirelessly the wireless network and controller sits out of the mix the controller is waiting for an asset to come back from the successful accepts coming back from the radius server to allow the client to get the layer-3 so the infrastructure doesn't care what you use but this transaction is going back and forth between the client and the radius server since it's EEP depending on the eat flavor you have it could be 20 frames right now imagine we're just seeing that we had a probe request probe response authentication Association of four we'd handshake imagine all that and now add 20 more or plus frames because you're using eat and that's what this looks like here's a pre shared key network and our probe request / response authentication four-way handshake and we're passing traffic right here real quick but if you're using EEP in your environment when you get on the network my friends I didn't have enough room but there's like three pages of this just going back and forth for authentication now imagine if you have to do this every single time you roam from access point to access point and in most cases that's what's going on so you have that sensitive application and your roaming and you have all this going on so we're going to discuss the different roaming other algorithms how you can know this and not have to do that this is another visual this this rendering here is rather kind because there's actually more frames going back and forth than what you see here and really what's going on and I want to talk about a minute what's going on when you're doing it because most folks in here are using eat when you dedicate to the network and the client is talking directly to the radius server there is a key material called a master session key it's derived on the client it's also derived on the radius server the radius server then moves the key to the controller it is this key that's used for seeding material to create the pairwise transient key this four-way handshake that we talked about every time that you go from AP to AP it read it read does this over and over again so a lot of information is being redone so there are three different roving algorithms these are the three more popular ones but largely a lot of these aren't necessarily supported by a lot of vendors or clients so we have roaming pmk cache sticky key this is actually part of the 802 of and I amendment effectively what this is imagine connecting to an access point doing my FOIA to 'next authentication as I roam I connect to another one to a folio to an X authentication roam to another one to a voyage myself dedication so I'm not getting optimal roaming this way but if I turn around I happen to revisit the ApS that I just came from those P and K IDs are cached so if I happen to be roaming one way I'm going to be painful but roaming back the other way I'll have optimization now this is not necessarily an enterprise-grade solution right because you're not really fixing anything and those keys can get stale in aged out so not a lot of folks support that then we have opportunistic e caching ok see again not a standard something that vendors got together and said hey we need to fix this problem we're exchanging too many frames for 802 an ex authentication sensitive applications are suffering so vendors came up with opportunistic key caching aruba supports opportunistic key cache but the device has to support it Windows XP for example does Windows 7 does so opportunistic key caching is used on those those applications and then 802 11 are 2008 amendment 802 11 are again 2008 number of years ago Apple just a couple years ago has adopted a 212 an RV and K not a lot of vendors have so what does we talk about secure faster over back what what does option is to key cache and look like interestingly enough if you want an article to put you to bed and make your eyes glaze over that aruba ok see technical brief that's where you get started it's a fabulous technical brief by the way it really convinced me a lot of the beliefs I had and how OKC worked that document confirmed that so again it's not widely adopted it requires both the user to do an initial folio tour next authentication and then it does a pmk ID pass through through association oh I love that document you did a great job thank you but what's very important is this pmk IDs what is that right so if you look here during the 4 Way handshake that we talked about the second part of the four way handshake the pmk ID is arrived derived and that's this that's this right here now think of that as a serial number okay so when you move to the next access point in your reassociation you're gonna put that serial number that pmk ID if the infrastructure recognizes that you can negate the fully 222 authentication because you're a trusted user on the network already right so now that key the pmk key is moved where now you can create the pairwise transient key I know a lot of technical stuff right but understand this is how we're negating the 802 annex full process so this is what it looks like you know you have an association request Association response the pmk ID in this case one two three four five is sent you don't have to do all that heavy lifting for 802 and acts back to the radius server you immediately go into your four-way handshake right very optimal if you didn't have this you're doing fully - - annexed authentications every time and friends a client sitting still on a table can still roam it can still roam you might be attached to an Access Point far away and all of a sudden you want to roam and maybe you're in the middle of a you know a voice or video and all of a sudden you get that jitter what happened you do a phone call but you go out there and there's no problem but you roam you created all those extra keys also you want to be aware supplicants may override the native OKC support here's an example if you use Cisco anyconnect as your wireless supplicant it says here PM k ID caching and proactive key caching opportunistic key only supported on Windows XP they don't have the hooks in the API to derive that key and pass it so let's assume you test it a box everything works great one day you say well let's move forward with a supplicant that's supplicant you need to test and study because it could change the behavior drastically it's something like this is just as simple as you had up you had opportunistic key cache and working you had optimized roaming all of a sudden you had that supplicant you no longer have it so a 2 to 11 are a total of NR is that amendment in 2008 again Apple is the one that the main one the client wise Apple iOS specifically not Mac's that support it part of that is a total Evan R K and V they all kind of work together if you will in their transitioning from access point to access point neighbor listing and load balancing providing information back and forth between clients this is where we hope a lot of clients will move to in the future I will tell you this that if you have an 8:02 11-hour network today some legacy clients may not attach to it right so that's been a challenge for a lot of folks you know they think they're what we'll just turn on 8:11 R and all of a sudden they get some clients that fall off in the beacon frames and Assoc frames when they see that element they don't know what to do with it so when you try to attach to it you'll start the the Association process but it fails the keys here for 802 11 are their PM k r 0 PM k r1 highly recommend if you're wanting to learn more about this is the CW SP book from CW MP it does a really good job but you have over-the-air transition and you have over the DS transition and what this gentleman was saying is you can do some pre authentication to access points even before arriving this is talking about it is supported on iOS devices again K R and V aruba supports opportunistic key caching again K R and V and what this looks like now again from Mike site remember he was gathering a lot of information for a period of time and he was looking specifically at the association frame if you're to gather Association frame you wanted to know if that client supported data 211 are that's where you'd look if you see that mobility domain you immediately know that that client supports are 482 11 K the same thing URM enable capabilities and 482 11 V if you see the BSS transition so you can never really go off of a client data sheet we did some recent testing with a device where the manufacturer said it's supported our we put it in the lab and it didn't support our women connect we give them a call oh no it definitely supports our it doesn't and they end up coming back a couple weeks later saying yeah you're right it doesn't support we need to fix it now I don't mean to insult that gentleman's document anymore but there's two more there's another document RF roaming an optimization another fabulous document it talks about rami if you want to learn more about what I just talked about from enterprise roaming definitely to documents that you need to put on the reading list so managing a large network we see a lot of real-world wireless client troubleshooting issues and I want to share some of those one if you manage a network you need to have that mental checkbox I've mentioned it many times but you know if you have that mental check box and a ticket comes in or a complaint comes in saying hey you know what I'm having bad wireless performance in a specific area you don't want to be that guy in thinking uh maybe it's the wireless you have to be really confident that it's not the wireless so making sure again optimal RF design and optimal configuration go out there after the installation you know stress test the network make sure everything's working this way when a call come in you can have that mental check box and say it's probably not the networks probably client related it's really important that you get to that also understanding tools and how to quickly troubleshoot devices using debugs using packets in their first base on your network right again when you're out there and you're testing it documented you know a lot of times what you'll find is as you start testing different floors in different areas you might just see some type of anomaly where this one particular four floor isn't baselining like others and again I mentioned don't believe the client data sheets certainly when you're testing and your troubleshooting we test a lot of clients we test probably two or three a week for various things you know new wireless drivers coming in we recently tested Wireless door locks and some other client devices really important to to make sure those clients are actually meeting the expectations in their data sheets you know I hate this because when it's a wireless issue this is the wireless team right and this is server this is infrastructure this is applications right a lot of that going on and the more that you baseline your network the more confidence you have you get less of that but as wireless engineers we spend a lot of time in applications in other areas of the network that we typically really don't necessarily need to be in this is my team at Houston Methodist again really proud to have that opportunity to have a team that just focuses on Wi-Fi so part of client troubleshooting we recently started our deployment of epic and we're deploying a lot of iOS devices and I'm sure a lot of you folks have iOS devices as well write that one device that you know the Trojan horse horse that came in and interrupted what we believe is enterprise you know devices you typically would get a device from the company today you're bringing devices into the network we needed to find a way to get more I'm gonna call them hooks into those devices because when Doctor John calls and says the iPad is having a problem I'm only getting two bars what's two bars right so Ben sniff Wi-Fi about a year ago did a quick video and it hasn't really gotten a lot of publicity so I wanted to mention it here and I'm also going to be documenting this and putting it on air heads later this week early next week this is not jailbroken you can actually go in and turn your bars for cellular and Wi-Fi into DB how that's done is real simple you're going to back up the configuration you're going to go to an AI bot it's an application that can read that configuration and you're going to turn the gsm-r SSI from false to true that fixes the cellular peace then you're going to add a line as you see here for the show our SSI and make it true that adds the Wi-Fi piece you then that's the file that you want to go into the springboard you then save that and then back it back up to your device now I've been using this since iOS 8 so it's iOS 8 and 9 I have it on multiple of Maya's iOS devices every single one practically I touch iPad iPad Mini so and it also saves from cloud backup so I bought an iPad Mini I backed up my iPad 2 back up to it that had that fix in it and it moved over to the iPad 2 what again why this is important is because you can actually see what the device is showing rather than bars another thing that I learned from an iOS perspective learned this last week is that if you have a developer's account you can actually get the Wi-Fi performance Diagnostics I just begun playing with this so I don't have a whole lot of information on it but you add that profile you go to your Wi-Fi you click on test Diagnostics you put in save logs and what it does is it throws out a lot of the output this is one particular one that's of interest again this is actually the interpretation of the iOS device you could see the CCAA transmit packet error rate beacon packet error rate received frames the fire rates so a lot of information that we didn't necessarily have on iOS devices before the people kind of stumble upon and in the community people start to talk so if you manage a large network that has iOS devices this is great for like static configuration maybe you're having a particular issue and you want to see how that iOS device is here in the network developers accounts like a hundred bucks and we'll be documenting that too we'll put that on airheads in the next week again back to Mike site you know we're talking about wireless troubleshooting it's trying to understand the clients Mike has about seventy to a hundred clients that he's taken from the community as a whole they would actually send him the reassociation frames or a packet capture of that those frames and the make and model of the devices mark Mike goes through it and then adds it to the list so if you wanted to know what an iPhone 6 what what channels it supported in 802 11 R what's the transmission on it etc it's a really great tool to use Mike actually mentioned in one of his talks that that it's actually the the big generator to his site people coming out and checking out that that piece so when you're again down into the weeds right that guy with the binoculars in the weeds so we're a large Intel shop so anything that we purchase in-house has an Intel card while you can purchase a device with maybe a Broadcom a real tech we purchase Intel cards we do that for a reason we want to have one neck to chew we want to have the ability to focus on a particular driver not have to you know manage multiple drivers in the years we created an all Wireless office is going on two year anniversary we've become very close to the Intel folks it's been very challenging for us because you know if you have an all Wireless office for example and you're in a meeting or let's say you're not in all Wireless office you're in a meeting maybe an hour a day you're only using Wi-Fi for that day you can't really you know predict how well the wireless is going cuz you only on it for a day but if you have an old wireless office and that's all you have is Wi-Fi there's no cable for backup if there's a problem you're gonna know about it so I have a couple slides we'll talk about it but this is one issue we had where somebody said hey networks slow typical questions well is anybody else on the problem no it's just me alright what are you doing wrong right that's my metal thing and kind of go through all the basic so then we go out there and we look and we see this you know 5014 up and down yeah definitely something's wrote they're only going on we connect with our device we're not having that problem so we start digging deeper into the driver settings and we see you a PSD is enabled we asked them how did I get enabled while I was going in there just checking things maybe how to be work and actually Intel has a bug with you a PSD same access point same client turning it off or having it on and then turning it off you can see a night and day difference this is actually documented on the Intel website talking about the you a PSD issue here so again you know getting into the weeds trying to know all the aspects of the wireless client piece also in the old wireless office something that was very telling to us user perception is king would you all not agree especially when it comes to Wi-Fi it's all about user perception and what we did is art we have Cisco handset wireless handsets in the old wireless office and we asked users to grade the wireless Cisco handsets last year to this year and you're gonna see both years were eight nines and tens there is no change to the infrastructure voice is one of the more demanding applications and I'm getting eight nines and tens but look at this side our Intel's again remember every user has a Lenovo with an Intel in it we're on the 17 1204 driver and users are reporting fives threes fours I don't know where that guys coming from with a nine but everybody else's fours in threes we update the driver to 1820 we let it bake six to eight weeks users are reporting 10 seven eight nine all I did was update a driver I didn't change anything else drivers are so critical to reliable Wi-Fi this is a telltale sign of that specifically the issue from 17 12 to 18 20 what we found in the old wireless office it was the yellow exclamation point and it would pop up randomly it would show that you're connected you just couldn't pass any layer three traffic your pass layer to just gonna pass in a layer three the other issue was if your laptop went to sleep and you woke it up your Wi-Fi wouldn't connect you end up having to toggle the wireless on and off or you had to shut it down and turn it up now I can tell you in our normal production a user may just deal with that they're not gonna register a call because you know maybe they're out every now and then it happens they're not on the wireless all the time and you all Wireless office the first week guys we have a problem right so wireless drivers are literally the bane of my existence because again mix back in nuts they all behave differently and what we do at the old wireless office that I think is very important for us is that we take what we learned there and then we push it out to the enterprise so we find something that we have an issue if we can fix it in your Wireless office and it's working we then pilot up one of our hospitals make sure there's no big problems and then we push it out enterprise so that a lot could be gained from an all Wireless office I will tell you if you attempt to do an all Wireless office yourself certainly expected to vote a lot of time not because necessarily the infrastructure because you could see here everything was fine but it's really the clients you have to get your control of the clients so if you're gonna start an all Wireless office and have a variety of different NICs especially on the laptops you probably want to pull that in and just focus on one neck to choke so part of you know the iOS and our epic deployment is that you know people will say well you know I'm on my iPad it's really slow Network slow so we needed to come up with a means to test our iPads and iOS devices on the network going out to a speed test wasn't good enough because you get varying results paying how busy the pipe is depending the server you hit what server you hit where the location that server is so we do an in-house speed test so when something says hey the network slow we go visit the location yeah I'm doing 89 up and 106 down it's not us right and we share this with our users because it's about perception and interestingly enough when I talked about the old Wireless office we actually pulled individuals in and talked about the ask them about their experience because we don't want to get a group of people right because then everybody starts oh yeah I think it's a five you think it's a five ok I think it's a five right so we really pulled in and we got we hit individuals on a one-on-one basis also another thing when you're doing client troubleshooting is that we you climbed the the feedback we goddess you know the customers and patients we hate the acceptable use page right I think we're probably one of the first hospitals to actually remove it and you know the vision at Houston Memphis especially with executive leadership is about providing exceptional level of care as well as the the paper patient engagement part of that is let's remove the acceptable use page let's make it easy what this slide shows it's a story it has a story to tell that's the day right there that we remove the acceptable use page and you're going to see we had an uptick and bandwidth that's interesting right all we did was remove the acceptable use page so we start digging we're investigating why did we get that uptick you know we just didn't get X amount of more clients on the network right I mean but what we did find is that clients when they hit the acceptable use page they try to get on they eventually give up but now that they know the network and you walk in they automatically connect this data that you're seeing this uptick is opportunistic updates these are apps being updated iCloud photos etc so it was interesting to see this and then be able to investigate and where was it coming from so we're always troubleshooting Wireless kind some of the things we look at obviously you need to have the proper tools so I'm a big net scout err magnif-inator Wi-Fi analyzer err check off the view from my deep packet analysis I use savvy s omnipeek and this is interesting does anybody know what that is that's multipath we've all read about multipath right it's this mythical creature that's actually multipath this is a to stream transmission going on that's utilizing multipath it's very rare that we catch you we happen to catch it in the lab one day and like I got to take a picture of this cuz people won't believe me typically you would see just one stream going across that's multipath the other part you know when you're doing wireless troubleshooting is understanding your equipment now again I'd like to say this this slide has a story to say the story to tell I set up an access point I put it at 200 milliwatts what are 802 11 AC access points do right there more powerfully at the higher qualms and then I tested at 100 milliwatt 50 25 12 and 6 you can see the change at voice level next 65 but what's interesting about this that 8p is one floor above one floor above so that's the floor below it and that's the second floor below it so if you have an access point of 200 milliwatts 2 floors below you have about three or four offices getting perfect voice grade so if you have access points of 200 milliwatts create a very large cell and those clients will stay on to that cell for as long as they can and they're gonna pass three or four other access points when they should have room right so again optimal RF design is very important when I started at Methodist they said hey you know analyze the network now you may not be able to see this from here but there's no traffic going on and and that's about 60% so how do you explain to management that you know we have some issues right and the best way to do that show a picture if I came in and said I wanted to design an RF net or a wired network and I needed to have 60% of bandwidth just to manage it you'd kick me out this is what's happening if you don't have an optimal RF design and optimal configuration again 60% of the cell is used just for beacons low fire rates lots of access points not very pretty and why if you don't have the tools and if you're not familiar with this if that that's what it looks like devices and troubleshooting in healthcare a lot of times what happens is is that G EU or the like will come in they'll have a line item on the invoice that has a lot of zeros behind it and a description is Wi-Fi I get out on site because they're having problems it's a $35 USB NIC surrounded by metal right in $80,000 EKG cart being driven by a $35 $35 NIC this was just last week we roll out epic the first day life is good we're patting ourselves on the back no tickets in our queue the second day two tickets come in both of them for EKG carts both of them on different sides of the town these people only know each we had an optimal Network so we thought probably a device oh and by the way the other device is an EKG and it happened to be the same model we go out there friends that's a metal plate Faraday cage right and this happened to get missed right so we test a lot of our devices somehow this one didn't get tested because we would have been like you got to move that right so again we knew we had that mental checkbox that the network was good what you're looking at here is actually a warehouse so I do consulting on the side and this is a warehouse where they're having some trouble and again you know they're pointing at the wireless clients being the problem in fact it really wasn't was the infrastructure this is a single access point neg 70 that access point is that neg 80 you know one access point literally covering you know two hundred thousand square feet three two thousand square feet that access point has 21 22 other brothers and sisters and that's what it looks like for contention high gain when there's a problem what do you do pump up the power at higher gain antennas cuz it's gonna fix it right when you actually need to be doing the opposite so for friends that are familiar with carrier sense multiple access collision avoidance if I'm on this ap down here and I'm on channel 1 and I transmit a frame or that access point does all the other ApS likely in the surrounding area will here and they're gonna back off so literally I could be impacting users all the way over here on the other side of the network because it's one big contention domain again understanding how the troubleshoot clients and starting with the infrastructure is very important hallway designs you know if you were to ask me 10 years ago let's put in a wireless network and the customer said well I want to keep in the hallway I'd be like yeah that's not a problem it worked and worked for years but it's not a good design today and it's the reason why you put an access point and it's getting solve real world data right now I'm not marketing anything here you put an access point in the hallway look at the coverage I'm getting a little bit into the rooms over here but the holy coverage is great but really what you want to do is you want to put that ap in the room and use the walls as attenuation I'm gonna add more access points but I'm creeping the small the cell small because remember if you're on an access point its carrier sense multiple engine avoidance half duplex and this if I lead with this particular design my contention that I showed you all that blue should 100% I would start seeing that in the hallways so again understanding RF optimization is important I love this one these are phones that we've done tickets on and the ticket came in not because of a damaged phone a ticket that came in because Wi-Fi wasn't working half that phone's missing and it's funny because you would think a user if their own phone was cracked and it wasn't working well they're probably gonna go back to the store and get a new phone not here for some reason when you give clinicians of device and it doesn't work even though half of its missing it's still the network right it's a wireless problem now interesting one of these phones happen to be in the hands of a charge nurse and it was not the phone was broken every time she called anywhere a lot of jitter sometimes disconnect calls and as a charge nurse you're calling other nurses those nurses think they have a problem right but really it's that one device so again Wi-Fi takes the engineer out of the cube you know when was the last time the security guy I need to talk to dr. John doesn't happen round switch guy had to talk to nurse bet he doesn't happen Wi-Fi engineer we're talking to nurse Betty and dr. John we went out there we see this we're like whoa let's get a new handset go back and then we follow up how's everything going oh yeah it's perfect what you do to the network okay and again you know Wireless clients and understanding and part of troubleshooting understand they all hear differently what you're looking at here is three devices a Cisco phone and ascom phone in another ascom phone cisco 7925 i62 i-75 i-75 cisco phone 7925 on a same AP hearing it at neg 49 introduced a new phone i 62 i here at a 58 what happens when your network was designed for these two devices and all of a sudden you add this one and now there's a problem you call a vendor they're like all you need to have more AP whoa wait a minute maybe you need to fix your phone right so understand that when you're dealing with clients they're not all the same they're all going to hear differently they're very much like humans some talk louder than others some hear better than others also stress testing a network I can't you know baselining and stress testing network I can't stress enough you never want to go into a situation access points or hyung life is good you know you have to put it to practice make sure everything's work at that mental checkbox one of the devices we use back at the shop is called a watt the savviest wireless appliance it's wild packets on steroids and anywhere in the infrastructure I could turn our access points into sniffers and aggregate the packets we deployed this for our all Wireless office so when folks said that you know so-and-so disconnected we can actually go through their MAC addresses and see from a frame level analysis what was actually going on we worked closely with Intel during this process we learned a lot did you know like for example intel has debug drivers so these debug drivers are actually picking up other information when you install them and they create large log files that in some cases could within after about two or three days use up all of your hard drive but we were sending these log files and Wireless packet analysis back to Intel to help us with some of the disconnects we were having yes so any other honest office we had dedicated sniffers but it's an expensive proposition right you may not have the flexibility to do that in a large enterprise but this was our first kickoff for an old Wireless office so we wanted to make sure we did it right we're coming up on closing here in a couple minutes something I want to share is part of our client testing we look at QoS friends did you know if you use FaceTime YouTube Hulu Netflix the frames coming from the device up to the access point they're actually being prioritized you can see here here's FaceTime has an up of 5 DSP is 0 ESP makes sense because the packets going to destiny it's gonna be destined for the Internet's going to it's markings but the developers of these apps are pretty savvy right because they're going to make sure that their app has optimal performance that's a problem right because we're not marking on our infrastructure so if I have a user doing FaceTime Netflix or Hulu for example and I have my let's say my epic app which I'm not marking my that guess traffic is going to transmit first and all likely hit over my production and that's just FaceTime now FaceTime is more interesting because you're seeing you're sending large large frames up and down now for Netflix you're sending TCP acknowledgments back right so it's not it's not as heavy but know that Netflix is marking up YouTube is marking up what Aruba does very unique and other vendors don't you can actually do edca profiles so when a client connects to the network how it gets the measurements the timers the AIS measurements to use and the contention window sizes to use it comes from the infrastructure and you can manipulate that through these edca profiles so you can say if you're on the guest network oh and by the way if you're marking video don't use the typical enterprise-grade measurements it's like 3/4 video I want you to use an AAF a7 and I want you to use a contention window between let's say 31 and 1500 for example so you can manipulate those if you want to turn an access point into a sniff remote Peter does a great job explaining that you know I've always been especially from a consulting perspective you know I sometimes get customers to say well I want an SSID for this that and the other thing before you know there's like 9 or 10 SS IDs for those of you that know Andrew at revolution Wi-Fi he just released an app that you can actually put in your different measurements and you can see what the overhead contention will be on your network for utilization so if a customer says hey you know I want to add 15 SSID DS iOS app you start measuring out what that would look like and when you flip it over and show them it's 40% channel utilization you know hopefully you can convince them that's probably a bad idea another app that I use Wi-Fi explorer what like about this particular app is that the beacon information is in here so maybe don't have access to tools but you want to learn more about Wi-Fi analysis you can see a lot of that beacon information there again you know troubleshooting it's always about learning new right keep on keep abreast of what's going on here's some great blogs been Rosita and Peter and Annie's blogs a lot of these guys go into deep packet analysis I did a presentation last year I was an hour-long on 802 11 frames we literally spent an hour just jam-packed talking about every single possible 8:11 frame there is in there we also talked about client troubleshooting gave some real-world examples again if you're interested in learning more about that it's the packets never lie it's on YouTube support CWAP I'm often asked where you start cm AP is a great has a great curriculum the CW SP for security CWAP for a frame analysis CW DP for design CWA for the entry-level and here's a shameless plug I'll be speaking to Interop rock on and CW MP so if you guys are going to be at any of those event stop by and say hi and this promotes all I have thank you 