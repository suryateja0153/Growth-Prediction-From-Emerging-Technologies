 application password management is becoming a common concerns that enterprises globally the dramatic increase in cyber attacks has put a lot more focus on the pathology of attackers BOTS and advanced persistent threats now one aspect of this is their ability to trawl through scripts application code and configuration files on servers looking for embedded credentials that can help them further their exploit and ultimately gain access to privileged accounts and then onto your sensitive data it's absolutely critical then to include application password management as part of a comprehensive privileged identity management program let's take a look at an example of how an embedded password in a script file can be replaced with an API call to the Centrify privilege service as a means of mitigating such a risk so undress has been asked to create a batch file that will do a secure remote copy of a file from a remote system to the local system so he needs to do that in such a way that it's secure you can see in the local file system we have a batch file alright it's called Tony SH I'm going to ssh over to a remote machine just to show the file that he intends to batch copy over on a regular basis will enter the credentials here we do a quick LS you'll see it's a file called SCP data let's take a peek at that it's just a simple text file for demonstration purposes that's the file we're going to copy over let's exit from this SSH session go back to the local machine let's take a look at the batch file that under ashes put together now here you'll see is the secure copy command SCP but instead of having the password specified on the command line you'll see it's taking input from a variable called password and that's set up a little earlier in this batch there it is using DZ Dewar's in elevation command and it's calling get account which is an API call to the Centrify privileged service and if allowed by this computer then the password will be obtained so let's run this press return to run the Centrify privilege service get account API call with elevated privileges that obtains the remote password from the Centrify privilege service if successful if allowed to do so by role so we hit return and there we are we've got the password it's in that variable within the script file so now we're going to hit return to wish you the secure copy command and if all of that was successful we should have the file here on the disk and there it is SCP data so this is an example of how we can improve our security by replacing hard-coded passwords in script files with a call to the Centrify privilege service API okay so now let's take a look at how we configured our system to set this demo up we basically have two machines in the demonstration a source machine on which our script Toni Dodd SH ran and a target machine that contained the data file SCP data to be copied to the source machine by the batch script now both machines have the Centrify service we direct control agent installed on them and they're both joined to an ad domain controller so for example on the source machine if I type ad info you'll see that we're joined to our Centrify VMs domain in a connected state they also have pearl installed you can see my version here is five point 10.1 since our direct control agent obtains passwords from the Centrify privilege service we also have a running tenant and a cloud connect that deployed on a Windows Server that's also part of the same ad domain finally on the source machine only we've installed SSH pass which is only required for our specific demo because SCP the secure copy is an interactive copy tool SSH pass allows us to use it in a non interactive mode ie through a script file now at a high level we need to do two things number one permit the source computer to check out the destination computer account password and two we need to enable the script running as a specific user the ability to run the check out command in an elevated mode as root so for the first step let's consider cps to allow the source machine to check out a password for an account on the destination machine on our domain controller in AD users and computers you see the Centrify dot VMs domain and in the computers container our source machine eng cen 6 and destination machine new scent OS are both listed so they're visible to the privileged service now in the cloud manager let's navigate to the roles tab here you see our role that we've called a a PM cps password check out in the members section you'll see our source sent OS computer so what right does this role provide its members well in the administrative right section you see privilege management limited selected let's switch over to the privileged service now and navigate to the resources section here you'll see our two machines set up if I click on the source machine Monty sent OS and then go to accounts we've created an account record allowing us to login as Acme consultants now if we go back and select the destination machine new scent OS you'll see under accounts we have the batch SCP account that our demo script will use to login and to do the secure copy now an important configuration here is that we need to give our source machine permission to check out the batch SCP account password so if I click on this account and navigate to permissions you'll see our source machine and send 6 listed with checkout permission our script will be using the privileged services see get account API call to check out a password that call is a privilege call so we need to set it up in Centrify direct manage so here we only have a single zone so within that will navigate to authorization then we'll go into unix rights definitions and finally to commands here we've created a new unix command called aapm get account silent if we open that up you'll see the actual command that our script will run under privilege it's essentially the sea get account command run in a silent mode on the run as tab you'll see that we're going to run this is route now we have to assign that right to a role so in the role definitions you see we have a role called aapm get account silent you see the right assigned to this role finally we need to assign this role to our user so in the role assignments I've highlighted the assignment of this role to the Acme consultants user so we're done okay let's do a final confirmation to make sure that everything is set up so logged into the source machine is Acme consultants let's confirm we have the necessary rights by issuing DZ do minus L ok you see the command second in the list so that's good now let's ssh over to the target machine here you see the data file will be transferring over using the SCP command ok let's exit this ssh shell and go back to the source machine and let's just run the demo and everything worked the configuration is complete 