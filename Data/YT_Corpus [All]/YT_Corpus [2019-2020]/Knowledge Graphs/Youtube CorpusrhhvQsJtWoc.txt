 All right! In this video tutorial, we're going to work with the Cleveland heart disease data set that we downloaded last time from the data.world website. I think we saved it in our H-drive from this PC -- HDrive -- Biostat_lab and that's the data that we're going to work: heart disease for more than 300 people or patients and we had some characteristic recorded for each patient okay? so first of all, let's open our R studio from academic software Rstudio The first step is in Rscript editor is to create a comment that helps us for the next time that when we open our R we know that what we're going to do what this code does for us. Okay? so this code is to to practice making graphs for categorical and quantitative variables okay? so the first step is to read the data set read the CSV file right so let me create a comment read the data so we use for the CSV file if you remember we use read.CSV command and first we have to read a file and then the header if there is header so we have to set the header to true. We used file.choose() if you remember file.choose() allows user to select a CSV file okay and also we need to set the header to true - true to treat the first row as the names okay. So the next step is to store this in a object an object for example with the name of any appropriate name that you prefer I just use Data okay and so when I click run put my cursor mouse in this code and then click run and I have to select a CSV file. alright so we have three hundred and three observations or patients and nine variable so let's check the first few lines using head command okay okay so we use head of the date then click Run so you can see for the first few lines we have line 1 to 6 for all of the variables and also the rest of the variables. You can also check the last few lines using the tail command right? tail (Data) and also let's have a summary of data so summary of variables okay we use summary command and the name of data set which is Data and then click run so recall for quantitative variable R returns minimum maximum mean first quartile right minimum maximum mean first quartile median third quartile so these are for the quantitative variables right such as age resting blood pressure just so this is not a quantity this is actually a categorical variable but have to change it if you want to treat this as a categorical variable but for categorical variable it shows us the frequency table okay so the values that we have for example for sex: female and male and then number of the people in each level of the categorical variable. That's a summary of variables so let's start with categorical variable okay so I create this categorical variables, for the categorical variable the first important plot or graph is bar plot okay is useful categorical variables and it shows frequency and also it can show the percentage or relative frequency or proportion for each category so first of all we need to if you remember from the class we need to first to generate the frequency table and in R to generate the frequency table we use table commands okay so for example what I'm gonna do is I'm going to select one of these categorical variable for example heart disease this is a categorical variable okay and then I'm going to generate the frequency table for it okay so what can I do is from Data I use dollar sign and then I select heart disease okay and the reason I do this because I don't want to use dollar sign a lot in writing the code so I save this in an object with the name of idk...heart.presabs and after that I can now generate a table for it okay the frequency table for it using the table command okay so table input variable will be our heart.presabs variable which is categorical variable and then I will save it in table1 okay so let's see the table1 so if I select this one so heart.presabs so first I have to run this code because the order is important right so I have to run this code so R now knows heart.presabs and after that I run this code it creates a table1 and and now I can see the table1 okay that's the frequency table so I make a comment here that this is frequency table for heart disease okay so the next step after creating the frequency table for heart.presabs is to use barplot command so remember you shouldn't use space between bar and plot okay? so it's very simple just use barplot and the input for the barplot should be our frequency table okay which is table1 and if you click run so now you can see we have bar plots of the heart disease right heart disease presabs, which is also a categorical variable it has two levels absence or presence and for each one we have frequency for the people that didn't have heart disease and for the people who had heart disease okay so that's how we can generate barplot but let's make this a little bit nicer so what we can do is first of all let's add a title, so we use main argument to add a title for example "Barplot of heart disease" okay? now if you click run so it will add a title and also let's add a label for x-axis for example the heart disease presence or absence of heart disease so we can add a label to x-axis using xlab and heart disease so the next thing is for the y-axis I think it's better because the y-axis shows count or frequency right so let's add a label for y-axis using ylab command and then count so you can see we have count in the y-axis or vertical axis and also we can limit the y-axis so the values can run from zero to 200 okay instead of 150 because it doesn't contain the rest of the values so I can limit the y axis using "ylim" y limit and I'm gonna limit this into between 0 and 200 more than one value so I use C command and 0 to 200 .. The next thing is we can change the color of this using col command and I'm going to have a color for absense and a color for presence so it should be more than two numbers or two values or two character because this one also can be numbers so I use blue for the first one and red for the second one okay and finally I can add a box around this bar plots okay so out of the bar plot box open and close the parentheses and then run so it creates a box around it. So that's how we can generate barplot for categorical variable and each bar, each of these bars shows the frequency or count for that level okay.. presence or absence of this categorical variable. Let's create a comment for this so bar plot or generating bar plots as you know bar plots can also be used for the relative frequency or proportion or percentage okay so here if I so I have table1 right? which was number of people with heart disease for each category so if I divide this by the total number of values which is three hundred and three so we will have percentage for each category right so if I divide the table1 by 303 we will have percentage for each category so I can use this for generating the relative frequency bar plot okay? again let's create a relative frequency table: relative frequency table and so I'm gonna use table1 divided by 303 okay and then I save it in another table because it's different in table2 now I can here see the table2 okay so table2 created here and then here I can see the table2 which is based on the percentage. Now it's very easy again I can create a barplot based on the percentage or relative frequency okay so I can create the bar plot and it is based on the table 2 this time okay now if I click run so the values are percentage okay in the y-axis the proportion again you can make it look better we can also copy the values for example from the table 1 and then change it so this one so main is bar plot of relative frequency relative frequency of heart disease and xlab is heart disease and ylab is not count okay it's percentage or proportion and ylim it is not between 0 and 200 it is between 0 and maybe 1 or half. And the color blue and red and create a box so let me run this ..... you can also add a legend to the to the bar plot so using legend.text argument so if I any places for example here I use legend.text and I set this to true ok? and if I click run I can see that the legend will be added so the blue shows absence the red shows presence of the heart disease This one is frequency or count and if I copy this, this is generating barplot for relative frequency or percentage. So in summary, for creating a bar plot first we need to create a frequency table or relative frequency table using table command and then create the bar plot using the bar plot command and the input arguments for the bar plot should be your frequency table or relative frequency table. And also sometimes you may want to have horizontal bar plots and you can create it if you just... lets look at the help of the bar plot I think horiz argument if we set this to T so the default value is false but if we set this to true we can generate the horizontal bar plot okay so if I add this and make this true okay so I can generate the horizontal bar plot but it's out of the.. so you can generate a horizontal bar part using this argument by adding these arguments horiz and set this to true. okay the next categorical variable that we're going to talk about is pie chart. okay so let me create a commet to make it clear and to create a pie chart we use pie command okay so it's very easy and the input value for the pie command is the table can be frequency table or relative frequency table okay so let me because we already have the frequency table I use it here table 1 and then I create the pie chart okay so but this one shows the presence or absence okay and how about the pie chart of table 2 again it's similar to the table number one. Pie chart of the frequency and relative frequency there are no difference between them and you can also add a title to this pie chart for example I can add main argument using main argument I can add pie chart of heart disease so it's presence of heart disease or absence of heart disease okay and you can change the color of it and also the legend and other characteristics but as pie charts are not recommended in literature I leave it to yourself if you would like to learn more about it you can just search it here help and then type pie okay and then you can read the argument what you can change to that you can change the angles you can change the color density and so edges radius so you can change this using these arguments so now let's move on to talk about situations where we want to compare two categorical data. For example we want to compare sex: male and female and also heart disease presence or absence both of them are categorical variables and we want to compare them okay in this case first we have to create a two-by-two table also known as contingency table so again we use a so let me create comment that this is for two categorical variables so again we use table command and it's very similar to the one categorical variable but instead of having just one categorical variable inside the parenthesis we will have two categorical variable okay so the first categorical variable was within the Data let me see... this one sex was a categorical variable and also the other one which was heart.disease okay so now I'm going to save this in an object with the name of Table 3 okay Run...so if I want to see that Table three so here is the contingency table a two by two table I can see that among the people who didn't have heart disease 72 of them were female 92 of them were male so these are controls and among people who had heart disease or cases we have 25 female and 114 male okay so I'm going to create the bar plots but in this time is for two categorical variables so there are no difference between the barplot for one categorical variable and two categorical variable in terms of using the command so again that command is barplot and then the input will be your table but this is this time is Table 3 and if you click run it will create a command that among the people who had heart disease, most of them have I think there are female so we need to add the legend first of all let's set the legend.text to true okay run so these are female these are male you can also change the color "col" command so more than two values we use blue and red or maybe a green and red and also you can change the other thing okay you can change the main you can change the ylim y-limits and also we can make some other changes in this barplot okay create a box around it and so forth this barplot is also called a stacked bar plot okay and so you can compare male and female directly for the cases and also for the controls so that's the stacked bar plot this is how we can create so this is a stacked bar plot okay so the next thing is if you add a new argument for example to this stacked bar plot you can create side by side barplot okay so if I set the beside argument to true okay they will be side by side barplot again you can add argument like ylim box around the bar plot and so forth so I leave it to yourself.. Now, let's move on to talk about the quantitative variables okay so here I create quantitative variables... So far we talked about the categorical variable but now we're going to talk about the quantitative variable the most common plots when we have just one quantitative variable is histogram and histogram is very similar to the bar plot and also can show frequency or percentage for each bins so the difference between bar plot and histogram is that for barplot each bar shows a level in categorical variable but in histogram each bar represents a quantitative variable and also in the barplot there is a gap between the levels but in the histogram there are no gaps between the levels. How we can create the histogram? create histogram so we use hist command in R to create a histogram and what we're gonna do is we're gonna create a histogram for we have to select a quantitative variable right? so let me see which one? Age is a quantitative variable I'm going to create a histogram for Age ok? so first of all let me extract Age from Data I'll use dollar sign to extract age and I save it in variable with the name of Age okay? and then click run and then I'm gonna create a histogram for Age, right? This is a histogram of age you can see there are no gaps between the bars and also the bars R automatically creates this number of the break ok 1 2 3 4 5 6 7 8 9 10 we have the values of the age or almost between 30 and also 80 okay so or maybe is 20 and sorry it's 25 also 80 so and you can see that the distribution is almost normal seems normal it seems normal but you have to check the normality if you really want to know but you can see that most of the people are between 50 and 60 years old and a few of them are older than 70 and also younger than 35!! years old okay so that's the distribution. It shows the distribution of the data and it's a quantitative value between 40 and 50 and between 50 and 60 and the next thing is that the Y or the the vertical axis shows the frequency of the people that are within each category or within each bins. So let's make the histogram look better for example we can change the color of the histogram using the "col" command and I use I don't know brown okay let's see so you can change the color and also you can change the limits for the y-axis right so I can change it ylim from 0 to 100 okay? so that's for the ylim or I can i can use the shaded lines okay so there is a command with the name of density so for example if you set the density to 10 you will have 10 lines okay so one two I think the tallest one: one two three four five... ten lines .. when you prefer to use a shaded line you can use the density if you for example increase the number of the density in the density argument you will have more lines okay or if you have for example 4 For the biggest, for the largest bar we will have four lines okay so that's the density sometimes you prefer to have a shaded line and the next thing is we can add a title so we already have histogram of Age but that's a good title so I don't change it. So R automatically generated the number of the breaks we can change number of breaks using the breaks command okay and then for example I don't know okay so here you can have 3 number of the breaks let me remove it I think that default value was better I think it's automatically generated the optimal number of the breaks so what we're gonna do is that so this one was histogram of frequency okay of frequency. We can create histogram of the relative frequency or percentage okay so I'm going to create the histogram of the relative frequency in that case we add a new argument to this line of code and we set the frequency freq to false okay so it's not based on the frequency and when you hit.. click on the run so it creates a relative frequency but why we can't see this? because we set the ylimit between zero and a hundred and the values are relative frequency are less than one right so I can change this Y limit or I can remove it okay I can remove the ylim and then I can run it so we will have the same shape for the frequency and relative frequency so that's how we can have the a relative frequency and just noticed that the values are very small and for a relative frequency that the total area of the relative frequency is equals to 1. And another important plot for the quantitative variable is boxplot which is made based on the five number summary so we're gonna create box plots okay so we're gonna create box plot from a quantitative variable in that case is "Age" we already extracted it right so I'm going to create we use boxplot command and then very easy I just put the name of the quantitative variable which is Age right? so this is the box plot it starts almost a minimum is less than 30 the median is this value, the first quartile is less than 50, the third!! quartile is less than sorry greater than 60 and the maximum value is between 70 and 80 so you can also see the the exact value of this you can use summary right? summary of age so it gives you that the minimum is 29 and the median is 56, the first quartile is less than 50: 48, the third quartile is greater than 60: 61, and the maximum is 77 okay? So the box plot shows the distribution and also the variation of the data so we can also make this box plot horizontal if we add argument horizontal I think we have to set this to true yes so that's the horizontal boxplot. Check the normality using the box plot too so distribution is not perfectly normal is kind of skewed to the left right so here we have higher so it's like this... you can also add the color and other things so we will talk about more details of the boxplot so we're gonna first create a very basic box plot so add the color like red and you can add the label for the x-axis for example the x-axis shows the Age right so I'm gonna add xlab which shows age of people and then let's run this command so you can create a box plot very easy: in the future allows you will create several box plots that is used for comparison of the distribution. Finally, to compare two quantitative variables so here we had just one quantitative variable so now we're gonna compare two variables so we can use scatter plot using the plot command to compare two quantitative variables, for example I want to compare age which is a quantitative variable and what else? I want to compare it with maximum heart rate okay so maybe it makes sense so how can I do that? so I'm gonna create a scatterplot: scatterplot to compare two quantitative variable using the plot command so plot and then I have age which is a known variable but for the other one which was maximum heart rate it is not a variable so I have to use a we don't have it in there in here in the environment right in the workspace so I use Data and then I use dollar sign to select the maximum heart rate and then click run so we will have a scatterplot okay so it seems like there is a negative association between age and maximum heart rate okay? so as the age increases the maximum heart rate decreases. We can make it nicer for example I can add a title to this main command and I can type "Age versus maximum heart rate" okay? and the next thing is let's see the result so here is the title and also xlab because xlab is age but based on the year okay? so I'm gonna add the Year inside of the parentheses but don't forget this is a character so you have to put it into the quotation and we also have we hope I think it's better to change the y, ylab is kind of ugly so ylab to maximum heart rate okay max heart rate. So let's see this changes first so we have age maximum heart rate. Important thing is that you can change the plotting character okay so here we have so we use pch command to change the plotting character so we have pch and we can set this to any character okay that we have for example I can use I don't know a star instead of the circle that here we have right and then when you click on run it creates a star and you can also use the letters for example I'm gonna use I don't know R okay so it creates R, you can use so many characters here or you can use plus sign or I can think the * was better or O anything that you prefer okay so that's for plotting characters and also you can change the size of it using this cex cex we can change the size of it if you for example select half it means that it's half of the normal size okay so I select cex equals to half so the size is half of it half of the normal value and if it's like two it's double okay so that's the cex half is better and what else you can change the color of it for example I'm gonna change this to orange color and then click run alright so when you're happy with your plots you can always export your plots okay so for example here we have a plot we're happy with this you can click on export and then save it as an image or as a PDF okay for example as an image you can save it set the destination that the output location and then the image format PNG JPEG and then click Save and then it will be saved in the directory okay 