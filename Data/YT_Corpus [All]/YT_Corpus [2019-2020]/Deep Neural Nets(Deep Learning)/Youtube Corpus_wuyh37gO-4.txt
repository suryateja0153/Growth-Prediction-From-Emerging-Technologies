 please give a warm welcome to dr. Christian so good morning Seattle good morning everyone thank you for Reno coming together today so as you can see that you know I work at Hitachi and I had a small team of people Javed figure distributed we do a lot of a I'm gonna stuff so this is one of the projects I know what we have been doing for the last couple of months I mean just seeing him to share some of the results what we are God and let's keep the questions towards the end you know I have a couple of slides to go through and has now being introduced the Google developer experts this morning I happen to be gde for Google cloud as well I had the privilege of being that for the last five years so if any of you want to know how to become one feel free to talk to me during lunch time having said that let me just get go get going into the talk right away and say you know most of the time we have some agenda what we are going to do and then i'ma show the demo later on but I'm going to flip this around and say hey what is that you know we actually built that was not very important to you guys you know are the results they're after right so in this particular problem the there was an opportunity that Hitachi was working on or that say my company was working on where we have to identify the faces we have to detect the faces we have to track the people and we have to redact people who are not person of interest okay so we actually built a solution we call it as a solution because we consumed quite a bit of open source software we did our own innovation on top of that and what you're going to be seeing in here is the net result that actually comes out of it so let's start with the actual demo actual demo itself in here right so I want you to watch you know the person number ten we like the person you know it's as of magically she knows that you know we are actually capturing a video and of course we did not capture the video it was some media from the internet okay so this is what you're going to be we know seeing how we actually built a solution that actually created this video in terms of not only tracking one person but tracking multiple people and also redacting you know people who are not require or not you know who are not who need not be redacted or know who needs to be left unprotected kind of thing so it's okay okay thank you all right so now let's get into in here basically I'm going to be defining you know which category of people which category of market actually requires this problem to be solved what is the solution approach I'm going to walk you gently into an or introducing a flowchart not much on mathematics side of things but more into logically how with this problem we solved it what is the takeaway that you can take from there just identify four key features and of course I know few more demos not the first demo but you know several more demos that is coming thing and a sneak peek into and there was an error no it's not a peek you know it's a PE k we'll fix it later on but then in the sneak peek on what are the other projects or not what we are doing so first thing where is this in a hole opportunity exists right so it's in law enforcement area so we're in there are a lot of people uploading videos on the internet whether it's from bring video camera ringing Bell video camera or your nest video camera I'm sorry it is Google right so talk about nest video camera and then when these videos are going to be presented in front of a judge in front of a district attorney in the US what happens is you need to leave the people who are person of interest in tracked but everybody else should be redacted right legal requirement privacy reasons kind of thing so now that's the opportunity that we are not known we are currently working on and this is a knock take it like version one of the results are there so now some of the things that needs to be redacted is face number plate you know street signs all of them and again face mixing from a privacy which just happens that in our number plate non-important number plate should be detected and redacted and of course street signs if you show them kind of having a negative impact on the property value in that area so in a street sense also should be redacted then the question comes in why do we need a solution for it why can't we do it manually yes you can do manually with an old videos where in you know 30 frames per second kind of thing but what they know 4k video is worth 60 frames per second 120 frames per second you can't really you know put a person to actually do it at the same time you know there are so much amount of video that is being uploaded to many of this portal so we need an automated method to do this or do this whole work the third one is that many of the CCTV camera these days are not stationary they are actually panning back and forth so when you have panning cameras back and forth the challenge becomes that a Christian and this particular frame is this the same person who I now see a different side profile when the Rana camera actually pans together so we need a method to actually track people who are non stationary either the camera is not stationary or the person is - - later right so this is required that's the third you know challenge that were we kind of under to consult in this whole project and the last one is yes there's a lot of open source libraries as I said here it's more about building a solution that comprises of I know let's say a working solution we did a little bit of coding but we also consumed quite a bit of open source software that means each of the software by itself is not a perfect fit for the problem they are solving part of the problem but not the entire problem so we amalgamated multiple things and that's where you see no single open source library on the internet that we are familiar with you know is able to solve this problem right so we did lot of scouting on the internet and then you know we started you know doing our own work so now what's the solution right the first thing is we call our solution I redact no link to any Cupertino company to just you know make it very clear this has nothing to do with iPhone or anything else I just call it I read act and then it kind of comprises off you know so framework libraries there's a Jia CLI that you can use so if there's an opportunity to a workshop I'd be happy to show that you know the soul everything is Python Python as a primary programming language in my group say lig wine also integrates with a web app the web app purpose is primarily to manage the video right somebody uploads a video to a portal and here is a law enforcement officer who needs to redact and not reduct those other things and i deducted self comprises of three components which is a no-face number plate and also street signs this talk we are going to talk only about the face there is the sneak peek about you know number plate on street signs okay and i'm talking a little bit fast but just bad with me no I do want to enough cover a couple of slides so that there is some value at the end of the day at the end of the session for everyone who came today all right now I deduct face here is the algorithm that eventually that worked for us so first fingers here comes a big video it could be 4k video it could be you know full HD video we first have to in two frames okay very logical step everyone knows about it but now there are multiple methods that actually works it and I know we tried a couple of method and we ended up with one method that was OpenCV I have more details later on we end up into chopping into frames now once we have this enough frames everything there now we need to detect how many people are there in the particular frame let's say there is I know a security camera running in here the four camera captures in our video of this room there are a lot of people in this room right so we need to be detect how many faces how many human faces are there in this particular video now as I said no single open source library was able to detect everything primarily because this particular you know some of these libraries detect large faces some of them are good at the right profile faces left profile faces partial faces these are all challenging so we ended up by not cumulative together our amalgamating couple of libraries together and a method through which to say if there is a bounding boxes for two people or two bounding boxes in a video is it refer to the same person or refer to a different person right so we'll have more details and are coming together now once we have all those faces there we need to say well there are two faces is these two faces two different persons how do we know right so essentially for people who are in OpenCV world or who are in video processing you have something called facial embedding but for everybody else and it just means that we create something like the equivalent of a fingerprint for the faces right so it's just called as facial embedding again using an open source library from Google called as face that we slap on top of that of the frames the face is detected to create a unique fingerprint or face print if you want to save so with all the people detected in the particular frame after that now the video is being proven now the radios moving then we need to track to say hey you know is this person moving right one person say person a was an x-coordinate X&Y now the person is going to move to coordinate you know let's say x + 1 + y 4 y -1 is this the same person how do we know that we repeat the same process by extracting the faces extracting the generating the thumb prints or enough sorry face and then combining them to see that is it within the same distance vector within a threshold to see it's just the same person or a different person so that's what I know you see in terms of you know deeps or tracking I have more details in a second and finally there is a very unique problem that when a security camera is panning from left to right you know let's say I'm stationary and one side of the room and I'm talking with my friend but the camera just went away and there were cameras no coming back because the camera went away I went out of frame now there is a real problem that when I come back I could be given a different ID and I remember all the IDS what you saw in the first video the demo video de ferran system generated right the first face I detect number one second face I go number two I do not assign it so when you come back in here now Christian got in or 10 in one of the video now Christian got 20 in another video it's 10 and the 20 the same person or is a different person so that's what we saw we're not using the clustering now we put together all the solution together so that we put all these steps rather create a solution so that this solution is now capable of processing videos and it's going to be automatically generating you know what we call it as a checkpoint file more detail soon with that we can now give it to a law enforcement officer who can select some of the frames to say keep track this person and then you know em redact every other person okay makes sense all right sorry thank you thank you for you know keeping with my pace of talk I'm from Virginia by the way I'm still you know got up early in the morning the time zone all right so now so first thing extract frames from video that's OpenCV that's the method that actually worked face detection networks as I said there is no single network that actually worked with everybody with every face every video we tested we ended up with selecting three different methods there was no threshold for three or four we started you know color experimenting with a lot of libraries and as there was overlap between other libraries and one library was performing better we started dropping and we eventually ended up with three libraries the names are coming up in the next line then now each of the library is going to be detecting in all that says detecting me one is going to draw maybe a rectangle box another one is going to draw similar bounding boxes maybe not exactly overlapping now with two there of this overlapping boxes we need to see is this two different people or is it the same person right so we used non-mac suppression method for that then we generate the facial embeddings that's using the face nut as I mentioned it with earlier then we introduced deep shot to actually track the people and finally we cluster it with BB scan clustering okay now with all these things done this will call it as pre-processing right because we are also not a pure academic group we are an inner I know and industrial group wherein we need to take the solution and need to be able to scale it you know maybe not nor Google scale but you know let's say scale it so that we are able to do lot of processing so we created in step number seven checkpoint file and the checkpoint file is basically a JSON object that just says here is a tracking ID for each unique face that face appeared in this particular frame and here is the bounding boxes for that particular person so we create all these things so to the pipeline we just simply call it as an IED attack pipeline here comes a video out comes a JSON file this is a single time processing and we just you know literally created a full let's say x-ray of you know every person in the particular video once this is done we then build basically a simple Python UI for Elio is law enforcement officer to select one or more faces so now comes the you know challenge that initially when we're doing the project the requirement was I'm going to select only one person and everybody else must be redacted this requirement kind of you know changed and said what if two people in the suspect in the video are working together I need you to be tracking those two people right but don't leave everything else so we have to know kind of expand it to say it doesn't matter where there is one person or any number of person you will now be able to track so even if a group activity that Elio wants to track they are now able to do that all right so it's a Python UI then basically give the raw video give the JSON file with this your small little UI tool and then out comes a redacted video and depending on whether we have access to CPU GPU maybe TP one day we'll be able to know faster right now we have tested with GPU and also I know CPUs then last one as I detectors integrated with the custom web app that was just to manage videos right that's pretty much it uploading managing tagging user authentication all those things so now with that said I want to now go with four key features maybe you know it's time to little bit slow down and give you slightly more details the first thing as I said the challenge is you know detecting phases in while it's still a challenge irrespective of the recent process and again their face orientation ratio size background everything can affect now the net result is almost impossible for a single neural network or single network to identify all phases our approach was to run multiple networks in parallel amalgamate the results and then these are the three networks we saw the name earlier on here is the expansion of the name these are all academic papers behind it there are libraries behind it so we you know the approach what we took and building the solution is to use pre trained networks or retail models and then we did a little bit of transfer learning in order to get the final result from there now ski fetcher numbered one key feature number 2 facial embodying generation this is again he was in Google's face not essentially for every bounding box for a face that we deducted we took it we ran it through the face net that gave us an oh and 128 byte vector that we stored it that kind of became us not exactly a tracking ID but then unique let's say facial fingerprint for that particular person now check our key pitcher number three now we had no need to be tracking people across the frames so we were hunting for some methods for it academic solutions we ended up discovering there is something called sort which is simple online and real-time tracking but then there was another paper which was deep sought which built on sort so we first start off with sort then you know we looked at deep start and we integrated deep sort with facial embedding so our solution the uniqueness of the solution is that first we took the images we did not stick with one particular pre-trained model we took multiple pretend models we found a method of amalgamating the results together then we introduced facial embedding on top of it and finally we introduced deep sort to actually track the person as they go through the sole solution okay so this is the third key feature now the fourth one is basically clustering and again clustering is required when you have you know more than and when you have the person go out of the frame and then you know come back into the frame alright so this is the features so with that let's say the theoretical you know section of it is little bit done now I'm going to be you know talking about the results right of course you saw one of the results but that didn't include the redaction part of it so now I'm going to show a couple of results and for this whenever we do any work in my group we want to compare against the best okay and it just happened that we were comparing with YouTube studio and then you know we got this opportunity talking to Google you know ml summit so everyone of this use cases video what we had we took it we upload it into Google Google's YouTube studio the YouTube studio has a capability to redact faces okay so if you're not familiar with that go check out their does a capable it does a feature there let's see how I did that compared so I'm going to be talking about you know three demo videos kind of thing the first demo video lot of people a lot of different faces that camera is going to be panning back and forth right the small faces big faces partial faces this is the first demo this is the first or rather testing video what we took so here this just shows a couple of screenshots between where you know I redact but for better compared to YouTube so in this case the video what you're seeing is you know pressure in terms Inauguration video I think 2017 2017 January right and then we just took the video does available from whitehouse.gov and then we ran into a solution you can see on the left that we were able to you know redact detect and redact more faces but then the youtube version was not able to detect you know small faces right and I have the video playing in a minute but just to show where the differences are or in this case we were tracking First Lady Melania Trump to see you know leave out many new Trump and then you know detect every other face that is detectable and also redact those particular faces so now coming back to here again here the circles show the difference that in I rate that we were able to detect in probably the Secret Service people walking behind the president we were able to detect and redact but then YouTube was not you know able to detect it again we are not saying we are perfectly you know better than YouTube I know we have examples where YouTube you know what slightly better let's let's take a look at the particular video here so as I certain OB but I know we were tracking millennia Trump here so every other person human face we were able to detect then we were able to track and then we were able to know redact as well right so now let's go to the next one I don't want to play youtube video but I know it is just present in here to show where are the critical points that actually miss now interestingly when I did the first demo you know in a in an internal presentation one of the person came and said you know are you Republican right I'm like well I'm a scientist you know in all my projects I take the role of a principal research scientist you know scientists and Republicans seems to be the same number of characters so I said you know we have to know this for this and say that they know we are not going to be you know we are not going to be you know seen like this so the next video what you actually took what happened to be just you know President Obama's video it's one of the national security briefings and here the challenge and the opportunity is that I know Obama was giving a talk there are only very few people the faces are not moving a lot but the glass what you see in front of President Obama actually has a reflection of the face probably the video camera and not the father the the person of video who's shooting the video and kind of thing so that kind of interfere with it again here to show that in this case it's an example where YouTube in exactly one you know some instance was able to detect a better face compared to no we could not you know we tried multiple times but we cannot detect that particular partial face so that's going to be I think it's 18 to second so let me just play with so it's going to be this this particular person when she bends down to take something now we will be missing that face so again it's 18 to second yeah so you can just see that they know it so very very so it's not even a full face is just you know family half of the face and then you know we'll take it from there right so okay so this is about verse one so now you know this is YouTube which does a very good job I know they kind of you know track the kind of track all the faces they kind of track all the faces and then you're also deducting it you will see the same person they do not miss the face so if there is somebody from YouTube studio happy to exchange norsu later on right it's um yup this is an 18-second the same video the person will come down they still maintain the tracking and they are able to show that now the point here is it's very important and now to know that in the law enforcement area privacy is a very important thing even if you miss a single face you know your video or you know video evidence may not be accepted in a court and that's where we take very good care that you know we need to be redacting all this faces now demo 3 right whether we are Republican or Democrats it doesn't matter most of the time people in all the countries what are you care about shopping right so we took a black friday video very noisy environments here we are not perfect okay neither is YouTube but then we did a much better job compared to YouTube that here is extremely noisy environment within a lot of people going back and forth and then there's a lot of racks and there and you know we did not do a good job but at the same time this is not an evidence video we just took it as a challenge we ran it to the solution you would see that we did miss a few faces here and there we are tracking this particular person there but then every other most of the other faces we were able to detect yes a little bit faces on those boxes as well right so this is you know to show a third video that we know we took in here right so again this whole thing what the primary thing what I want to share you in here what I wanted to share here is about a solution that you know we painstakingly put together to show what's possible with open source libraries and some little bit innovation on top of that so now this kind of brings to end to my presentation what I want to talk about in here but I want to give you a sneak peek so first thing is I redact I told you about you know this talk is about face radar detection reduction kind of thing here is number plate street sign and we also have a very interesting project that you know we are doing defect detection on utility pipes just going to take a few couple of more slides to show that so I did that number plate here is one detecting the number plate and then you know with high confidence what's the number plate but here is our video off you know the number plate said of being redacted as well you would see that you know here we processed a live video and the liar via wave we need to detect any number of number plates and we need to redact it right and this one just just goes on for a seconds and then you will see that the vehicle will accelerate slow down but this is still work in progress it's not a fully big solution so you would see that you know very few instances we do miss you know the number plates from certain vehicles in there all right so talking about street signs street sign is actually an interesting problem for us because again as I said if there is going to be an evidence video from a CCTV that shows and on let's say you know any unfortunate incident in the neighborhood if you don't redact the street signs the property value is going to go down and that you know gets into lawsuits and stuff like that so will need to be detect street signs we need to be know redacting it so here what you see is couple of street signs on the first column you have just the street signs on the wall there's a street sign directly you know independent of the wall we were able to detect the street signs and then you know we are able to redact it so you might be wondering at this state you know hey you know you're just doing OCR and then you know you're doing bounding boxes and then you're trying to read acting it actually the solution is not that simple because here is I know a street safe of a video you can see from the result below that yes we do do OCR we do do it says carwash but we know that that's not a street sign right so in this case we don't need to redact it so it's not just OCR there is some library references what we do to say is this an address right or is this actually some name word you know lying down somewhere okay so that's I detect and just one last video and this will not work is a video just a frame in here you would say that this is a tilde pipe running underground in the u.s. in one of the counties and right now the process is that they send a robot down it and you know somebody records the video painstakingly looks at all those things and more you know modifies registers all the crack one is that the picture on the left just shows that at frame no time let's say some time we detect a crack on the top next frame you're actually data explaining the crack this is again using deep neural networks this is a very big utility in yet because the pair of the pipes in the US are getting old and we need a more efficient method of doing this whole stuff right so this is again a ongoing project the you know as I said I'm not a Superman I'm only had a team you know I'm a principal research scientist we go in packs whether it is a compromising of data scientists data sense engineer and data engineer you know just to give not just if you give a recognition to my team and of course you know my extended team you know and having talked about inclusion diversity we are taking in a conscious efforts me and Hitachi in general to say and you can see now whatever your definition of diversity is this is my new team right now interns we are hoping to hire them from January 2020 again they also contributed to I read that street sign and numberplate by now and the previous slide was about the face alright so that really brings to the last slide if you have anything in private please use my gmail I live in Washington DC metro area one mile from Washington los Airport if you have anything official to talk with you know that's my official email address happy to give you name cards as well later on okay with that said I think I right on time floor is open to questions [Applause] you 