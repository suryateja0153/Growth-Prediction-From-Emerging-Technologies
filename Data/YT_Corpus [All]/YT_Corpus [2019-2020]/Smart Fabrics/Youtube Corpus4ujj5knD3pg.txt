 [Music] hello everyone welcome to the next lecture of our blockchains course so in this lecture we are actually going to go much more deeper into high pillager fabric itself looking at some of the Identity Management and membership aspects of hyper nature fabric so this is going to be delving into some of the primitives that hyperedge of fabric uses for some of the security and privacy properties that we want to achieve for our enterprise applications getting into the details now so first of all I think an important notion to understand is the notion of organization in the enterprise world you can think of these organizations as legal entities say they all have a business that they are running and we can recognize these organizations with identities that they are provided on the blockchain network so each organization for instance said it will have our membership service provider for the identities for the users belonging to that organization so we have users of that organization the organization can also define a set of administrator's so these administrators will be the ones who are running peers maybe the ones who are helping these peers join the channel they might be installing chain code on behalf of these peers or they might also be executing authoring services so what are the different components so you have administrators and users and the organization could be running one or more peers in the network some might be endorsing peers some might be only committing peers and optionally they can also run ordering notes for one or more channel so each organization can participate in one or most channels in the in the block chain network and all that information is captured in the network itself so each channel configuration in the Genesis block or in subsequent blocks button gets modified the organization information is also captured there the network can include of course many organizations and it could be a consortium okay so I couldn't let's say a group of ten banks might form a consortium and each Bank can be represented as an organization on the network so this is a boundary that we define in two of identity and these identities of these organizations are separated out using the membership service provider so typically there will be one membership service provider but organization but although it's possible to have one MSP serving multiple organizations and it's also possible for one organization to have multiple msps those are possible with the recommended use is to have 1 MSV per organization and like I mentioned you each organization is going to have an ID on the blockchain so here's an example of a consortium network there are three organizations in this consortium organization 1 & 3 are the ones that are running peers organization 2 provides only the ordering service in this example so organization 1 is running to peers he's shown here organization 3 is also running to peers each of these organizations have their admins and one or more users likewise AAG 3 also has this as the same and there are chain cords smart contracts deployed on the channel so in this network there are actually two channels the blue and the red and there are chain codes that are deployed on both the channels so a and B on the blue Network and Y&Z on the red network both of them are using the same ordering service that or two is running and there are two has an administrator who is in charge of running this ordering service and the ordering service is going to maintain two chains of blocks one blockchain is going to be for the blue channel one for the red Channel and the transactions on these two as I mentioned are going to be kept separate so going to the membership service provider what that means is there is a distributed network with a set of identities and there are identities that are provided for every concept or entity in the network so there are identities for peers there are identities for the orders so the ordering services here and the PR is here each of them are issued identities they will use these identities to communicate with each other there are client applications and we can we provide our identities to the client applications also so there could be a pure for the PR there will be an admin for the order there'll be an admin so that bunch of administrators who are managing this network themselves and those administrators have identities and these identities are issued by some certificate authority so this can be the fabric certificate authority that are that is issuing these identities or it could be an external certificate authority that is issuing these identities so as long as the the root CA is recognized by the network you can bring in any certificate authority of your choice now what are the benefits of having all of these identities network sort of properties are we providing of course there is authentication so every time a user transacts on the blockchain they are authenticating themselves by signing the transaction and this sign is verified by the pier or any other entity on the in the network so the PR is going to Bala date this signature provided by the user so that's the validation part so if you are not a registered user on the network you cannot perform transactions or you cannot see what the blockchain state is you cannot read that set of channels you can't see what channels are available so none of that information will be available to you you have to be authenticated on the network to transact on the network it also has the ability for you to sign information for instance the user will sign transactions send it to the pier the PR will execute the transaction and when it endorses it is actually going to sign the endorsement likewise the ordering service when it creates a block and sends it to the piers the each block is going to be signed by the ordering service so you can validate that all of this is coming from the authorized entity to perform that thing so if someone else they say one of the PRS tries to maliciously sign a block and send it all the other peers will know that this was did not come from the ordering service it came from somebody else so it will reject that message so signing and issuance are all possible because of the security framework that we have through the membership service provider those MSP can support different crypto standards this is meant as a pluggable interface and the main reason for this is that different applications might need different security properties that might be provided by different ca's difference crypto standards so all of that becomes pluggable and it's also the fact that security itself as a domain as a field of knowledge has been flowing so rapidly that over a few years you might find better security standards better ways of securing our systems and we want to be able to to allows that and so all of these are provided as pluggable features and a network can have multiple MS fees like I mentioned we want to the recommended way is to have one MSP per organization so based on the number of organizations you have you might have that many MSPs in the network and there is also TLS which is transport layer security and this is used for encrypting all the communications across the network so the peers amongst themselves when they communicate peers to order communication user to the peer communication between peers and chain codes that they're on that communication all of it is secured through TLS so what is really this TLS it's a cryptographic protocol it's actually a standard that secures all communications over a computer network so it provides two important properties it provides the notion of privacy and the notion of data integrity so what do we mean by privacy is that only a certain set of nodes or certain set of people should be able to see what that communication is so that's the notion of privacy the data integrity is when a node sends communication to another node the recipient should get the same data as was sent by the sender okay so that data should not get changed or over the course of the communication so that's the data integrity so how is this achieved Els uses symmetric cryptography to encrypt the data that is transmitted so because of this encryption no one who anyone who does not have this key will not be able to decrypt this message and will not be able to know what this communication was about so that provides privacy so only the participants who hold the key typically it's just two entities a sending a message to be that communication is encrypted and because of the fact that only a and B have this key only they will know what the contents of this communication are hundreds of this communication is so that's the privacy part of it and it uses publicly cryptography to authenticate the identities of the communicating parties so this again this provides a part of the data integrity to say that only E is sending this message and B can can verify the fact that it was actually a that sent it and that is achieved use it using public key crypto cryptography and there are message integrity checks that are included to prevent laws or alteration of the data so let's say the communication between a and B there might be packet loss there might be an attacker trying to manipulate this message in the middle in the network so to prevent all of that there is a message integrity check so think of it as the equivalent of like a hash or a checksum so you can check that the message that you received was exactly what the message that was sent so that's the message integrity is check and all of this together forms the protocol itself and every communication in fabric between client and pure between pure and pure we are an order between orders themselves all of this is secured using TLS so it provides this privacy and data integrity for all communications so getting a little more into what these identities are so I told you that every user in the network is going to be issued an identity an enrollment certificate right the enrollment certificate has two paths one is it has a private key and this private key has to be private to that user nobody else should know what that private key is and the user will be using that private key to digitally sign transactions they are submitting onto the network so that's the private key and it's it's stored in a secure key store the second part of the identity is a sign cert which is a public x.509 certificate in in the fabric implementation but like I mentioned other crypto standards can also be used this public certificate will include is your public key so everyone will know though using this bubbly okay they'll be able to validate whether it was indeed this user who signed that transaction so the public key is used to for that validation and it also includes certain attributes that the certificate authority might provide to the user for instance some of the attributes might be to say that this user let's say for me I let's say I have a digital certificate my public certificate will include the fact that maybe I belong to a organization IBM Research it might have other attributes saying I'm actually a researcher and it might have certain authorizations certain roles that I have on the network for instance if this is a supply chain blockchain network then it might even have a rule that says I am an exporter in this network so those sorts of attributes can also be embedded within this certificate and we can use those attributes to authorize transactions on the network so the smart contract can include aspects saying only a user who is an exporter who has an attribute called exporter will be allowed to perform this transaction so anyone else they'd say someone else who is let's say a carrier or a freight forwarder in this network will not be able to perform that particular transaction like invoking that particular spot contract function so all those capabilities are then possible through attributes embedded in your embedded in your certificate and it also optionally includes your TLS certificates credentials and that is important for let's say the pure when it's for the pure identity the pure needs a TLS credential for it to be communicating with other peers and auditors in the network and all of this can be backed by a hardware security module where these keys are are securely stored and the hsm can be used to to Mb it's a hardware model and that can be used to assign transactions without anyone else any other component in your system getting access to the private keys okay so that's the user identity itself the admin identity is very similar in concept to the user identity and every each administrator has a local MSP to store their identity so every admin is connected to a to a local MSP and just as the user identity it has a private key that is stored in a key store and it has a public x.509 certificate that that forms its sign circle and again it could have TLS credentials and it could be using a hardware security module to store and unsigned transaction so what do the PR and I order identities look like again it's similar it has a private key and a public x.509 certificate it has a local MSP attached to the pier which holds these identities and in addition the PR and msps can identify authorized administrators so it could have one or more administrators for this pier and the admin certs are also included so for instance an organization who is running the pier can designate one of its users as an administrator and that administrator will be included in the admin certs and there are specific functions that only the administrator can can do for instance joining appear to a particular channel can only be performed by that administrator user if a regular user who is not an administrator tries to perform that transaction it will be denied by the network and the admin apart from that it can also store the public certificates of CES that it will recognize so this is needed to recognize a a user is the user certificate was issued by a certificate authority a particular certificate authority then that user certificate is actually signed by the C so we need the public certificate of that CA to be able to validate users who are connecting to this pier so that's part of the csr and there are also certification revoke patient lists so these are CR ELLs and these revocation is important to over a period of time manage which are legitimate users which are not and even for a legitimate user it is advisable to change your certificates every now and then for security purposes so maybe you hold your certificate for a certain length of time and then you will revoke that certificate and have a new certificate issued for the same user right for security purposes it's advisable to rotate your certificates so you can have certification to vocation lists to say which certificates have been revoked and should no longer be admissible on the blockchain Pia's and orders also receive the channel MSP information since the channel also has a MSP the Piazza orders will know which channels they are connected to so that is also happening through the MSP in a secure manner again the PRN ordered identities can be backed by a HSM now what does the channel MSP look like so like I mentioned every concept in blocked in the high polish of fabric is associated with an MSP so the channel MSP has information about which peers and which orders can join that channel and this can be dynamic so it's possible that some peers join the channel at a later point of time other peers might leave the channel all that is dynamically configured in the channel MSP and the channel MSP is also variable so a new pair joining the channel can query the channel MSP to find out which other peers are participating in this channel it also determines which client applications can connect to this channel and can perform transactions on this channel it also stores all the configuration blocks in the ledger so like I mentioned any new PS joining the channel any orders joining the channel are all configured as transactions on the blockchain and if the channel MSP stores that information as well what is the latest channel configuration will be part of it the channel imp is MSP also ignore includes administrators so who are the administrators for this channel for instance it could be multiple organizations administrators who are recognized as administrators for a channel so they might determine when to admit a new PR and other changes in the channel configuration of course there is again the certificate authorities who are recognized by this channel for authenticating the identities they are all signed by the CA so you need the CAS public certificate for validating that and again you could have certification to vocation lists like before so it's an important thing here is that it does not include any private keys for identity so this channel information is all public information of who can who are the administrators who are the CS what are the peers and authors as part of this channel it does not have any private information so how does a new user enrollment work registration and enrollment so let's say I am a new user on this network so I have a I'm part of some organization so there is a I need to talk to some admin maybe my organization is already part of this network they have an administrator and that administrator has has to first the administrator has to register so their first the administrator register when you are creating when the pur joins the network itself the administrator has to be registered and subsequently it will only be the administrator who can register new users from that organization the the administrator calls the register function it will with a particular identity and he'll say I want to register this new user with this blockchain so it contacts the CA and the CA returns a particular secret so then the administrator sends this enrollment ID and the secret to the user so this forms the identity the long-term identity that the user will be using to transact on the blockchain once it has received these credentials so the secret also includes the certificate that they need to use once they have received these credentials they will then use that secret to enroll with the fabric CA and that returns the enrollment certificate for them so that will be the long time long long term certificate that the user will use to transact on the blockchain to just recap administrator has to register the user the administrator then sends the enrollment ID and secret to the user the user then contacts the CA with that enroll ID and secret to obtain an enrollment certificate and you can then use that enrollment certificate for transacting on the blockchain so now once you have got the enrollment certificate you can use that for transaction signing all the transactions have betted on the blockchain have to be signed by permissioned users on the network and those signatures are validated users sign transactions with their private key that is that private key will be part of the local MSP of the client the pr will have the public key and they'll be able to validate the the signature so the user is going to sign the proposal and the peer will sign the response and will validate the signature and it will sign the response that is the three here so the user signed the proposal submitted to the pure pure executed before executing the transaction it's going to validate the client signature and when it creates response to be sent to the client application it's going to sign the response with the Pierce private key so then the client application can validate the peer signature to make sure the legitimate peer has signed this it will then sign the entire endorsed transaction it might do this from with multiple peers you will collect all the signatures and it will then sign the transaction to be sent to the ordering service the ordering service will validate the client signature again and it is going to when it sends the block to the peer it is going to sign the block that is the seven sure the PR can again verify that it was indeed the order that signed and sent the block to the pure and it will validate that order a signature and only then it will valid validate the transactions and commit the transaction so at every step every communication you will see that there is a signature and a validation performed on the blockchain so this provides for secure communication across all the entities in the blockchain network with that I hope you have a good sense of how the membership service provider works how the security secure communications work how signing of transactions and verification of transactions work across the network so there's a good set of reading material again I hope you go through some of these if you have not seen transport layer security before I would encourage you to read the Wikipedia article it gives you a good overview this is our standard practice in the internet today and for any kind of secure communications so I would encourage you to read that so even beyond just knowing about blockchain will help you learn some of these concepts again the concept of digital identity is something much beyond just blockchain it's used in multiple systems today so you can read up again from Wikipedia there's a very good articles on what digital identity is using the digital identity you can have digital signatures again an excellent Wikipedia articles on that I would encourage you to read that for sure and a specific implementation of these identities and signatures is the x.509 standard for certificates and again there's this good reading material on that so with that I hope you get a good overview of how we've use traditional security concepts although I say traditional they are the most cutting-edge technology that we haven't we have today for security and how that is used to secure communication and transactions on hyppolit republic so thanks a lot for your time so we will see you in the next lecture [Music] 