 Hi, welcome, this is a Clemens at Elektor. Like many people I buy all sorts of things online and in many cases I have to use my credit card to pay for these. Since you cannot enter your PIN code in this kind of transaction, you have to enter often the three-digit code that's printed on the back of your card. This code has several names like Card Security Code or CSC or Card  Verification Value or CVV. The security of these so-called Card-Not-Present or CNP transactions relies on the principle that the payment gateway is not allowed to store the CVV code. Because this is not a super-secure way of doing things, my bank offered me a credit card with a so-called dynamic CVV code or iCVV, a code that changes about every hour. The dynamic CVV code on a Visa card is called CVV2 and is based on "motion code" technology developed by idemia. On their website I found some specifications of the card. It is based on a three-digit e-ink display that is a refreshed every hour or less. A real-time clock is also included. The circuit is powered from a dry battery that is supposed to last three years The card complies to the ISO standards ISO7816 which is about smart cards and ISO15693 which is the ISO standard for vicinity cards that operate at 13.56 MHz, commonly referred to as RFID and NFC. Now besides the improved security, the main advantage of a dynamic CVV code is that it's 100% compatible with existing systems and with the users' habits. The way dynamic CVV works is simple. The card produces codes based on its number, its Primary Account Number or PAN, its expiry date and the actual time and date. It then sends this data to a server and the server does the same calculations, and when the two codes they came up with match, the transaction may be approved. How exactly the card produces the code is not specified, of course, but we may assume that there is some microcontroller inside and it's not based on a list of precalculated codes somewhere in memory. Over a 3-year lifetime, and based on a frequency of one per hour, some 30,000 codes would be needed. My first credit card with dynamic CVV expired a few months ago and so I decided to try to disassemble it to see what is inside. The card is only one millimetre thick, which is not a lot, and I was quite curious to find out what they managed to put into it. According to the internet, credit cards dissolve in acetone so I gave that a try. Because I was afraid that the acetone might destroy the ePaper display, I proceeded in steps, immersing only parts of the card around it. As it turned out, only about 20 minutes are needed to dissolve the card. I needed more time because I tried to document the process and wanted to avoid too much damage, but after two and a half hours I had extracted the complete circuitry. To my surprise I ended up with two independent circuits: the card's contacts with a wire antenna attached to it and a flexible PCB with display and battery. I expected the battery to be connected to the card's connector so that it could be recharged every time it was put in the reader, but this is not the case. Another surprise was to discover a loop antenna on the dynamic CVV circuit. Apparently non-contact communication is used to prepare the card; no need to stick it into a programmer or reader/writer or something. With an NFC reader app on a mobile phone I obtained the tag ID 7f 6e 83 8f a1 58 02 e0. Inspecting the flex PCB we see that the PCB antenna is connected to the little IC on the left so that will probably be the NFC tag. In the middle of the board there seems to be an oscillator with a second IC next to it. This might very well be the real-time clock. On the oscillator I could decipher the text 'A611L'. The number of pins on the IC and all the parts surrounding it, make me suspect that it's more than just an RTC. Maybe it's a unique ID chip or even a crypto chip. Right under the e-ink display is a biggish IC which is very probably the main microcontroller. It is surrounded by what looks like capacitors and it drives a display, and is connected to the two other ICs. Not counting its packaging, the battery measures about 15 by 15 millimeters and is half a millimeter thick. This corresponds to a volume of a little bit more than 1/10 of a milliliter. If my estimations are correct and based on a volumetric energy density of say 270 Wh/l, this would correspond to something like a 3 V 10 mAh lithium battery. Maybe this is too pessimistic but it gives us a ballpark figure. This boils down to a power budget of about 1 microwatt per hour for a three-year lifetime and a 1-hour refresh rate. In other words, per hour one microwatt is available for calculating and displaying a new CVV code, and keeping the real-time clock running. The next step would be to decap the ICs that are on the flexible PCB to see what is inside, but that is beyond my capabilities and I don't have the tools for that either. I will leave that to the professional hacker. The other circuit in the card is the contact and non-contact payment bit which consists of a smart card connector with an IC on the backside and around 60 cm of copper wire attached to it. It got unfolded in the disassembly process but it started out as a coil with three turns around the edges of the credit card. The IC on the backside looks naked but without a good microscope I can't see what is there and so I'll leave that to the better equipped hacker as well. Okay, that's it. Summarizing: after dipping my Visa credit card with dynamic CVV2 code into acetone I managed to extract two circuits from it: a smart card connector with a wire antenna attached to it, and a flexible PCB with an e-ink display and the battery. On the flexible PCB we found an NFC tag and real-time clock and the microcontroller. It is quite amazing how much electronics they manage to squeeze inside a one millimeter thick card, and there exist credit cards that are much more complicated. Excuse me. Sorry, what was that? [you haven't done the beep] Ah, the beep, I forgot to do the beep. Okay, that's it. I hope you found it interesting. Please subscribe to our newsletter and to our YouTube channel, and for a special offer, check the description below. 