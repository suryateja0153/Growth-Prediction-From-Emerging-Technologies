 Hi everyone, Grant for the Flame Learning Channel. With the Flame 2020.1 update… Another type of machine learning… has been introduced into the Flame products. So in part 4 of the Machine Learning Series… You’ll learn how to extract the sky out of a shot. So Flame can look at an image… And using Machine Learning… Identify what parts of that image make up the sky. You can then use that extraction… as part of a selective or composite. For example, you may want to grade the sky… Or perhaps even do a sky replacement. We’ll run through two examples… And discuss some of the finer details… as the video progresses. If you would like to follow along… Please download the media via the YouTube description… Or use the link that is currently displayed. So take the first clip of the sign… And open it as a sequence. Select the segment… And switch to the Effects Environment. To illustrate the sky extraction… You can use a 2-up view… With the manager on the left… And the result view on the right. Now the sky extraction workflow… will be the same in the Timeline… Batch and BatchFX. So the first step is to select your selective in the manager. Now even though Flame uses similar analysis techniques… for z-depth and normals extraction… You are not generating 3D data in this instance. The sky extraction is more of a keying function… As opposed to a 3D AOV. With that said, in the Keyer section of the Selective… You can now change the type from Diamond to Semantic. This enables a contextual Analysis using Machine Learning. The analysis is set to SKY… And all you need to do… Is press ACTIVE. Since the outcome is segmentation by contextual identification… The Selective is performing this operation within the keying tools… Therefore no additional objects or maps… are added to the Selective Object in the manager. However you will note that the selective object shows the matte in the thumbnail. To see the Selective Matte in the viewer… hover over the result viewer… And press F9 for the Selective viewer. So this matte has been generated through Machine Learning. This is not the same as keying the colour or luminance of the image. Looking at the original image with F1… You can see that the sky is overcast… And there is no evenness to the colour or luminance. So returning to the Selective viewer with F9… The sky was identified… And extracted from the shot. Now the only adjustments you have… Is the Threshold… And the Region of Interest for the analysis. The threshold allows to you increase or decrease… The amount of black and white within the semi-transparent areas. This can help with achieving a cleaner isolation… However finer details such as trees, leaves and wires… May cause a bit of an issue. Similar to the other generators… You need to try it with different shots… And you’ll identify how this could fit into your workflows. As a tip… You can toggle F9 again… And the selective viewer will switch to the selective input… Which displays the isolation as a coloured overlay. All the Selective controls will still work in this view… And you can also shrink, dilate… and blur the output of the selective as a post process. Once you have created your sky isolation… You can switch back to the result view with F4… And apply any SelectiveFX to the sky. So using the MasterGrade… You can play with the lift, gamma and offset… And tint the sky to make it warmer. When you scrub the time-bar… You can see that the sky-analysis has been generated for each frame. So that’s how to use sky extraction with Machine Learning. Now let’s look at the second example… of performing a simple sky replacement. I would recommend doing this in BatchFX or Batch. Return to the Timeline view… And press ESCAPE or swipe the edge of the screen… to display the Reels. Select the “Beach” clip… And open it as a sequence. Select the segment… And using the FX button… Create a BatchFX… And make some room between the nodes. Now you can access the Sky Extraction Machine Learning… In an Image or Action node… But it is also available as a Matchbox node… Which will simply produce a matte. So drag out a Matchbox node from the Batch node bin… And drop it into the flowgraph by holding SHIFT. In the browser, locate the “ML_SKY_EXTRACTION” shader. When you select the node and press F4 for result view… The AI automatically detects the sky… And extracts this matte. You can toggle between F1 and F4 to see the before and after. Now the only other controls to adjust is the Threshold. This will allow for a small amount of adjustment in the finer details. Finally, this matte will be used to composite the foreground of the beach… On top of the sky replacement. So click the INVERT button… And this will give you the final matte. Now go back to the BatchFX schematic… And using the DESK node… import the “sky” clip from the reels. Now you’ll perform an A over B composite… But you could also do this in the Action 3D compositor… For more complex workflows. The outcome will be the same in this case. Drag out a Comp node from the node bin. Connect the beach clip into the RED input… And the output of the Matchbox node into the first BLUE input. Next, connect the “Sky” clip into the GREEN background input. Finally, connect the output of the Comp node… into the BFX output node. Select the Comp node… And press F4 for the Result view. So that is the workflow to extract the sky isolation as a matte… And perform a very basic composite with a sky replacement. As mentioned in all machine learning videos… The results you get… are based on how the AI model is trained… And hopefully this will keep improving… in future releases of the Flame products. There might be a bit of extra work required to get it perfect… But the majority of the extraction has been taken care of by the generator. Don’t forget to check out the other features, workflows... And enhancements to the Flame 2020.1 update. Comments, feedback and suggestions are always welcome and appreciated. Please subscribe to the Flame Learning Channel for future videos... And thanks for watching. 