 [Music] [Music] factors and perfect matching in general graphs recap of previous lecture we have discussed stable matching Gale and Shapley algorithm and faster bipartite matching that is given by half cropped curve algorithm content of this lecture this lecture we will discuss factors and perfect matching in in journal graph that's one factor theorem and a factor of the graph factor a factor of a graph is a spanning sub graph of G soak a factor is a spanning K regular sub graph of G another definition of an odd component an odd component of a graph is the component of odd order so the number of odd components of H is of the order H let us take an example if let us say this is a graph having two components then this particular component is an odd component Y because it is having a odd order of this particular vertices in this component and this particular component having two vertices this is even so how many odd components are present here in this particular graph this is the odd component which is present that is only one similarly in this particular example see what is a one factor of a graph G so let us see that this particular graph which is given we want to find out a spanning sub graph so this is spanning sub graph will include all the vertices that is all four vertices if it is a one factor that means each particular vertex should be having only degree of one so if you include the degree of one so this will be the sub graph of G and hence it will be called one factor so if you recall this one factor is nothing but a matching in this particular graph similarly another graph let us take G 2 in this particular graph if you want to find out the 3 factor of this particular graph so 3 factor means we want to find out a spanning sub graph so spanning sub graph will include all the vertices present in the original graph and so we are going to find out this particular spanning sub graph which is basically a three regular that is called three factor so three regular means all the vertices are having three edges out of five so it can pick any three of them so three vertices three edges are present similarly this vertex will have its degree three will have its degree three and so on so this becomes a 3 regular spanning sub graph so three regular spanning sub graph of G is nothing but called as a three factor similarly we can extend it and we can generalize it to K factor so when we say one factor then we mean that we are talking about a perfect matching matching in the graph let us go and see the clarification so a perfect matching that is also we are referring it to as one factor a collection of edges such that every vertex is incident with exactly one edge so in this particular example this is the perfect matching is a collection of these particular edges so that every vertex is incident with only one edge so that becomes a perfect matching and if you take one factor that also comes out to be the same same thing so one factor and perfect matching are almost the same thing the precise distinction is that one factor is a spanning one regular sub graph of G while perfect matching is the set of edges in such a sub graph so there are two different definitions but they mean to the same thing so three regular graph that has a perfect matching decomposes it into one factor and two factor now we will see the touchstone factor theorem so what is that condition in which we can find out perfect matching in the graph whether perfect matching in the graph exists that are and then we can also say that whether one factor exists in a graph which is nothing but a perfect matching so this particular question can be verified using the turtle 1 factor theorem so some of the references also call it as a touch perfect matching theorem so either we can call it as 1 factor theorem or a perfect matching theorem meaning thereby these particular things are same so that found that the necessary condition for having one factor or a perfect matching in a general graph so which says that if G has one factor then for every subset of this vertex at the number of odd components if you remove this s subset from the graph will have the vertices equal to that particular size of s so we can basically denote it by this particular condition so so that means the number of odd components if in G minus s will be at most the size of s for every subset s of vertices of G take the example for example we can see this particular graph which is having a perfect matching let us see this particular edge will saturate these two vertices this particular edge of the graph will saturate these two vertices this edge will saturate so one factor or perfect matching is shown by the green edges so this particular graph has the perfect matching now let us see whether we can see through this particular condition that is can be proved it by the cuts condition so let us take that these two edges belong to s this is subset of vertices these two vertices so the size of s is 2 here in this case the remaining portion when it is removed this becomes one component having four different vertices so the parity of this component is even so how many odd components will be there in G minus s 0 so 0 is less than 2 hence this particular condition holds and this condition holds we have also already seen that it has a perfect matching or a 1 factor so hence this particular necessary condition which is stated by cut for one factor in a graph he has also proved it to be a sufficient condition that we are going to see the proof sketch now before we go ahead we see that I what an observation let us say that if this is the graph and this is the set s so if it is removed from the graph it will be in the form of the components so some components are basically having even parity let us say the other components are having an odd parity now the components having odd parity will have at least one vertices present which has an edge and that particular edge will incident on a vertex of s in a distinct vertex similarly another component which is an odd parity will also incident on a vertex of s in a distinct vertices similarly here also it may have more than one also so at least one such component exists so that means one vertex from every odd component will go and will basically have an edge which will basically incident on a so the size of s will have these many number of components that is why the number of odd components in after removing S will have at least that many number of or s number of elements present why because for every component there will be one element plus some more element can be there in S so at least that many number of so let us see the condition where it will violate so the condition where it will violate we have to see in the further examples so let us see that the same thing is stated over here that if G has a 1 factor then we consider a set s which is a subset of the vertices of G then every odd component of G minus s has a vertex matched to something outside it and which is nothing but that belongs to set s since these vertices of s must be distinct therefore this particular order the number of odd components of G minus s will be bounded by the number of components present in this particular s this particular condition which called touch condition and this particular necessary condition is also sufficient that is being proved here in the touch theorem this particular example I have already stated so let us skip it and look into the proof of touch theorem so necessary condition we have already told you that if the graph has the one factor that means the number of odd components will have the vertices which will go into s so the size of s will be at least the number of odd components hence this particular necessary condition is proved now let us go for looking up a more detailed sufficient condition so if let us say that insufficient condition if the number of odd component or this particular property exists then we have to prove that it has the one factor now we will prove it by contradiction let us see from where we at what point we have to basically start our contradiction to prove the sufficiency condition of this particular theorem now when we add an edge joining any two component so for example these are the components let us say they are the odd components and these are the components which are called even components and this is s now when we add an edge joining any two components of G minus s so if you remove s so there will be R distinct components so if we add an edge within one component of an odd parity the parity of this particular component is not going to change if we add an edge this particular parity is not going to change similarly if we add an edge across two odd components so odd and odd will become even so number of odd components will not increase similarly here if two even components are basically joined by an edge so it will become a bigger component of but even so in any case when at when an edge is added so the number of our components will not increase so that I have already explained so the test condition is preserved by adding of the edges let us assume that an edge II is added sufficiently into the graph and we obtain a G Prime graph then that particular condition that is the odd vertices in the new graph G minus s will be having that particular same value that is the number of our components is basically this particular equation or this particular property is not affected so that is basically sure so if we add an edge and we see that if particular graph G prime has no factor then the original graph also has no factor that means the addition of the edges into a particular graph it will not basically make that graph a perfect matching therefore this particular theorem holds unless there exists a simple graph G such that G satisfy status condition now G has no one factor and adding any missing edge in G will yield a graph a one factor so let G be such a graph and we obtain a contradiction by showing that G actually does contain one factor so what we are going to prove in the sufficiency condition is that if a graph is given G and if we add sufficient number of edges we form a G Prime a new graph so if G Prime do not have the 1 factor then by adding this particular edge into G so G also should not have the 1 factor that we have seen but we differ from here and this will be our contradiction so our contradiction will assume that in the graph G if we add an edge we will make another graph G Prime and this we will show that we will assume that this particular G Prime will have the 1 factor and the contradiction to this contradiction contradicting this particular statement will prove that the sufficiency condition and hence this particular graph satisfying this particular property will have one factor that is what we are going to prove so let us prove that by adding this particular edge the graph original graph G is not having the 1 factor and thus it is going to do the contradiction so case 1 so let us assume that u be a set of vertices in graph G that have the degree N minus 1 that means in a graph we will find out let us take this particular example of a graph this particular graph has two vertices this particular vertex 1 and vertex 2 its degree is n minus 1 that means total value of n is 4 so three are present here three are present here so it is basically n minus one and this is also n minus one so we are collecting up such vertices and let call it as u so this also will be part of you these vertices will be part of u other vertices are not in a part of you so let us see the case one the vertices in each component of G minus u so if you remove you from the G we will have these set of vertices so the vertices in each component of G minus u can be paired in any way with one extra in the odd component meaning to say that when we remove you from the graph it will be in the different components the components having the odd parity we will find out a vertex and try to match a particular vertex in u that we have earlier also stated the the leftover vertices of you here the leftover vertices for example every other vertex of you will be having a matching in that odd component this is even component so there is no such overt X present here in you now the vertices which are left over in u that means the number of odd components is always less than s here we call it as u since number of components are more that means the number of odd vertices it will match and then the remaining ones it is talking about the remaining ones the difference and they can be paired with each other so the remaining vertices are in U which is a clique so you see that that is why these cliques are there so if it is two vertices then there will be a one factor to complete one factor we need only show that an even number of vertices remains in you so these set of vertices which remains is basically an even number so even number can be included in the one factor so we have matched an even number so it is a Pfizer's to show that ng is even this follows by invoking the touch condition for s is equal to mt since the graph of odd order would have the component of odd other now let us see the case when G minus U is not the distinct union of cliques so the previous condition says that G minus U is a distinct complete graph that is the cliques and we have done this particular one perfect matching now if these distinct vertices in u G minus u is not disjoint union of so what will happen then in that case so in case two in this case G minus u has the two vertices so G minus u so is you and so this becomes G minus u these are the components has two vortices at a distance - these are non-adjacent vertices X and Z and a common neighbor Y and Y is not in you so if it is not in you then it must be in some component so G and X and Z they are not basically having a direct edge and they are connected through let us say they have a common neighbor Y and this Y is not in you furthermore G minus u has another vertex W not adjacent to Y since Y is not in you so we now are getting X Z which is not directly connected why is there and W is also there so Y is not in you outside you now by the choice of G adding an edge to G will create a one factor let m1 and m2 be the one factor of G Plus X Z so X Z they are not directly connected so we hypothetically we are placing an edge and we call it as X Z since x and z they are not directly connected so we are placing a hypothetical edge imaginary edge similarly we are also adding Y W this also a hypothetical as we are adding up these two edges we have added so which is shown over here let us say this edge is hypothetically added and this edge is hypothetically added into G so it suffices to show that mm1 is a matching m1 is one factor and m2 is one factor Union these two edges will contain one factor and we can avoid X Z and Y W because this will be one factor in the G so let us see when we take the symmetric difference of two matchings are symmetric difference of to one factor you know that it will become a graph with the vertex degrees either 0 or 2 2 means it is a cycle so this particular cycle M 1 followed by M 2 m 1 followed by M 2 followed by M 1 followed by M 2 M 1 M 2 M 1 and M 2 so this becomes basically a cycle now the question is we have added these two hypothetical edges now if we can show that this particular cycle still we can get without these edges then this cycle will be the sufficient to show that it is having the one factor in the graph so let us assume that we can still get a cycle that means if we start from somehow reach to Y and Y if we reach to Z from Z to Y and then we can take around and when we reach to X we can come back again and take around and so on so either we can avoid XZ or we can avoid Y W in this particular way so when we read X then basically we can reach to Z also and so on so in this way we have obtained a cycle without even these hypothetical edges that we are going to see so here we have shown that we have produced a one factor of this particular cycle see including X Y and Y Z that does not use X Z or Y W so combined with m1 and m2 outside this particular cycle we have one factor we have obtained a one factor and we are using these edges but we are not using these two edges so still we can complete a cycle so let me again state this if C contains C means the cycle if cycle contains both YW + XZ as shown below it is containing at this particular present then to avoid them we use Y X or Y Z any of these two so in the portion of the C starting from Y along Y W we use the edges of m12 a white YW when we reach X Z at this end when we reach X Z we use Z Y to arrive at Z as shown otherwise we can use X Y so in the remainder of that particular cycle see we use the edges of m2 so we have produced that means if we look this part so if you are you removing m2 then basically we are basically using this particular edge and if we are removing m1 then we are using this edge still we can complete the cycle without them so we have produced a one factor of C plus XY plus y Z that does not use X Z or Y W so instead of X Z and Y W we are using X Y and Y Z so combined with m1 and m2 outside we have got we can achieve the one factor of a particular graph so that means by adding an edge if the original graph does not contain one factor but we have reached to a contradiction which is shown that it is having one factor thereby we are contradicting the original hypothesis this contradiction of a contradiction will prove that the sufficiency condition is satisfied of the touch condition remarks like other characterization algorithms this algorithm will yield the short verification both when the property holds and when it doesn't so we have shown when the property holds there exists a one factor we will show when the property hold still that particular characterization is valid to prove that G has one factor by exhibiting one when it doesn't then we have to find out a subset of s that if we remove it will leave too many odd components hence it will violate the touch condition and hence we can state that the graph does not have one factor furthermore for any graph G if you take a subset s of vertices and counting the vertices modulo two will show that the cardinality of s plus the number of odd component has the same parity as n if we take the difference then also it has has the same parity as n so we conclude that if n is even and G has no one factor then the number of odd components exceed by s or component exceeds s by at least two for some s so in this way there is no one factor then we can also estimate about the size of the maximum matching by taking this particular difference so again we are going to give another definition of a join of two simple graphs G and H which is written as G join H is the graph which is obtained by the disjoint union of g plus h by adding the edges to both X edges X Y such that X belongs to a particular vertex in G and y belongs to particular vertex in H so for all such vertices of G there will be an edge to the vertices of H similarly for every vertex of H will have an edge to the vertices of G so that gives so let us take this particular example so if you are given K 3 and another graph is given P 4 so K 3 join P 4 we'll look like this this particular vortex will have the edge to all other vertices this also will have the vertices to all other vertices this also has the same thing and this basically will result into this particular graph that is the join of two simple graph is a graph that is shown over here now there is a corollary given by birch cut formula so that corollary says that the largest number of vertices saturated by a matching in G is the minimum of the subsets of vertices such that n minus D s where D s is the number of odd components in G minus s minus the cardinality of s itself that I have earlier explained but let us take an example and show that so you know that this particular graph is not having the perfect matching so we have to find out the largest number of vertices which can be saturated by a matching in G so we are going to take s let us say this is s so the cardinality of s is 2 and the number of odd component this is 1 so the DS if we compute this will be 2 minus 1 and 1 and if we plug in this particular DS value so the total number of vertices is 5 5 minus 1 this comes out to be 4 that means 4 is basically the number of vertices which are the large this is the largest in size which can be saturated by any given matching let us see since this particular graph is not having one factor so we have to find out that particular matching which will saturate the largest number of vertices this is vertex number 1 2 3 & 4 and here using this particular formula also we have computed that for vertices this is the largest value of these vertices are being saturated by the matching so this particular formula can be utilized if the graph does not have one factor then it can identify how many what is basically the maximum or the largest number of vertices which can be saturated by either matching now there is another corollary which says that every 3 regular graph with no cut edge has one factor so let us take this particular graph so this particular graph is a 3 regular graph 3 regular means every vertex or every node has the III now this particular graph is not having any cut edge so that means if you remove this edge the entire graph is having one component so there is no cut edge present so this particular graph has a matching a one factor and this particular one factor is shown over here this is one such matching this particular edge will have another matching this edge will have another matching and this particular matching so this particular graph has one factor now another important graph is called a Peterson graph so Peterson graph is also three regular graph that means all the vertices having the degree three this also has a one factor so if we include these edges as a part of the matching then you can see all the vertices of this particular graph is saturated and this condition is called perfect matching or a one factor so this is a three regular graft and this is important the name of this graph is Peterson graph so Peterson graph has a 1 factor now then there is a theorem which says that every regular graph with positive even degrees has to factor so let us consider this pentagon k5 it is also called so this is a regular graph with a positive even degrees so the degree is 1 2 3 4 so all the vertices are having degree 4 it is a 4 regular graph now this for regular graph has the 2 factor what is to factor to factor is a spanning sub graph with the degrees equal to 2 so let us see in this particular already shown about the two factor so let us start from vertex number 1 we can reach over text number 2 from 2 we can reach to 5 from 5 we can reach to 4 from 4 we can reach to 3 from 3 we can reach 2 to 1 similarly we can also identify this is to factor another 2 factor also we can identify let us begin from we can reach to 2 you can reach to 4 3 2 1 10 raise to 5 10 raise to 2 3 back again so this is another 2 factor so this is this particular graph has two disjoint two factors present in the graph so it has also one factor so that means one factor plus two factors also you can identify and that is shown here this particular graph so again I am repeating the theorem that every regular graph with positive even degrees has to factor now let us see the definition of a factor given a function f which maps from vertices to a number n which also includes zero besides natural numbers and a factor of a graph is a spanning sub graph H such that the degree of the vertices is basically f FP for all vertices and F is a number which is called a factor of a graph so that proved a necessary and sufficient condition for a graph to have a factor he later reduce the problem to checking for one factor in a related simple graph conclusion in this lecture we have discussed factors and perfect matching in a general graph that's one factor theorem and a factor of a graph in upcoming lectures we will discuss the matching in a general graph which is given by Edmonds blossom algorithm thank you [Music] [Music] 