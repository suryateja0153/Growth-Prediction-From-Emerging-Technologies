 hello in this workflow video I'm going to show how to attach an S scaler sdx to an ACI fabric and to deploy a workload using the ACI fabric to push policies into NetScaler to support the enterprise application for citrix xendesktop to begin we go to the fabric access policies and we'll start with the physical domains physical domain is what we associate with products and devices coming into the fabric I've created a physical domain called Citrix AC is DX domain and I associate a VLAN pool to that domain the VLAN pool is important because the VLAN pool is a dynamic range of vlans the ACI will allocate to the sdx for services deployed on an as-needed basis in this case of allocated 200v Lance or just a little more 201 VLANs to support deployments and different applications on an as need basis a pic dynamically creates or pics vlans from this range and provisions them on the sdx for each application service that I deploy the VLAN and the physical domain combined and come together under the global policy attachable access anta see policy under here we have the sdx domain and then finally under interface policies policy groups for the specific deployment that we have we bring it all together under the interface policy and this is specifically under the policy group for sdx this is where we define things like whether to support CDP lldp lacp and of course our aep or attachable entity profile altogether this is what associates physical domain a pool of vlans and various interface current characteristics with a device that we're attaching in this case in SD X supporting the VPC protocol and very other limited information no CDP yet we will do LOD p and that's all that's really needed to bring the sdx into an ACI fabric next let's provision the workload so I've created a tenant in my fabric called citrix ACI under safe dress ACI i have created some basic characteristics here and does the Assumption here is when you bring in an application from netscaler into a tenant and a CI a lot of these policies will be provisioned already in this case we'll go take a look at what's already there so in this particular environment and under this 10 I've created to bridge domains one that facilitates bridging for the ACI clients and one that fit so let's say it's bridging to the ACI servers I have a private network called ACI private and this is essentially your vrf it bridges these two bridge domains so that I can route from the clients to the servers on a per policy basis next bringing it together we have what's called application profiles in this case I've created an application called ACI my app and I have to EP G's or endpoint groups one for the clients and one belonging to the servers that the clients will be connecting to in this case the servers will be our netscaler and storefront servers and this is where our el 427 service parameters will end up being deployed once we create those just for sanity I'll show you that there is no current service parameters deployed in this EPG before we deploy our elf 427 service parameters we need to create a security contract and my script will take care of this note that the security contracts allow the communication between the two EP geez in this case I have a provider EPG which is the wind servers connecting to the ACI clients through this underneath that you can define the subjects under HTTP note currently there is a service graph although it doesn't exist that service graph will be filled in once it's available and it will allow the clients connecting to a netscaler VIP to be able to reach the servers behind the netscaler now let's go down under our el 47 services this is where the netscaler is attached to the tenant first we can see that there are no current functions to find there's no L 47 device as no deployed devices or graph instances before I can attach NetScaler into the ACI fabric I must first upload the netscaler device package into a CI again this is similar to attaching the fabric in that this is something that should be pre provisioned by the fabric administrator to do that in this case say if we didn't have one already uploaded we would go to El 47 services packages and then import a device package for specifically to NetScaler in this case I would upload the 10 dot one version of the netscaler device package I've already uploaded that and you can see here that it is available to my fabric let's go back to the tenant and now let's provision all the resources needed to access the application profile so I've created a series of scripts with in XML and i'm using postman to push that using the northbound API of a pic a pic will in turn push the relevant policies down into my NetScaler where appropriate to begin login get our credentials for logging into the API interface we get a token and next we'll build the infrastructure if you look carefully the infrastructure consists of creating a series of EP geez so seeing those with the bridge domains creating our L for sale 7 device that's the netscaler itself defining specific functions and modes that will be features and modes that will be enabled for the netscaler in this tenant now this is global to the tenant and then further on I've annotated where else I'm doing with the building of the infrastructure in this case i'm creating service graft templates to support XenDesktop i need to severus graft templates that i'll be chaining together one is content switching and one is the ssl VPN service graft template our device functions after that we need to attach those service grafts to security contracts I've shown you two of those security contracts in the GUI this takes care of attached those to the surface graphs that I'll be deploying after that I'll create and associate those contracts with the different EP jeez and then finally I'll deploy the L 47 service parameters related to each service graph directly into the provider EPG or the one that belongs to the servers so let's go ahead and post these in as I push each one you'll be again to see the configuration build within a pic if you're not quick enough you may be timed out of a pic it's easy to go back and log back in and then continue to post what you're looking for here is a 200 okay from the controller now we've built the infrastructure I'll go ahead and associate the contracts with the two EP geez clients and servers and what that does over and a pic is we now have our AP geez created we have contracts associated with them and in fact under L 427 services go on down we can see that under the devices we've attached and provisioned what's called a CAC I VPX one this is an out-of-band managed sdx context and we're chosen to do that as the best practice but there is no rigid format to this in this certain deployment we've decided to connect our 2 10 gig interfaces and bond them in a VPC that creates a link aggregate channel on the net scalars and we're associating that link aggregate channel with both consumer and provider aka internal and external interfaces for connecting service graphs with that done i'll go ahead and deploy our el 427 service brap parameters this creates the ssl VPN graph because some of the functions needed to complete the service graph aren't available in ssl VPN namely managing this certificate key and cert and combining those under a single service and binding it to the v server VIP will need to do that final SSL piece under this content switching graph I also create a redirect vserver here so that anyone coming in clear text will be redirected into the secure port to access storefront so with that posted we're looking again for 200 okay and that creates all the L 47 service parameters needed to support xendesktop on a CI if we go to these provider EPG or when a PG under l4l 7 service parameters notice that I have a number of policies created to support the xendesktop if I switch over to our netscaler we take a look at the configuration on NetScaler the policies have now been pushed down notice that I'm being brought back to my initial login screen and that's because I've revoked everything on the netscaler the configuration did not exist prior to this session so my policies that I'm looking for now exists under traffic management load balancing and a scalar gateway it will take some time for that policy be pushed down and once it does we'll begin to see these features enabled under the netscaler okay and after some time noticed that now if you double click on the faults for a device you can see that although a pic is showing that there's still a fault my fault is now clearing and the reason being is it just took some time for a pic to revalidate rebuild and render the graph and reapply all the parameters so with that fault clearing I should now see policies on my netscaler okay now that my policy has been fully applied by a pic look into how that configuration renders on the netscaler so if we open up our VPN vserver notice that's up we have a certificate bound we have one ldap policy calling out to our storefront domain we have to sta servers bound to the policy and we have three session policies one for web based clients one for the OS clients that have receiver running and that pretty much completes the config let's switch over to the client and see what the client sees when you try to login open our web browser go to the netscaler gateway in this we've now have a login prompt for netscaler unified gateway once we login will be able to get to storefront choose our access method and continue to access the apps deployed on xendesktop and that completes our demo video showing how to deploy netscaler gateway services using a CI and taking advantage of all the automation within a pic and a CI using that a pic northbound API to push universal policies that get pushed all the way down through the ACI fabric and into our netscaler el 427 device thanks for watching 