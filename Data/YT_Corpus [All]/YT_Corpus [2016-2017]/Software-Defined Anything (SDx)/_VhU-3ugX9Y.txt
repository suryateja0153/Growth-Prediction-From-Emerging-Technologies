 so there was a reason that Susan I tell you about the bathroom that was my talk is next and sorry about that this gym is my co-investigator etcetera etc but you can blame this one on me not Tim also morally now and Eric purpose and done studs back etc there's some research we've been doing for a while which is the question is what's the relationship between control plane routing protocol instability and data playing the path that's getting there and is the quantity of BGP update good or bad do we want 2c0 bgp updates we believe in static routing no so we hear reports that the Internet routing is fragile and collapsing bgp is broken and isn't working well yesterday was a bad day on the internet look at all those announcements okay if we change protocol x2 protocol why it will improve routing and we seem to measure routing dynamics and say that some measurement is worse or better than the other by the way I want to warn you when some of the best computer scientists in the world are studying your networks as a behavioral phenomenon you should be scared you should be very scared okay and I'm scared because I got feet on both sides of the fence but what the heck are we measuring we're told that a lot of bgp updates is internet instability all right they drove internet update counts they say it's unstable there are too many updates so bgp must be broken i have another mom vgp updates are like white blood cells they are actually signaling a problem but they're part of the Cure not part of the problem you cut a link and they're going to be bgp announcements because of it but they're trying to deal with it they're trying to make the network heal okay beat the bgp announcements aren't the problem they're what we have today as a solution now measuring them does give you some idea of the presence of a problem but they are not a problem and it's not necessarily broken so when Andy shows you this graph watch out it's a log graph so that's a very significant spike and says my God look at the exponential growth this is very bad okay if this is not bad something bad happened this is reacting to it and fixing it for you now some warnings the data i'm about to show is not exactly comparable to andy's data Andy studying you know he's looking at route fuse and looking at very big advance that that was the Code Red event okay we're I'm going to look at single announcements I'm pretty slow and stupid and so seeing all this big stuff is very confusing to me so we're not attacking and these assumptions or as measurements but we suggest to consider some of them and we're also measuring the large-scale data playing performance but what the heck is good routing how do we say that route this meriting is better than that routing unless we have metrics okay and we work on the assumption that the count of prefixes or speed or completely our measures of routing colony I don't think they are I think the goal of the game is to get the Hat the packet to the customer okay and the measures whether the users pockets reach their destination if users packets are happy the routing system is doing its job and so I call it happy packets and there are well known metrics for data plane delay drop jitter and reordering formally defined and how to measure them is formally defined so we're going to set out to measure the control plane quality by measuring the data plane are the customers packets getting there that's what we care about that's what I'm being paid for is in is be okay but now one morning is router scaling of course if it takes jillians of bgp announcement so many that the router starts to fall over then that's too many bgp announcements but if be gps chattiness is under moore's law then the hardware vendors an Internet vendor task force will keep up with us okay and we think it scales under Moore's law so I why I'm looking trying to look at single announcements on this is from something Tim did called what's the sound of one route flapping and if I think of a router as a BGP speaker that takes some announcements in and withdrawals an announcement withdrawal and amid something and today and I look at the top in this simple 5 router configuration one announcement and one withdrawal can produce 52 different possible results at the bottom and these are actually seen so if I'm sitting here looking at the bottom trying to understand what actually happened there's not much hope so we're trying to look at things very simply and this is the arment we set up we've got something called a bgp beacon which i'll explain in a minute which is dual home to the internet and out on the internet we have a bunch of its announcing a prefix and bout on the internet we've got a bunch of packet streams coming towards that prefix so there's the data plane and there's the control plane and well the bgp beacon is is just something that takes a prefix in this case it's this prefix and announces it dual home to the internet and withdraws it at well-known times every two hours we had to go to two hours because route flak damping caught us at one I think it morally talked about not in Eugene right and this is actually because it's a dual home beacon looks more like this let's start here at and at midnight just before midnight it's announcing to out provider or a and provider be at midnight it cuts the link to provider be makes believe that a multi-homed site has lost one of its links ok two hours later it restores the link two hours later it cuts the link again etc etc ok so during the day it's I close to all these silly states but what's interesting is it cuts one link and cuts the other link and now comes the sexy part I can remember how to do this on windows I can show it to you yes ooh but it changed scale this is horrible oh it's had to shrink to fit on this tube but anyway this is something that the guys at University of Rome did this is the origin of the beacon you can now see it and turning on the announcement to 2914 this is from route views data here's its tool homes 1239 and 2914 it just read withdrew from 2914 and so 2914 is getting it all from 1239 okay and now it's cut 1239 and you're seeing everybody lose their prefixes 2914 gave up early now it starts announcing to 1239 again okay for those who do not want to continue to hear me talk go to BG play dot refuse orc and you can play with this yourself give it any prefix etc but so that's the routing deacon making its announcements ok and now I have to keep you more amused than this ok that that's real runs off routing views data etc etc ok um there's 14 ripe too so the packet stream sources for the experiment heading towards those beacons there's something called planet labs now it's on research networks all over the world and some commercial networks they're about 370 nodes at about 155 sides mostly toward Arnie network there's its URL but they're all these hosts out there and you can conduct distributed experiments so we have something running on many of those hosts and we switch with which hosts streaming data towards the beacon and the beacon and it's sending it fixed intervals 50 microseconds taking trace routes all the normal measurement garbage what do we see here is a transition from providers a and B and link to a is cut here is the change in delay for that source there is no change boring well of course what happened was this provider preferred provider be in the first place cut the link to provider a nothing changes half the world's networks were unaffected by that cut okay we look at the other saw another case this time we're going to take the same node and we cut provider be and they have to switch providers and now we saw some background delays happening and then we see this gap okay where they've actually packets are being dropped you can see the drops up here okay so we went from that no drops two drops up the ying-yang and we can focus in on that and zoom it ok these are reorders by the way there's no reordering we've got drops um you can't see it well but there's a line here in a line here and we're measuring the length of time there was packet drop okay and where we're going is we're going to look try to find a correlation between the length of time there is packet drop and the bgp noise people so because if you're looking at bgp noise and saying that says the internet is sick then we should be it should be correlated with packet drop okay here's a more interesting case we see a number of these where there's islands of packets getting through in the middle and we believe and we have some evidence but not enough yet to show that these are large intermediate a s is converging and so the traffic gets there by you know going around a side path so this is just a bunch of them together and there are some really anomalous ones right and some crazy ones so there's all sorts of data everything isn't as clean is just those couple I've shown you here's a zoom in on that garbage here's just something else thinks slow somebody's delay is sloping down for a whole bunch of nodes continually is getting better the event happens in here it affects this node not the rest of them but it seems to affect this mode to right which gets much noisier okay and we've got all these graphs acted after day so unfortunately the projectors on this side seems slightly skewed so you can't see the left axis label that's the CDF of the packet loss and we see the number of bgp updates in blue the duration of loss in red and the amount the amount of time that bgp was talking about it in green and here we see that was in a transition from a B to a in other words we cut link be here is cutting link a nothing very exciting here is restoring a in other words only be was connected now we connect up a and this is the total loss during all interesting beacon events okay when we go to look and we show the duration of bgp noise and the duration of packet loss it if we expected a correlation we'd expect something that looked like a line a slope line in there we are not seeing correlation okay again lost during a single transition of a b2b cutting link a okay during all beacon Events update duration gloucester ation and the BG the count of bgp events okay not very exciting now one warning is what we're trying to do is take the same view of life that andy and everybody else is taking which is looking at route views we cannot get the routing direct routing information that each of the source nodes is seeing and we're switching we're conducting that experiment now so we're just taking general routing information but the same thing everybody else is using so we're just trying to see if there if what the noise that they're seeing correlates the actual things that affect your customers ok this is that kinky customer right they cut their link to a and look at what happens to them there we actually went and investigated and that's a not a planet labs know that's a Ron node the MIT routing overlay experiment and I don't think it's really routing overlays causing that that's a 30-second tick by the way the ISP concern things that may have something to do with his radio modem backup so okay and here's here's a zoom in on that those 30-second tix God knows there's it's just kinky okay more noise of that okay we try to look at the loss rates preferring is PB when we cut the link to is PB for where they are in the world so Australia you know normally has this after you cut out during the change after the change it has that their loss rate improved they normally preferred a lossy or provider okay for everybody a number of them look at them they improve after the routing change right here we do the same thing these in the sides preferring a be a preferred e after you restore be and these that guy gets worse these guys stay the same etc etc Russia of course is you can tell there they've got overloaded links in congestion anything they respond to any change preferring beyond the transition to just be of course things are better afterwards preferring be and restoring a etc etc all transitions okay the correlation between loss rate and the a s hop count ok this is the loss rate during the routing change and the hop count to the stable path the preferred path and if the hop count goes up you'd expect the loss rate to correlate you you're looking for this you're not sealing same between loss rate and how router hop count as opposed to a s hoptown that was a s opt out this is router hop count seeing a little there but that kind of makes it okay so what this seems to say those last couple is distant sites experience more loss surprise there's a correlation between a sites routing preference and the type of transition whether its sights which prefer a have more loss rate during when a is cut then when B is cut and the reverse is true brilliant this is obvious ok the correlation between loss rate and ASM router hop count is weak at best okay at some site the loss rate during normal periods is higher than that during routing change periods maybe bgp MPG p noise improves delay don't think so huh okeydoke some references thanks to NSF university of oregon umich we're morally is IJ who pays my salary silly people etc etc and don't panic Thank You Randy any questions we have we have some extra time here nice pretty quick no one okay well thank you 