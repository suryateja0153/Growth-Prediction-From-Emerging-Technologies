 so welcome everyone so this is the building of Micra so you can system some assembly still required and what I plan to do today is first off the phone what I'm talking about with over microsomes platform ecosystem look at how the local development of services can be quite tricky thinking about some build pipeline stuff how you get your services into production hi testing requires a bit of a paradigm shift with micro service yeah world considering infrastructure and then planning for the inevitable things that go wrong as well so I am a consultant over in the UK for a company called open Credo we do sort of everything from greenfield initiatives we help with clients and transform businesses both from digital and physical if you I love Java I am a Java belapur I trade bit of go line of late also move more towards the ops side over the last few years so DevOps for want of a better word I'd ever sell that hello this is culture and tooling and a whole bunch of other stuff but I really enjoy that tightly and of course micro services cloud and containers a lot about clients we shouldn't these things so I've kind of gravitated to that as well and I've really enjoyed what I've learned to actually just the de session previously on on docker some of the share to my learnings so you can get a slice of those later on as well I'm also the maintainer of new services weekly it's a micro service weekly newsletter started about a month ago and I send out every week a lot of interesting articles around micro services so please do sign up at Moo services weekly i've tweet some stuff there later on get good feedback so far and it's community thing so I'd love more than you to send me stuff that you think is cool in relation to micro services and developing them and we'll you know share the knowledge if I'm drinking to do I am another jug leaders in the OJC London I do a bit of a doctor for JDK stuff not too much playing from honest and busy with other things and I'm an info cue editor write these out and box again I just love learning I love sharing it so always happy to get your feedback on these kind of things so let's start a very start what is a micro service that who is using micro services sort of playing around with them that's great who's using my service same production great so you guys are not short you're doing here I'm joking as in like well share some techniques but I'm gonna start the basics and work my way up yeah so some of the stuff you go in production might not be news to you but I'm hoping there'll be something you can take away if you're new to micro services I'm hoping you take away quite a bit that's the idea and so maybe services loosely coupled service-oriented architecture Adrienne off the Netflix Fame I like that definition it is kind of classical sower inspired stuff there's a lot of bad stuff with Rasmus are a lot of good stuff as well and we're kind of mixing in this domain-driven design concept of bounded context I'm not gonna talk Lots on that but fundamentally it's that applications that fit in your head I'll James Lewis thought works great guy over in London he talks about if you can understand an application if you can poke something and see what happens here that's a micro service yeah I'll classic monoliths we poke something in like some stuff happens and something drops over here you know they're just too big to comprehend two times what do they look at today is about building testing deploying operating and observing micro services all be here within an hour yes there's only so much I can cover I'm really conscious that there's a lot of Microsoft's talks this year so I'm sure you've been quite movement if you're ready and I'm quite keen for you to get out of the session what you'd like to get out so I'm happy if you want to ask questions does it go along just share with my attention whatever we can try and diverse of the session if necessary addressing certain bits if your comment is very specific I might move on and look at you know have a chat to you later or something and but in general I'm quite keen to see the presentation as you'd like so in terms it made platform building microservices what is a platform an agent Cockroft again loving this stuff he talks about having a development language in container orchestration platform data stores you obviously need tooling in your configuration discovery routing observability this is becoming what a micro service platform entails it's a bit different than a classic monolithic platform where you have your websphere you have you jetty whatever and you just put stuff on you need other things because it's a distributed system fundamentally even it's not distributed over the wire Alexis Richardson from RabbitMQ Fame kind of coming to the same conclusions yeah which is good to see a lot of people in the industry they were doing this stuff there they're kind of the leading edge of stuff they're coming in to the same conclusions which for people like us is great it means there's some places we can standardize on and where you can standardize and that's a good thing it's easier to do and there's less kind of not invented here syndrome why don't you thing will actually switch attorney talks about continuous integration and continuous delivery being a central part of micro services and I think it really is essential one final reference Joe Bader from Google I think is excellent actually talks about the anatomy of a modern production stack great read recommend even read later on it's a very different stack than a traditional static a traditional bare metal VM type stack and then he makes some really good points there's a lot of tech basically involved at the moment micro services docker containers it's all emerging and where things are emerging there's a lot of development to both of a business and a technical point of view and it can lead to quite a lot of choice yeah docker rocket lxd core RS you know this is not my slide I borrow this from wicky-wicky bomb but there's a heck of lot choice just in like the container micro centers tech space and it pretty much leads me to this yeah it just it's just overwhelming the sheer volume of text that we can you know look at if you are looking at Microsoft's platform though you do I think need to set up some core decisions up front you can go to more platform as a Service Cloud Foundry Amazon right down to DIY stuff but you're going to need to do a lot more stuff when you get to the bottom here that makes sense play foundry very opinionated but you lift you can drop in your app and you're good to go building your own thing full control full power but you're gonna have to do a lot of the hard work yourself packaging is also a key thing do what package your apps the service is tasks jobs do we want to build pack them if you use the client foundry build packing is very nice actually cool and also they're making they're bringing this build pack thing back a bit a bill pack is essentially you have an application you just bundle it and you ship it to somewhere and they figure out how to run it they recognize it's a Java app they recognize it's a ruby app and they run it according to the current best practice so as you're looking at doing that definitely kybounder does that now beans containers I think docker is pretty much becoming a de-facto standard than if you agreed what you're seeing there containers are pretty much near the thing on their packaging stuff and I think docker is becoming a standard so in terms of building let's let's start with the basics so developing services locally how many of you use tools like this to develop things locally to use that boxer Norse proud or playbook for when you're building a sort of like a local development environment so I'm gonna sink do most of you like configure local environments manually using brew and that kind of stuff general don't realize that so these tools are really useful you can basically configure what a local development environments look like if you're pairing you want to stand the kind of workstation you can just nuclear workstation and bring it back up and it's all standardized it's really key with micro services as well because there's a heck of a lot of stuff involved typically IP multiple languages multiple data stores or this kind of thing and everyone's got a snowflake development machine it's really hard to prove what you develop locally is going to work in production these are really good you can also go to the vagrant autoroute you can spin up stuff locally so you're not deploying it on your local machine but you're deploying it in a VM or container running on your local machine I've done that a few times that's quite useful as well but the key message here I want to want you to get away is that don't thing locally requires a bit more standardization microservices than it does for a typical model if the naive approach when you start adding more and more services if the replicate environment or service this thing gets crazy yeah you've got different languages going on you might over go pass the Ruby p.m. Java this kind of thing and then you're more more data stores going on soon it gets very crazy so I wouldn't recommend you start off by all means if you're just getting into micro services use those tools in the previous slide but be very careful when you start getting more more services I'll be kind of using local profiles and I'm mocking and stubbing spring boots really good at this you can specify your profiles you can say you know I want to mock rabbits here for example I want to run h2 is an in-memory database rather than the actual database and you can keep things a lot more whoops but more contained as well and the next level is service virtualization really cool tool at mountebank why mock they spin up little servers and you can program them to do certain things they run next for your process so you've got a Java app doing stuff and it's talking to this kind of fake service if you like you can virtualize it might be a legacy service speaking so there might be something is expensive to run mountebank and while ma Kamaraj are really cool tools for the next level of kind of mocking you can do the whole production in a box thing an IFTTT have done a fantastic blog post i've linked there I'll put the slides up later on today by all means so don't worry about copying stuff and the links be online and they've got its production in a box they literally pull down one VM one docker image with everything running in one container and they work on that locally there's also companies I know that pull down lots of different containers and you can build your own little platform you know locally on your box and lastly there's this concept of environment leasing and I've started doing this a lot more lately and took inspiration from Halo and we're using Amazon and my current project so we've got you can spin up a QA environment on demand with any services you want so we've got like 20 services or whatever and we can say you know what this is an e-commerce shop say I want you know the basket I want the payment portal and that's you're good to go not be feeling tendencies but you can basically create your own QA environment and test locally against that environment quite nice as it gives sort of the input going over the wire as well and you can have your own QA environment if costs allow you'll be able that locally to pay with it which is kind of cold as well there's quite a few options and I've gone into more detail on a blog post they're open creator sacani I work for weave trying to blog as much share as much as we can with we've worked a quite a lot of product you know quite a lot of micro service projects and developing locally is one of the big things we often stumble or we see our clients stumble with and you know the Netflix and then they do some amazing work and they've shared amazing things and but they haven't talked so much about how they do things locally which I found when you get more more services and there are kind of depends on help among each other it's quite challenge actually quite challenge developing locally you obviously I'm sure many of you seem like getting your sling of Regis humbles great work creating a pipeline if you got a monolith you know you push it along to you look revetment here push it on the CI server Jenkins most likely teamcity act on a staff you sonar to do and build quality push it into Nexus artifactory that stuff all make sense any QA it might do some load testing and staging or all this good stuff as well that makes sense in a monolithic world totally but that's the best practice recommend that always get blame with you know with our clients what happens when you go to a micro service world suddenly you've got lots of little mini apps and there's a big bit of a challenge and how do you coordinate all their releases it's not like maven dependencies necessarily where you can say I version this I release that it can be a bit different so this leads nicely onto the test that section of the talk now because testing is critical for you know a surfacing services work together with each other slight interlude I would say always remember the testing pyramid is there people heard of the testing pyramid care of like thing so like unit you know your codebase should be like this in terms of the biggest space at the bottom there should be more of these tests so more unit testing they are acceptance there's more acceptance testing there are system and contract tests this kind of thing but as they go up they should be more sort of through the system so taking a micro service system you want tests that touch like critical business functionality I saw quite a bit more later on but for example like I often recommend like testing in the e-commerce site can i browse products and that might touch several different services but I'm running safe and bdd framework testing my production website can i browse for products can I look at categories can I add things to my basket can I check out and if at any time this process running those tests fails we've got a major problem you know we need to do I want to fix that straightaway other metrics can we pick up as well but I think this kind of thing is really critical you test small start small work away out so that you're surfing and testing on business functionality so I don't know if any of you've seen like a great of minds of thought with this stuff and I have but Toby claims impart the thought back screw thought works do a lot of great work actually they are my competitors but they do a lot great work and Toby comes into this fantastic article about Mike reservists testing I'm not sure if many of you seen that one but I recommend having I'm not gonna talk too much into it have a read of this it's really good in terms of how you sort of break down the different bits of a micro service ecosystem for testing the most pipeline question comes back though it's still a challenge a lot of our clients bump into this card problem we've got five services now on two of them have got to be a certain version just work with a third button on that third ones dependent on the fourth one and you know it just happens be very careful of rubber-stamping services it's kind of the Maven approach with maven it's fine you've got our pom you know we say this has got this is depending on version 1.2 is then versioning it 5.7 something's breadth michael says promotes are actually allowing us to do that now say this version of service depends on this other version but in general you want to keep them as loosely coupled as possible highly cohesive loosely coupled it's just good software and practice here if you really must version your services and love some gigs have worked on we have to use semantic versioning i'm sure many of you had a semantic versioning you know the major mine of hatch and you say if you're doing like a major then thing we need the other still that minor you should be adding new stuff not breaking interesting functionality and the patch stuff is just you know minor kind of bug fixes security fixes that kind of stuff but do be very careful of rubber-stamping saying I've got five services and it's got to be specific versions effectively that is a distributed monolith yeah now Simon Brown talks about this a lot coding the architecture commies are some fantastic work it really is a pain you're actually getting a lot of the drawbacks of microservices the distribution and you're not getting the benefits of the loose coupling so if you've really careful about creating a 50-meter monolith I've done it hands up right now one thing like one bad thing always says I did a while back is I created a shared domain model so I wanted the main model for all my services I packaged it as a maven and artifacts you know and I shared amongst my services then the domain model changed as they always do yeah the client changed their mind pesky clients but the thing is then I had to roll out the change to all my services and learn the hard way that was not in the shared domain model best practice in the monolith not in the new world it's actually actually increases coupling in the new world or you have bounded context of kind of related functionality highly very simple a functionality shared staging is interesting idea for doing sort of assertions you're pushing stuff through your build pipeline before it gets into production and you want to do some critical assertions in staging like I mentioned before can I buy stuff coming out of my basket all this good stuff the challenge it comes when you're all different teams are pushing lots of services into one staging you soon start needing multiple versions of staging and I checked the guilt guys living on sort of guilt talk gets though is in here fantastic top page in tournament and they've actually pretty much given up on doing staging apartments now because they've got 250 services and you don't really need them to assert different things happening it's kind of like how do you coordinate all these like 20 teams or never working or across all these services it's quite a challenge so I say rather do critical paths testing in staging why not do it in production bit controversial some of our clients not happy with that but it's actually really no print for like for e-commerce for low value stuff but not financial stuff management if we really kept with financials obviously but some things in the Netflix model is actually really useful to test push of your assertion testing into production there's also consumer based contracts and a lot of companies lo it doesn't get talked about much but they strive for backwards compatibility all the time it's you know it's really hard to do but if you can ensure back expectedly ability as you're pushing out services you never have to worry about breaking things because everything is always backwards compatible it's worth thinking about but their consumer base contracts is even more interesting Martin Fowler talks a lot about that there is some great frameworks out there packed JVM is a really cool framework and I use this kind of integration testing when there's a lot of conversation going on between my services yeah it's almost like a protocol at a high level if I've got services like two or three that are chatty together and then with good reason they're chatty then you might want to assert on the contracts so that if future developers work on things they don't accidentally break that contract the contract it's not just a method signature or or an API it might be a series of things in the protocol and pact allows you to capture that and run it in j-unit and all this good stuff it's sure maybe surefire that kind of thing PACs broker gives you some cool things like you can see if it's small here but you can see what services are dependent on I'm sort of dependent on the others you also get a cool kind of like diagram in terms of what talks to what quite useful so it's some great stuff for actually max time from I think he's from spring now it's got a great example of how to use all this stuff with the spring boot framework so if you're interested that kind of stuff check out his get up really cool project my opinion so I tend to be DD services and I like serenity BDD for doing this and I serve each service should be doing one thing yes should be a check out service to repayment service that kind of thing there's clear behavior driven design you can apply to that service and I like contract test if it's a conversation and then a failure in a contract test is a fair sorry is a trigger for a conversation in your team it doesn't mean it shouldn't be deployed but it means it's gonna break stuff and therefore I need to have a chat about you know I should I push this I'm breaking this contract is it the right thing to do modify the tests if it is component unit test there's normal maven surefire I'm sure all of us like that good stuff and then also as I mentioned our BDD critical paths throughout the application so that kind of that ecommerce thing and kind of browse can I check out etc etc that's generally how I roll when I do I approach clients and help them you know improve their testing think across micro-services final word on testing is don't forget the ill-at-ease more mores I'm getting into the operations these days I'm realizing this stuff is super important and darker and things like that give us as developers a lot of power but it gives us a lot of responsibility Nanette Diane talked about this in the Netflix talk yesterday accountability and responsibility people like you know such freedom rather freedom and accountability people like freedom I like freedom as a developer accountability is a bit scary at times isn't it I've got to think about security now if I'm pushing out you know containers with an OS in them for example the attack vector suddenly got a lot bigger rather than just a single jar file that kind of thing zapped the OWASP team did great work is an open initiative talking about the top ten vulnerabilities and more from security web stuff from OS that their amazing organization don't get enough love I don't think but they've created this zap there's a attack proxy that allows you to run attacks against your own infrastructure so don't do it against other people's God's nature but you can test your applications as you're developing them and there's it's awesome framework called BDD security that wraps some bdd like stuff over the zero tack proxy and you can do some really cool stuff like given I've got a new session and I browse to this thing can I attack this by cross-site scripting all this great stuff really cool framework I cannot emphasize enough as developers we should be paid paying more attention to this kind of thing and performance is scalability it's super important I've been burned on this a few times so now I use the performance bunk performance plug-in and Jenkins which used to be called the Jamie to plug in and to test individual services so I mentioned like the payment service for example that payment service we're writing has to be super available super performant so we literally test the happy path constantly as part of our Jenkins tests and if we notice performance degrading that's a cue to start fixing something previous project I worked on we didn't have this kind of testing we're pushing out services and eventually you let the performance dipped to a critical level when the application actually fell over we were like what's going on six ages because it was my Google it wasn't micro services it was service based so this ages to figure out where the problem was because we introduced it gradually over time so now I always recommend checking from performance even just basic stuff it gives you an idea to app do not GC is your app getting stuck in a certain place is that kind of thing just get real simple stuff but it's really powerful flood do IO is this a commercial product I would say and also three-tier it's a great tool for load testing I use this lets my go to a tool a moment you can upload Jamie to scripts Gatling scripts feel a bits and bobs and but it's really cool tool for testing in production that kind of thing so all the deployment now hopefully this makes NSF but I'm already questions so far well what do you ask we all know good awesome so deployment keeping separating deployment and release you probably heard this even in the classic monolithic sense but it definitely makes sense in the micro service world I find feature banks really useful do that quite a bit actually talk about how they do quite a lot it's quite difficult at scale and distribution but a few times I've created a feature flag service and I've had services talk to that service to know whether they should be enabled or what sort of path that the application should take and I found that really tricky to maintain so what I recommend now is doing feature flags at ingress as in you know where ingress makes sense in terms of where something's coming into your app someone's triggering some kind of functionality do the flag there so if you all do prototyping a new payment method or something and like maybe you have it in the code the code path there throughout your services but you can feature flag an a/b test even at the ingress point the API or the web UI I find that much more manageable going forward rather than trying to do these slight feature flag services definitely think things like England incremental rollout canary blue-green testing is all great push stuff to production till you mean your lot services push it slowly watch your metrics yeah I think if you're doing things like backwards compatibility things that break aren't always obvious at first so push things grow actually Netflix talked about a lot about this for the better than I will to be fair so like have a check out or water Netflix sitting around that kind of stuff so you get a really good up in this thing as well now the killer avoid datastore migrations if possible I'm sure many of you use liquid base or fly away that kind of thing to modify your schema awesome tool not so good in the microcell world you might have you definitely have a lot of service clustered so you know so it's clustered so as soon as you push out you know the latest fashion to service it will modify the database and all the other services talking to that datastore now I can have a hard time because the schema and I bought it it likes there's also like it's somewhat an anti bans people do say one day to store per service but sometimes you have like other services doing reader you always only have like one right one service right into a data store I think but some as you want performance reasons other services reading off that data store again using liquid base flyweight you'll potentially break that service as soon as you have to start I'm in to coordinate releases you know it's a real pain I'll be honest I've done it it's not so fun so avoid this storm I Gration is it possible you can use schema-less tech like you know like a cassandra if you're really like up for a challenge and like Sandra a lot if you're on Amazon those things like and dynamodb that all that good stuff all I still really like my sequel and Postgres I have a lot of love for sequel genuinely yeah but you just have to think about some of the modifications you're you're making and at some point you practice like a year in you can go back and you know scrape out some of the old modifications you're making and and then you can take the hip apps once a year to do like some breaking change but fundamentally if you can avoid this Thor migrations centralizing configuration is another key thing I'm a big fan of console actually call console really good but you can use zookeeper at CD I've got a few mentions on the slide next take your pick but I really like the idea it helps that thing locally to have configuration files associated with your jar for example a wall so I'm the kind of spring boots like you mentioning other frameworks that exist Java EE but a spring boot you can often have like different and like configuration files for different profiles this is my config flow call is for QA is a prod you can use things like console console template console template or hooking to console and all console is this distributed key-value store so you might have like the feature flag thing there you might have an some form of configuration something you don't turn the knobs of your application basically for functionality console template looks at console constantly and updates the local copy be in docker vm or whatever of your config file yeah and I think that's really nice in terms of like Netflix use you recur and a few other things and they're pushing stuff into memory whereas these things are I found them more useful for sort of maintaining state and other things and also just easier testing we have like a local profile for testing local convict nesting and QAM config that kind of thing but centralizing your configuration is essential don't try and push it all out using you know or chef whatever I find in my chrysalises that gets really cumbersome big problem with pushing out stuff via certain tools like that as well if you can't choose when some things pick up the new config changes puppet or is it you can configure it multiple ways but it's very classic to how people have and so services poll puppet for changes and if something polls you just at the right time gets the change and the other things say you have to wait 30 seconds before they pick it up it can actually break an application if you are incompatible config so I'm a big fan of this kind of thing centralizing configuration using appropriate tool like console Etsy D Netflix that kind of stuff is that just put names there if you want to go and ever read about them I like Kashi cool stuff I'm not gonna lie I like actually good stuff it's really well engineered read about documented so I use a lot of their stuff but other things do exist oh yeah watch app application rollback as well been burned the midterm a few times you're pushing out new versions application you change the config or the conflicts different Oliver and when you roll back don't forget to roll back the centralized convict otherwise and you know you like Blackrock I think is fair I think it's Blackrock was one of the one of the banks famous for causing a lot of problems with this whereas like they reuse the feature flag but something it wrong or they rolled applications back but left the feature flag in the new state and that feature flag was completely different in the old app than it wasn't a new app so do be very honest in I've been burned by this the uet careful think about rollback the more things you push out and distribute you've got to sync them up but I think this is a hit I'm willing to take for centralizing the national configuration operations so I hinted at this in the previous talk method actually I would recommend you know definitely getting more into ops if you can learning about ops I think that the days of just being a developer just being a Java developer just being a JavaScript developer are probably coming to an end I think you need to be full stack to some degree that's just my opinion obviously very subjective there but think about the OP staff a couple of things that really got me as I've moved more into the ops II side and in addition to Java is standardizing on the OS so for example it's very easy to like fire up Ubuntu locally on a VM because we all like you bun - yeah then if you're deploying to Amazon Amazon Linux behaves in subtly different ways do you bun - so Stan it's like same thing at your working on Java you know Java 8 you wouldn't work on Java 7 locally with you should I mean whatever you're going to push to in terms of production you should always standardizing as much as possible the same JD KP OpenJDK P Oracle the same version the same security patch everything and the same goes for the OS minimize the deviation of things and otherwise you'll have like weird issues I've had some really bizarre networking issues where I was doing some tricks on one distro that didn't work on another my thought obviously but I made it harder for myself by having different distros in the mix do you think about being able to look just raise your infrastructure to the ground and build it back up it's really powerful and how she called terraform are awesome of this turn forms collect the next level up from say puppet and Sybil chef soul stack you define your data structure infrastructure so you can set things that you can use and like Amazon ec2 instances use dine DNS for the DNS you've got them you know digitalocean and other things it allows you to kind of it's like cloud formation move-move-move CloudFormation amazon but it's very powerful when it allows you to base the yet trash room structure bring it back up and move clouds and theories it's little bit nuanced in terms of moving clouds but it's a very powerful tool and well worth learning cap the cap stuff I mentioned we call it caps it's just like chef and to a puppet saltstack it's basically automated to savion stuff I highly recommend getting into that ansible it's my own favorite I really like ansible stuff and the reason I'm kind of mentioning these things I think it's really interesting for us as developers to learn about this stuff but it goes both ways the whole DevOps thing I go into a lot of companies where operators now are starting to program yeah they're you know they're used to doing Ruby in shell scripts Python this kind of stuff but more and more this infrastructure involves actual programming and they're not so familiar with things like solid I'm assuming most of you familiar like the solid principles and kabab solid principles so like you know phases cohesion and coupling thinking about that single responsibility open/closed all that good stuff so I'd like to say look at the slight deviation who talked I'd like to say taking this kind of thing as an opportunity to work closely with your ops team share your knowledge yeah you've thought a lot about and cohesion coupling architecture they may not have yet they may do but they may not have and things like git flow how you work with the codebase do you commit to integration do you commit to a master branch how do you know how do you work with branch is basically an git it's it's often unfamiliar with some Ops teams and I've had one project I was working on we were developing apps and infrastructure at the same time and it was a nightmare because we had master branches of both integration branches it was just really fiddly because the ops team at enacting the scenario didn't know about they shouldn't be committing to master broken code I know we might scoff and say that's an obvious thing but they just didn't know it or they weren't testing that kind of thing so I think it's not choosing to work closer together as dev and ops that the true DevOps thing yet culture tooling will this good stuff service discovery now the next bit um two options really when you're looking for service so you say you've got some service here so I'm saying here you want to talk service scenes a couple of service sees service being the bottom there and you got a couple of options really and it's external where you have like say a lobe answer in front of the service is or its internal you sort of baked in the load-balancing to the actual services yeah I think this is often easy to get started with and if you were using things like Cuba Nettie's and Amazon this is kind of default way of doing it it's nice and easy to auto scale as well if traffic is coming in a lot here we can trigger that like low bouncer to say all spin up more service sees that kind of thing it's very easy to get started and you work that when you'd like deploy in the investment service you just have to tell a load balancer and loads of services can't be all coming in that low bands are it's nice and easy but there's a lot more cool tricks you can do with client-side load balancing I know Netflix very famously using little ribbon and load no client-side load balancing you can do kind of AV testing touch stuff you can do like clever stuff around like they use like hystrix the load shared if there's like things getting overloaded all this good stuff but do have a think about what's appropriate for your use case is it easier to update just say like an H a proxy in nginx that points to other services do you want to scale really easily no just if there's load increasing on those external things and more docker containers add more Amazon instances that kind of thing if you want more power I'm sticking with like some of the docker stuff I can work on lately we've been using like Netflix ribbon Baker Street is a new thing coming out it's real off the press and Google for that one and some of the guys actually reached out to me from the mics and Mellon list and said hey like check this out it's really cool so that's quite nice and there's some really funky stuff you can do that it gives you a bit more power at the cost of a bit more complication if I call cubanelles dimension they're good they have this concept of services baked into like the framework I found very good to go they had this notion that you know it's a they're a bit more opinionated about what they do but it's easier for us as developers to kind of leverage what they do in straightaway fine thing observing now this like if you saw the previous docker talk I talked about this a lot observation of stuff in production and even in QA tent you know testing is really important and in production all could be the people or the most important thing yeah now there's a great talk at you met Mikey Dickerson Mikey Dixon came in and so many of you knew about their girls like them sorry the healthcare.gov scenario that went on over here she doesn't have a team but I followed that quite closely it's quite interesting and whole bunch of stuff flow I'm going to teach us all of it but fundamentally Mike Dixon and his team came in and rectified a lot of problems with healthcare.gov got it back up and running the new month or two and the biggest problem they had was the lack of monitoring they were literally looking at CNN to see if the website was up that is great that was their like that was the information radio just see it n is like oops I stand again better reboot that my thing which there he was like this is like Mikey Dixon comes from Google always there they come these that's crazy yeah but that's the kind of level you do see in some organizations but once you've got past that basic monitoring yeah I'll talk about them on a minute health checks all this good stuff then it's all about how do you and your team handle these things Incident Response post-mortems fundamentally culturally driven and working to many organizations where people work quickly to point blame and not quick to accept it I worked in some fantastic organizations on the flip side of that I've been fortunate enough to be invited into Google and other places where I've seen how they work and like as much we might scoff at Google sometimes they are truly amazing in terms of culture they have blameless post-mortems this kind of thing and when you get it working right it is amazing and it just harmonized as a team and you basically get rid of all that politics rubbish and just get stuff fix yeah because we're all gonna make mistakes don't wait to be honest you know but you need to think about if something goes wrong like this thing people run game days like chaos monkey type stuff like Paul's the high your data center see what happens there's the right person get paged do they take the right action that kind of thing and they also put dirt dirt sessions disaster and recovery training that kind of thing and it's a lot about the people basic monitoring fundamental but then it's all about the people is that DevOps thing yeah culture start with the basics helped health check I'd be kind of like coda hail drop as a metrics bring boot comes at boxspring quick actuator really Nakul basic 200 HTTP I'm good I'm up I'm available like for taking traffic that kind of thing simply without music Amazon quite a lot lately I'm putting like the spring boot health check on the low bounce a check so the low bands are only give sense traffic when the service is up and good to go so KP eyes are really important for an absent business and this I think once you've got your health checks on think about what matters to the business first is my advice then think about the technical stuff so the business cares about how many checkouts are going on that kind of stuff here what's the value of checkouts why my top items not being seen by more people on searches think about assertions and invariant stuff that if something's going wrong it might be subtle in terms of a technical difficulty like but you want to know what's gonna actually impact your users and your customers some people are calling this symptom driven monitoring which I really like basically think about the business impact if someone cannot do something in your app alert on that that and then dive down to further stuff in terms of like Rupert q length is the database up too many times I've gone into organizations databases crashed and alarms going off everyone knows databases crashed they've got no idea what impact that's having on the users sometimes database crashing no big deal and microservice architecture we route around it or there's some backups it's a cache involve fine but the matter panic I've seen you've gone without David I stand but what's that mean don't know let's fix it I could have I think is that actually impacting you let me some other things going on as well think about symptom think about business issues yeah as opposed to tech issues first logging is really critical and I mentioned this in my previous talk so log like an operator is my advice yeah think like an operator think like a sysadmin too many times I see log statements like if this happens call Bob and let Bob's programmer and Bob's that nowhere to be found Bob's never coming three months ago that kind of thing dude local I can operate it like give meaningful log messages that will help your operations team and when they're looking know when it when he or she is looking in the logs and going like what's going on here oh this happened they said this all this didn't happen make it easy for them to figure out what's going on then they can you know you probably be on call as well perhaps as a developer but a couple of great links here for how to log properly too many times I think people like either doing no logging or log crazy there's a nice middle ground there where you're logging to help you and your ops team when things are going wrong an elastic search the Elks tasks section la cabaña really cool loving that's a Cabana is this kind of like funky giving here it's like really nice they use that I use qivana and gravano a lot on my gigs and they're really nice for like information radius and stuff but fundamentally they're really cool tools and do you think about mounting life using container stuff like containers are quite ephemeral so vm's I'll give you as well do you think about that or worse you often I've seen projects where we've lost logs because the applications died and trash the container or trash the VM so spectacularly we can't pull the logs out so ship the logs off to log stash or somewhere else get it off the box as soon as you can all and mount a directory into the container and have life using docker like store your log files on the hosts as opposed to in the container that makes sense yeah you want to be able to do post mortems basically if you don't do that it's the perfect crime yeah something goes wrong locals got blown away no one knows what's happened really key to get the logs off the off the instance off the box come on admission is awesome and zip key and I'm really a big fan as if kidding I've talked about that how to do this kind of stuff actually on my github and Zipkin is for dish 2 beauty tracing and this is a big shift in the micro service and ecosystem in my mind no longer like are you putting something into a monolith and something dropping out the end or going to a database or whatever you might have multiple services involved yes something comes in it might even get fanned out to multiple services it goes down and calls another service that service calls another service it hits a datastore it's a cache all this stuff and it's really tricky without a way of correlating a user's action to those things figuring out what went wrong yeah so what I've talked about putting a correlation ID something like a user's request come straight into your application you give it an ID oh that's you know request one and you pass that correlation ID all the way through the stack right to your data stores all the way through you can trace it in the only in logging so you can use cabañas to have to search that ID you see the journey that that request is taken but you can also use tools like Zipkin speed like the firefox debugging think ones like Firefox them fire bug order it's called and you can actually see here like this nib this service handed off to this service then this ever split they're like requests to other services and you can see which service is taking the longest all this good stuff it's a really cool tool Zipkin caravan of Twitter now it's completely open sourced agent Kohl's guy work on actually days I think is around the conference actually they're doing some amazing work they've got a doc is it kin which good to go because doctors it can it involves Cassandra a couple other services as well they've got a doc container now it encapsulates all that together so you can have a very quick playing Zipkin and it's really cool it's kinda like app dynamic so when use app dynamics but it's free we're just getting after analysis quite Quincy monitoring think about push and pull it's very tempting like I often joke and I say let log everything monitor everything but do you ever think about how much you want to be sending over the wire often it's better to kind of like exposed endpoints with all your metrics you can ever be interested in and maybe refreshing there a few seconds but only pull down what you need to sort of do critical tests like Telegraph is really cool and tool for doing that Telegraph plugs up the influx TV you can select what things you pull down for metrics if stuff goes wrong you can certainly start pulling more things down yeah but fundamentally that put if you're pushing a lot of data over the wire it's very easy to basically take up all your bandwidth for doing that kind of thing there's so many tools in this space influx Prometheus graph I opened ESP be that I find a hard keeping up all this stuff so I put some links there's a cool blog post where someone's talked about where they think these tools are best placed because they're quite briefly as someone actually asked in my last session Prometheus is quite an opinionated way of logging and whereas in flux it's kind of like a very low vision it's just a datastore basically time series datastore same as fnts DB information radiators are fundamental like you've got the data but you must make sense of what's coming in like that's the only value you're gonna get yeah it does matter how many metrics you got can your business can your ops team can you understand what's going on yeah and this thing I really struggle with is this agregate versus individual yeah so sometimes you want the aggregate view what's the average off you know my checkout time here sometimes you want the individual view like no I know so I have one out of ten checkouts is taking like two and 50% longer or something yeah this swapping between the agri and the individual was really key so but do when you build your metrics bear that in mind and I think that I've got really put into the whole aggregation thing and I've actually burned by that quite a bit the individual was often quite used useful the reason I think I got put into this aggregation thing is the notion of cats not pets have you heard that so people are saying in micro-service don't treat your containers here your infrastructure as a pet like in the old days you might let bare metal you provisioned it was you named it you know probably some geeky Star Trek name one of us or I said it good and that kind of thing and you looked after that that instance that application or whatever now you move more towards this cattlemen method mindset but if something sick or broke on you just nuke it and start again and but the problem is like sometimes you reality is you have got a pet or it's a prized goal it's still cattle but it's a prized bull yeah so think about different levels of aggregation sometimes you want to know you know the big picture sometimes you want to know the individual pictures and a classic example this amazon recently had a massive issue on the east region and maybe the rebbe region disappeared they fought their stuff back up and they were seeing an error rate of 1 or 0.5% I think you know like we've got it fixed an error rate at 0.5% we can live with that the problem is that nought point five percent affected 1% of their customers so basically one since their customers were getting completely trashed they assumed upfront it was like noir point five percent disagreed across everything which we wouldn't have been too bad yeah so amazon they've done a great post-mortem Hugh search for the recent Amazon them region outage like they are there again they're like Google they're fantastic in terms of what they you know finger-pointing is that what went wrong how do we fix it and that you can see like their engineers they're just like us they try to fix that you know they're just pulling things out putting it back in or whatever and but they were talking about like making assumptions in terms of aggregation versus individual can be damaging graph another really cool tool much like yavana reviews that law it's open source really cool bill is really cool and information dashboards that kind of thing as well if you've got problems and it's great article by Rob oxygen it's a Google Doc so when you go it's a Google Doc I think he's from I think Google always might moved on that but he's basically created google talk about how to do good alerting and I love my stuff like I was doing before I picked up from colleagues and friends over the years it's just perfectly captured in that document so I'm not gonna talk about too much here it's just like if you want to know how to alert stuff like this like Rob stuff is awesome basically and so he's Brendan Gregor I don't have any of you saw the Netflix flame graph talk here that was Brendan Brendan's a really cool guy and not that she met him personally ever like he's got some amazing stuff out there and he talks about the you his method which I found really useful when I've got problems and uses check utilization of saturation and errors that kind of thing I'm gonna say no on that utilization no is something that I'd like it saturated or whatever house I mean utilize what's the error rate I won't go into too much but that's a great link to he's published papers on this stuff nice blog posts and he's really done a lot of thinking about this stuff so I respect his thinking on that and I've learned a lot from this book as well DevOps troubleshooting it's a smallish book by Carl Rankin but it talks about a lot of ops type debug tools and always good stuff that aren't good for me as a developer yeah like it for me it was like a yeah probably a couple of days worth a read on the train home and it was really good in terms of figuring out how I should think of it more like an operator when things are going wrong really good so the summary we have looked at micro service platforms I said you know pick your poison in terms of life boundary dais Amazon SES build your own whatever you like local development is the first thing I often when was he gone up to know a few services in the mix with breaking down and monoliths say we've got have you know a few proof of concepts in the mix all going well we often start to run into problems around the three service mark particular like one project as working on we've brought in some Java in the stack it was primarily Ruby and the ops team weren't really used to how to work with em Java for example so soon if you got you know multiple services in the mix it certainly got a bit more complex yeah so think about that think about the techniques I mentioned service virtualization the rental platform type thing all good stuff think about your build pipelines fundamentally how things work together now is a real challenge yeah so whether you make them back compatible whether you do some kind of versioning is I'm going to API versioning all these things do you ever think about it definitely caught me in my team a few times and the testing goes hand in hand they're like I really like the consumer base contracts that they are a bit of work but for a services involving communication or conversation protocols I find contracts really useful for verifying changes they're making on not breaking old stuff it's very easy to assert does the API look like this it's hard to assert does the API behave like this that makes sense yeah so pact is really cool there and do consider the infrastructure both from as a developer I think we need to be more aware of operational stuff now we need to be more and and the more stuff we learn that the better it is all around we understand things we can communicate with our ops team better and you know probably a bigger paycheck we get it sweat and more things we learn it's all good stuff but I think also we can help the ops team as developers is really key we've known over the years crafted good you know architectural skills coupling cohesion as developers we've really thought about this stuff and some of the Ops teams I encounter not generalizing but some of the opting seems they counter aren't so familiar this stuff so the whole DevOps thing teaching your ops team what you know sharing what you know around good development practices including code and branching and getting all that good stuff as well do plan for inevitable issues lie say the logging the monitoring all that stuff is essential and I mention my previous talk I said get as much as you can up front and then dial it back because there's always a cost of things yeah in terms of I think if you're sending data over the wire all this stuff it's always a cost but upfront put as much as you can in then dial it back as you get more confident yeah so often saying talk I mentioned before with docker I was saying with docker often first month the production deployment I'll put a JDK in my docker container so I've got access to J's fat J map Jake yeah JPS all these things if I really need to I can go onto the container and start debugging stuff in the container but by having a JDK in a container the attack vector is much larger so as soon as I can I remove the JDK from the container things that that's just one example but I'm trying to say it's like you know go crazy at the front then dial it back as you know you want to always minimize things in terms of performance and in terms of attack vector as well it's really key final comment is with this micro says platform I try to keep it quite generic general in terms of that things I've stumbled across as I've been developing micro service platforms for the last like three years whatever it is and and one key thing is try not to create your own platform if you can help it a lot of us seem like we're in it one life you know three years ago using may sauce and all this stuff for cubing at ease for SGA we kind of had to our own stuff but I think the energy is almost mature enough now for us not to make that choice or we make that choice but it's an informative choice yeah so don't just start putting of my recommendation I should say don't just start putting things together just because it's fun it's very tempting that docker it's super cool yeah it's very tempting start building your own platform but you're going to like create a lot of potential hazards for your ops team you're not careful that's my my general experience so do you think about this thing but call him on am I am colleague snow from fire in the UK he Collins very much and declared foundry he's like quiet credo over there and he joked about this he gets no started writing my own scheduler Lola looks like you're trying to build a platform and I see this quite a bit like teams you go into because a lot of the DevOps stuff is being pushed up by us as developers but we don't commune in my generalization again we don't communicate enough with the ops teams like they have got up till in big organizations our lot falls on the ops team shoulders yeah things like security compliance all this good stuff so I think that some of the platforms as a service we're seeing being created now have got this stuff baked in and they're a bit more aware of these things so do think twice if you're going to start creating your own platform yeah I'll let note thank you very much I'm happy to take questions like feel free to ping me on email I'll get back on I'm driving back to you caching weekend so it won't be too busy on the email Twitter always happy to get your Twitter mu services weekly is the monkey service weekly newsletter please do sign up please do share stuff as well and you come and chat to me now or ask questions I'm totally cool live god bless you got a shoot-off like it them so thirdly I'm doing one more session over in the Hilton so around for like 10 minutes I guess thanks a lot 