 Alright, welcome everyone. We're delighted to have Professor Azita Emami here for our Colloquium today. Azita is a professor of Electrical and Mechanical Engineering at Caltech as well as a Heritage Medical Research Institute Investigator. She's also served as the equivalent of the Chair of the Electrical Engineering department. She got her MS and PhD degrees in Electrical Engineering from Stanford in 99 and 2004 and did her undergraduate degree from Sharif University of Technology which is which is renowned for this undergraduate and circuits program in particular. From 2004 to 2006, she was with IBM T.J. Watson before eventually moving over to Caltech in 2007. Her current research interests include integrated circuits and systems, integrated photonics, as well as variable in implantable devices for neural recording and stimulation sensing and drug delivery. She's currently the Associate Editor for the IEEE Journal of Solid-State Circuits which is the premier journal and publication in our field and was IEEE's Distinguished Lecturer in 2018 and 2019 so without further ado, Azita, please take it away. Thank you so much. Thank you all for joining us today and for having me. So today I'm going to talk about some of our research efforts related to biomedical devices, in particular implantable wireless devices. And in my group over the past 10 years or so, we have worked on a variety of such devices and I'm just showing here some examples in the past. We have worked on intraocular pressure sensors that are wireless for patients who have glaucoma here and on the top right side, I'm showing an injectable glucose sensor that is completely wireless, [inaudible], it has RF energy harvesting and can be injected right under the skin and an external reader can probe it up and read the glucose level out from for patients who have diabetes and they have to prick their fingers every day. So we've been also working on technologies to be able to localize these devices. These kind of devices inside the body, this is another example here in the middle-- we call these atoms which allows high precision localization inside the body. And that's one of the projects that today I will focus on and then finally we've been working on neural interfaces over the past three, four years. First, we worked on seizure detection and more recently in brain machine interfaces and that's another topic that I will cover towards the end of my talk if I have time. So let me start with our efforts related to device localization inside the body. So imagine if one day we have sensors that travel inside the body trying to measure things or even deliver drugs inside the body. It's very important to know where they are and but even in today's applications when we have capsules or smart pills going into the GI tract, it's important again to know the location of these devices. Another area with localization of micro devices inside the body that would be very important is related to high precision surgery, navigation during these kinds of surgeries, robotic surgeries, minimally invasive laparoscopic surgeries. In all these applications, navigation and localization would be very important in some of them. Top millimeter accuracy would be greatly beneficial so that's something that my group has been focusing on and the problem with current localization methods are a few and there are several approaches. One would be very similar to how GPS triangulation works with using RF signals and then looking at the strengths of the received signal or time of flight or time difference between arrivals or angles of arrivals. So these techniques, while they work quite well for a system like GPS, inside the body they fail especially if we want to go deep inside the body or if we want very high level of resolution because RF signals at higher frequency-- they experience a lot of attenuation multi-path and also highly depend on the body composition whether the person has more muscle or most more fat in their body. So there are also ultrasound based approaches, again they have poor performance for bones, airs, and gases inside the body. And of course optical base that are used in several types of surgeries there are also they have their own limitation in terms of penetration inside the tissues. So we've been looking at this from a different angle relatively different angle and our approach loosely is inspired by how MRI works. And as you know MRI gives the highest level of resolution for locating nuclear spins inside the body and they can distinguish location with better than or close to 100 micron of resolution. So I'm sure many of you are familiar with the principles of MRI, just very quickly I will review it. MRI of course relies on a very high magnetic field to align the nuclear spins. You can think about them as hydrogen atoms that are being aligned and then there is a gradient magnetic field gradient and an RF excitation so after the RF excitation is removed, depending on the location because there is a gradient in the magnetic field, different atoms oscillate or do the procession at different rates. And this is called the Larmor frequency. And therefore we can look at these frequencies are different and then map it back to location. So in our project, we also call these devices atoms because we are building these micro devices that behave quite similarly to real atoms or nuclear spins inside the body. So the idea here is that to have this micro devices or chips that depending on the location that they are inside the body, they will oscillate at a different frequency. And the nice thing about this approach is that we don't need a very high strung field of the MRI which makes MRI systems extremely expensive. So we call these devices also items of standing for addressable transmitters operated as magnetic spins, so we basically not only can locate them, we can also communicate with them hopefully. So let me show this in a little bit more of detail. So the idea here is again to create a magnetic field with a well controlled gradient and then we have the tiny chips inside the body and depending on their location, they will send a tiny tiny signal at a specific frequency and then we shift that frequency based on location by measuring the magnetic field that each chip is experiencing so try to kind of mimic different phases that MRI systems have in our system. Basically the first phase which is called the magnetic phase, the chips basically measure the magnetic field and then we have the second phase, the excitation phase where we actually send a reference RF frequency at F-not to the chip so that all the chips basically lock to the same frequency. So that's kind of the difference that you see here. We have a PLL on chip as I will show and all of them will log to this frequency and the nice thing about this approach is that you can have many number of chips and as long as you can differentiate the frequencies of oscillation, you can identify one from the other. And then you have the transmission phase, this is where we basically allow the on chip oscillators to oscillate at different frequencies based on what we have measured during the first wave which is the magnetic phase and we shift their oscillation frequency and therefore we encode location into frequency. So as you can imagine, the principle is actually quite simple. So we have to generate a monotonic well known magnetic field with a known gradient and then our chips will translate the measured magnetic field to a delta F with this factor of gamma and then we have to look at the profile of the magnetic field and look at the inverse of function to map it into location. And the resolution will depend of course on the noise performance of the magnetic field. A magnetic sensor to measure the magnetic field, there is a noise and offset associated with it and then there is a phase noise associated with the frequency generation on chip and transmission of that frequency. The nice thing is that the frequency doesn't change as the wave travels inside the body. So we have looked at all these noise analysis in our publications and the noise of the sensor and knowing the phase noise of the PLL and how much averaging by averaging basically we enhance the performance and the resolution of localization. So this is the chip architecture. This s is the first chip that we had, it has an on-chip magnetic sensor that I will talk about. It's a MagFET and then we have transimpedance amplifiers and low-noise amplifiers with chopping to reduce the low frequency noise. And then there are on chip... there is an on-chip antenna that receives the external RF frequency and this antenna acts in two ways, first as a receiver and then later as a transmitter. And we receive the RF signal, there is a phase lock loop that locks to this RF signal and then dealing the after we measure the magnetic field, we shift we open the phase lock loop we shift the frequency of oscillator and to a power amplifier, we send the signal out. So let me talk a little bit about the magnetic sensor. And so our goal has been to include everything on a signal chip and so this is a split drain magnetic sensor in CMOS technology, so that's at the heart of the design and there is a direct trade-off between how much power consumption, how much current you send into the device. As you can see you're biasing that device, just let me very quickly explain what it is first so this is like a MOS transistor where we split the drain of the transistor in two sections. So and we bias it with the current oil P so but if you have a magnetic field perpendicular to the device, then depending because of the Hall effect, we get two different currents in the two drains ID 1 and ID 2 so if you read this out and digitize it, then we have a sense of what is the value of the magnetic field at a given location. So there is a lot of optimization that needs to be done to trade-off between the sensitivity of this MagFET and how we bias it, how we size it, the noise performance of it, and so on. So we put a lot of effort using the technology parameters that we could get to first optimize this device before fabrication. So let me also talk a little bit about the phase lock loop which is again very important. After we measure the magnetic field and we lock the phase lock loop to the incoming RF signal, so here is the log phase, we have to open the phase lock loop keep the frequency and then shift the frequency accordingly based on what we measured based on the measured magnetic field which gives us delta F. So if you... our circuit designers you know that this is quite difficult because and as I will show, basically you want to lock and then you want to open the loop without changing the frequency so because what you want to rely... keep that frequency and then again reliably shift it. And you have to do this very quickly before you have too much drift in your oscillator. So for doing this, there are a lot of details again in the appeal of this behind that I'm not going to go through it but we did a lot of work into this by designing the PLL using a low K VCO voltage controlled oscillator to make it less sensitive to variation of the control. We also sample the V control in a way to make sure that we chip it correctly and we avoid overcorrection of the loop as we're opening them. So this shows a very simplified block diagram of the PLL where it locks. There are three phases-- it has a calibration phase, then it's a normal operation of locking, and then we sample the V control into capacitors, a relatively larger capacitors than the loop capacitors and then we basically connect it. We open the loop, we shift the frequency, and the performed transmission. So basically this shows some of the measured results of the PLL where we have wireless locking via an RF pulse and as you can see but the nice thing is that we need to we do everything in millisecond regime so we showed that actually after the initial lock and so this is the initial free running frequency of the peel of the oscillator, this is after the RF signal comes in we lock. Momentarily there is a shift but we bring it back because of the correction in the loop and then the oscillation stays almost reliably constant for few milliseconds that we need. If we wait longer of course the frequency starts drifting. So this is also a measured result that shows what happens if we have different magnetic field at different locations so these are the three different magnetic fields. For the PLL first appear in locks, then we shift the frequency to three different values based on the measured magnetic field at three different locations. And this is the chip, it has two sets of coil one is for power delivery, the other one is for RF coil another that I mentioned and PLL LNA TTR a magnetic sensor and all the required building blocks. So again it shows how we receive the signal externally wirelessly at different frequencies as the oscillator is being shifted and it shows that we can reliably separate frequencies to measure location. So we first see the 1D localization in the very first design. We basically just put a permanent magnet in location in one location and then we move the chip on x-axis to show whether we can do localization. So as you can see again at three different locations of x1, x2, x3, we receive different frequencies. This is the power spectral density of the received signal at three different frequencies then we based on the measured magnetic field that we do it with a précisément the conventional magnetic sensor, we create a map of the magnetic profile and then we go from frequency to location. So this it shows the the performance as you can see, we can get submillimeter accuracy. This is the error Sigma of the in localization which is consistently below 130 micrometers. For this one we experiment. So to do to the experiment again, in this very first version we put first one magnetic sensor we do a measurement. We remove this magnet, permanent magnet, we put another permanent magnet, and then at the other corner and then we do the 2D measurement. And I have to say that in this particular design because we have just 2D magnetic sensor on chip we performed 2D localization but I will talk about 3D localization very soon. So this shows the actual measurement as we put the two magnets in two corners and again we show that we can perform very high-resolution localization. Here is when we move the chip to right, California Institute of Technology CIT and we get very high resolution of again below 100 micrometer of accuracy error. So we also did in vivo localization in a crude way, we had the chip in him in a mice and we moved it with a shaft. Again it was an anesthetized mouse and of course because in this case in vivo our resolution or accuracy dropped a little bit but still we showed to the localization in vivo that was better than half a millimeter. Again, this is much better than multi millimeter accuracies that are of triangulations achieve. So this was published a few years ago and got the cover of Nature Biomedical Engineering but the nice thing that happened after we published that is that we got contacted by a number of physicians and people in the medical field to meet potential applications of this device. And we realized initially we were thinking this would be used for smart pills but then later we realized that actually it can have a lot of different applications. So in particular, we focused on two applications. One was the smart pills and the other one was heart  precision surgery. So from industry people contacted us regarding in particular about orthopedic surgeries that require a lot of alignment, very precise alignment for different procedures. And usually these procedures involved, because of difficulty of alignment, require multiple x-rays as they do the surgery it highly depends on the expertise of the surgeon. Some surgeons do these things very quickly, some of them it takes for them hours to do it. So one of the areas that would be interesting is for instance how to fix implants inside the bones because again you don't have any visual access and you want to for instance lock the bones or align them for hip replacement or knee replacement. So the idea here would be to tag the names or the implants or even the bones because we realize that actually orthopedic surgeons all the time they could screw different places inside the bones and so on. So we can actually use our atoms chips as tags in different places and also put them also on the surgical tools to be able to localize things with very high precision. So one of the applications that we focused on because again the implant companies... I just said that these are very difficult surgeries was the IM nailing which is the intra medullary nail. Again you have if they're putting an implant, these are long nails that they put inside the bone and then at the end of at the end of the implants they need to lock it using a screw. And again there is no visual access to where that hole is with respect to the screw. So imagine if we add one of our tiny chips next to the hole, and then another one on the surgical tool, then on a monitor we can show to the surgeon where they are with respected each other. And then we completely and eliminate harmful x-rays and we expedite the surgery so in this case, we would want nothing to  block the surgeon. They don't want anything added to the environment, so the idea here is to create a field generator mat that can be put right under the bed where the surgery is happening to create a magnetic field that we want and then perform the measurements that I described before. So since then we have made a lot of progress actually to design also the magnetic field gradient coils instead of having permanent magnets that we had at that very early design so we generate XYZ magnetic fields with almost linear gradient in a very large relatively large field of view in X Y Z direction by having three sets of coils as I am showing so the first red one creates the the gradient in X direction, the blue one creates a gradient in Y, and Z creates the Z. And basically a lot of simulation and engineering went into designing these coils to be able to generate reliable and very high very well-known gradient in this magnetic fields that are being generated. So then we put all these three layers on top of each other and we turn them on and off in consequence. So first we turn the X coil, we measure the X dimension, then we measure the Y and we keep the Z coil on all the time. Again I'm not going through the details of it but keeping the Z coil on all the time, it allows us to bring the magnetic field level up and avoid having cross- magnetic field so it makes the measurement better, easier, and creates a more monotonic field and increases also the field of view. And then we quickly do the measurement in each phase. Right now we are limited by how fast we can ramp up the currents in these coils but they can definitely improve in the future. So these are the actual coils that we we had in the lab, again the same XYZ. The first one that I showed you was simulation, these are the actual measurements of the field that are generated by these three sets of coils and then as I mentioned we put them on top of each other. So for the orthopedic surgery, we actually designed a new CMOS chip that is completely wireless with wireless power, wireless data, and and also it has an RF wake-up because we don't want to have any batteries for these devices if we end up leaving them inside the implant, inside the nail orthopedic nail in for the patients. So in this quick basically prototype that we had, this time we used a commercial 3D magnetic sensor as we're designing our own mounted magnetic sensor that will finish soon. But in this case we use a a commercial magnetic sensor to make sure that we don't have so we did a lot of optimization to reduce the power consumption and to wake up the device only when we want and communicate with sensor in an efficient way because wireless power delivery as you may know it's not very easy inside the body and so we put a lot of effort into the power management circuitries and making the system very low-power. So this was fabricated in a 65 nanometer CMOS nanometers. CMOS technology as I mentioned, it has bi-directional data telemetry I2C communication in the magnetic sensor, this was actually presented at RSSSF C-RAF SEC 2020 back in February which was maybe the last conference that we all attended right before the lockdown. So then in the lab, these are the actual coils. We have this tank of saline so the black thing is the tank of saline and the chip is on a platform that can be moved around and the wireless communication and power delivery also is under this tank of saline and this is a tiny board that includes our CMOS chip, the magnetic sensor which is the main reason that is a little bit bigger than what we want. But as I said we have we have a new version that has the magnetic sensor on a chip and then we have this coil that goes around the the PCB board for wireless power and data. So this was successful in terms of localization, we did XYZ localization and of course because of the magnetic sensors noise, random noise be sure that if we do enough measurements as soon as we go beyond 20 measurements our resolution improves to better than 100 micron which is state of the art in terms of localization. So we perform the same type of XYZ measurements and averaging to get very high resolution localization so this is shown for three different locations: y1, y2, y3. Usually we get the best localization results right in the middle of the field of view where we have the highest gradient. And averaging of course helps a lot so here is the summary of performance of this chip, it does 3D localization with better than 100 micron accuracy and is fully wireless with a very good field of view. So this was the first quick prototype that we built for navigation during surgery but as I mentioned we are working on the next generation which will help for hip and knee alignment and hopefully will make a lot of these surgeries faster safer and more accurate. So I can actually stop for a second here if any of you have a question before I switch here to to the next topic I can answer some quick questions right now and then I'll move to the next topic. I guess you guys can you raise your hand I see one here let me Blake, let me unmute. I'm not sure oh yes Blake please go ahead yeah we got yes he should be unmuted. I just please go ahead yes hi Blake either so maybe he has difficulty I see that his audio is not connected so maybe anybody else is there any question regarding this first project related to localization? Yes, I have a question so in the second version you switch to the digital Beca scattered data modulation instead of the PLL base, right? Yes, yes oh I forgot to mention that yes in the second case, we are not dealing with too many devices. The first case was envisioned if we have many of devices inside the body especially for application for GI tracks, we usually want to have many of them travel at the same time inside the GI tract. But in this case because the numbers are limited we realized that we can make it much simpler by simply just sending the magnetic field out. I see and what was the trade-off in the power like the power consumption between these two metals? That's a great question so of course the first if we don't do frequency encoding the save power on the chip but overall the second version unfortunately had a little bit higher power because we used an external magnetic sensor. So the power is really dominated by this commercial magnetic sensor and we believe that we can reduce this by a factor of 10 in our next generation of on cheap magnetic sensor motion. Thank you so it looks like Blake asked this question via text. How sensitive is the measurement to the presence of metal objects which could distort the field? That's a great question so of course if you have ferromagnetic objects close by, it will distort the magnetic field but fortunately what I didn't show is that we actually tested the system with actual implant which is usually titanium. So titanium is not a magnetic material and fortunately it did not affect our magnetic field at all. Also surgical tools, a lot of them are not magnetically active or ferromagnetic and therefore they have they do not distort the magnetic field. However, our next step that we actually just right before the lockdown happened we were scheduled to go to an actual OR and tested in an environment that includes everything so that's a great question and that's something that we still need to fully test it but we have tested with surgical tools and a titanium implant itself and we haven't seen distortion of the magnetic field but the titanium rod actually causes some degradation on wireless power delivery that they had to actually when we put that chip into the implant, we actually have a small cavity on cavity under the chip to avoid eddy currents in the titanium implant that would degrade the the wireless power delivery. Great question so maybe I will move on and then at the end of the talk if you have questions about this section of my talk, feel free to ask. So I think I still have maybe another fifteen minutes so I will move to the next section of my talk but before that I would like to of course acknowledge all the students who were part of this project. Manuel Monge, he is actually now a professor at USC and Professor Mikhail Shapiro at Caltech has been our collaborator who's an expert in imaging and MRI systems. So now I would like to also talk to you a little bit about with our research projects related to neural interfaces. As I briefly mentioned at the beginning, we've been interested in neural interfaces especially trying to move towards miniaturized implantable devices. First, we worked on epilepsy because as you know there are a lot of data available for epilepsy and that kind of led us to our newer efforts related to motor prosthetics and brain machine interfaces and so today I will talk about collaborations with Professor Richard Anderson at Caltech, who is a pioneer of brain machine interfaces in particular looking at certain regions of the brain AIP, anterior intraparietal, parietal region of the brain that associates with grasping and hand movement. So in this case and this is a patient that has been working with Professor Anderson for many years so we are one of the few groups across the globe who have been able to work with human subjects. So there are penetrating electrodes inside the brain at these three different regions of the brain, SMG, PMV, and S1. So each electrode array is a Utah array with so overall we have hundreds of electrodes and a huge amount of data to basically read the data out and then predict the intention of the patient in terms of moving his hand and usually we train the patient with the center of tasks on the screen with the cursor in the middle of the screen and a patient imagining or trying to move the cursor from the middle point to the points outside to eight different points outside of the center. So the patient this has been actually going on for a few years and it's been quite impressive how patients actually can use this kind of a brain machine interfaces to move a cursor across the screen. So as you can see this is a tetraplegic patient that by thinking is moving a robotic arm that is pointing to to this red screen, red square on the screen. A few groups have been working on this kind of systems but as you can see the system is very bulky. The arrays are inside and there are amplifiers and very big wires coming out, it goes to a Blackrock module, and then it goes to the computer to run the algorithms. So let me first tell you a little bit about what's going on right now. What's the common approach today in terms of reading the data out and controlling the robotic limb? So in most cases, the nice thing about these penetrating electrodes is that really give us single neuron activities so we can do spike detection. For instance, in this case the electrode is reading from two different neurons but we can by looking at the features of the spikes and we can actually perform clustering and separate the two neurons and basically create look at the firing rate of each neuron. So in most systems if you look at them, they actually use this firing rate as their features pair electrode or pair neuron and it is done by creating beams of 50 milliseconds and usually counting the number of spikes in that beam and in most cases then the death spike or firing rates go to a decoder for fun for predicting the kinematics or the movement that the patient intends to to have. And in most cases, a Kalman Filter or a variation of Kalman Filter is used to predict the kinematics. But unfortunately there are a lot of challenges remained for robust brain machine interfaces. First of all, as you see what we saw is completely at the clinical setting so the patient cannot use it by himself or herself they cannot go outside so this is a very controlled setting with experts being attending the patient and connecting to big machines. But in addition to that, there are a lot of non stationary conditions. So what happens if you look at the activity of different electrodes or neurons, they come in, they go out, sometimes they have more importance some electrodes sometimes they have less importance sometimes they're just generating a lot of noise and therefore for each of these sessions even if you have another session, you need to have a training at the beginning to adjust the parameters. So that's a big problem towards moving towards an implantable device that the patient can use in everyday life. So the other issue that patients report is the latency in the loop from the time that they are thinking by the time that a movement is happening and the correction so you would like to have a nimble system that the patient can based on the visual feedback they can correct a movement. So the latency in the loop is another issue and then there are actually a lot of missclassifications so the patient wants to move in one direction and the cursor is moving to the opposite direction and of course there are noise and modeling insufficiencies and errors in the system and of course on top of that for someone like me was interested in implantable devices the hardware complexity of the algorithms and the whole system is mind-blowing and very difficult to move towards variable and implantable devices at this point. So our goal is to basically take steps towards robust and energy-efficient brain-machine interfaces to look at the system as a whole at some point but right now we are not focusing on the front end as you know there are many groups who are focusing on the front end design and digitization we've been for not focusing on the decoding part and also feature engineering. So I will talk a little bit about these two aspects of our project today and I have to be careful about the time to leave enough time for Question and Answer. So we've been looking into instead of using the Wiener Filter and the Kalman Filter to use machine learning algorithms to decoding kinematics. And again from the hardware perspective just a reminder so if you look at a neural network you have the Mac units that do multiplication, addition and then you need a nonlinear function but what really takes energy and increases the power consumption of a chip that does the the inference is the loading of the weights. You need many many number of weights in deep learning and you need to note these weights from a memory to the system so that's really energy hungry to move bits around and then another thing is that you have to also have a memory of the neural data so because what the kinematic depends on not just the neural data at the time being but it requires to look at the history of neural data. So keeping that in mind we also we cannot simply use be sure that we generally simply use feed-forward neural networks and recurrent neural networks would work a lot better because they have this feedback or this kind of memory embedded in them that will allow us to keep track of temporal dependencies especially the short-term temporal dependencies. So we started with very simple recurrent neural networks as our decoder and again as the first step, we didn't touch the feature engineering part so we still are using Spike's or rate of firing as our features lead 50 millisecond things. But instead of the common fixed filter we are replacing it first with just a recurrent neural network. And they perform the same kind of open loop phase of center around reaching tasks that we have sessions of three minutes long and we already have those recorded data so we first started with offline tests of the algorithms and then we actually tested some with algorithms with patients and human subjects in the loop as well. So just to quickly go through this so we observe that actually recurrent neural networks can work very well to a good degree. We are looking here at the correlation coefficients between the actual movement or the target movement versus the predicted prediction of the algorithm so as you can see especially in this patient because of the location of the electrodes, we are doing very well with the Y position prediction and we get a correlation coefficient of 0.75 and it does decent with exposition. Please keep in mind that this is offline. It means that when we do actual online testing because there is a visual feedback, the patient's actually can correct and the system has the potential of performing even better. We also tested this with LSD and with a long short-term memory type of neural networks and again we saw that the performance is promising. The reason that I'm saying is promising is that in comparison with the Kalman Filter, maybe some of you look at this and say oh this is this doesn't look that good especially for X but if you look at the common filter which is the point of reference, you see that these algorithms actually perform a lot better so this was promising for us so then we took a another step and we tried to come up with better algorithms rather than just simple recurrent neural networks especially with the goal of reducing the hardware complexity reducing the number of weights and notes needed as well as reducing the history needed in terms of neural data. So we moved to a dynamic recurrent network, we added an extra derivative estate in the system. We also added a feedback to that system so I'm not gonna go through all the details of it and we built a deep multi-state dynamic recurrence network, a neural network, and we basically use the scheduled sampling to solve training and testing discrepancies because we have feedback in the system and this was again even performing much better. So this is the result for dynamic recurrent neural network for another session and I have to say we test it on many days, many sessions. This is not just one day and we compare it again with the Kalman Filter and also linear models. So this was great promise, it had great promise for us and it was actually presented at New Loops 2019 in December so we showed that this dynamic recurrent network actually  performs much better than previous approaches or simple recurrent networks and it also reduces the hardware complexity by reducing the required history and required number of neurons per layer so this was promising for us in terms of moving towards hardware implementation but we are maybe another thing that I would like to mention is that we've been very interested in making these systems robust. And so instead of using and by robust I mean so that we train it on a number of days and then hopefully we don't need to retrain and the patient can use the system for many days to come and we need to train maybe only once in a while. So therefore for that we moved now to one step back so instead of just using spikes and firing rates we thought about how we can find features that are more stable over time. So basically instead of using spikes we look at the raw digitized neural signals which will include local field potentials, spikes, and all the features across the frequency and we looked at very flat scales and frequency bands as our features this time. And again this is in our paper if you are more interested and be sure that actually we can achieve better performance in terms of robustness over time. So what's going on here is that we train the network for 20 days using different features so then the neural network either receives spikes or different frequency bands or different bayonet features. And the red one are the mid frequency wavelength features that are used for decoder and as you can see the correlation coefficient is very good over time when we train on twenty days and then we test on the following things. So then again this was promising in terms of moving towards more robust neuron networks and where we are today is that we are moving towards hardware implementation of this neural networks on chip they have done a lot of work in terms of pruning and reducing the rates and some novel techniques that hopefully we will publish very soon and we are moving towards implementation of the decoder in 65 nanometer technology. So I would like to also thank all the team members for this project as well. Benyamin has been the lead graduate student and Sahil has been the lead postdoc and Maitreyi was an undergraduate student at Caltech who is now a PhD student at MIT and did her senior thesis with me and this has been very close collaboration with Richard Anderson's lab and his research scientists so I also would like to acknowledge all the funding resources. One thing that I have to mention is that we tested our neural networks with patients and they actually really liked it better than Kalman filter because it's a much faster algorithm and the delay in the loop was reduced. So I would like to stop here but I would be very happy to answer any questions you may have. Should I unmute? Just like to say thank you. Very inspiring, incredible work really loved it. Thanks. Thank you. Thank you for being here and for inviting me. I would like to thank the faculty who invited me today. Can I ask you a question? Sure. I was wondering so if you use the Kalman Filter what with the design features like the richer features we described in the end, does that work fine? Actually I think we did that. It works better than it spikes but not as well as the dynamic recurrent neural network. But that's a good question Miriam I have to actually go back and look at because my student tested a lot of different algorithms and a lot of different features and maybe I have to look back at that to give the most accurate answer but as far as I remember he did that. So we had actually so we are doing a lot of studies right now to understand why actually [inaudible] are performing better over time we have some hypotheses and we're trying to prove that. But another thing that you're doing [inaudible] was our first again attempt because it's a well-known feature. Right now we are actually trying to use a CNN a convolutional neural network to actually generate the features for our next stage of decoder. So that's an ongoing work in terms of how to really improve this feature engineering aspect so that we get better robustness over time. Thank you very much and very interesting so thanks. Thank you. So for the localization system are you continuing to develop that further seems very- yes actually for that we are about to form a company-- startup company-- because the most research part is/has been done at Caltech so now we are kind of moving to start a company and do the rest in terms of commercialization in a company. You have time for a few more questions? I wasn't sure exactly if I went overtime or under time. No this was perfect. So I'll ask a couple of questions. So back to the implantable devices with the communication in the radio I noticed the size of it I was trying to understand the size of the coil there was one picture where you showed a number of coils stacked up obviously that's the source that you'd have outside the body but for the implantable coil roughly how large are those things? And the other question I have is you know in these I do a little bit of work with the radiology group here with radios for positron emission tomography systems which are increasingly combined with MRI as you know. So you know if you come up with something it has to exist in you know the environment with the MRI so I kind of wonder about the the interference of any type of communication that you might have going with implantable devices not just for imaging but also for a neural interface and is in general for anything that you implant in the body that basically the selectivity requirements of the radio how sensitive is it to interference? These are great questions so Chris let me first show you maybe some of the initial devices. So the first complete wireless device that we built was this glucose sensor so this is the on chip antenna this is about 1.2 millimeter by 1.2 millimeter and it operates at around 915 megahertz close to one gigahertz so its wireless power and back scattering face. But this is not going deep into the body this is a subcutaneous device and we made the device very low-power this is a 5 microwatt device and then for the atom's device we had a similar kind of design that was this one so again it has an on-chip antenna this one is a little bit bigger but about the same kind of principle and it operated in the mines because again it was a small mines and we could easily perform the power and data telemetry but going back to the orthopedic surgery where we want to go deeper inside the body so this is so in this device we actually move to lower frequency this is about the iesson band that is around 10 megahertz and the antenna is actually going around the PCB and this is the size right now. So the size was given so we worked with an implant company so the titanium rod is actually quite big and it has many holes in it so let me see if I can show you another slide that shows the titanium rod and how this sits on top of the titanium rod so in terms of its size it wasn't a problem because I don't know if you see this slide or should I share- yeah I can see- do you see the titanium rod? Yep. So basically the size is not a big problem in some of these orthopedic surgeries because we are dealing with big bones and big implants and we can simply put a device here and again the size was also partially because we used an external magnetic sensor in this case. So in this case power delivery was easy because we use this external coil not an on-chip coil so that's the first question overall it goes really hand-in-hand with total power consumption again here our power consumption was hired because of this big magnetic sensor but eventually if we can have everything on a single chip we can have a smaller chip, lower power and maybe again integrate the antenna on chip. But this remains a big challenge power delivery inside the body remains a big challenge and has been really for us- particularly if you try to put the antenna on chip that's going to be I mean the antenna efficiency is going to be actually that is so the one that was on the chip do you know what kind of antenna efficiency you were getting roughly? I don't remember the exact antenna efficiency but the over loss was minus 45 dB. Okay. So it's very lossy for even a centimeter of tissue. Of course it depends on the tissue depth so really there is a lot of absorption in the tissue and the antenna is so tiny so you don't get much power but at the same time, you're trying to make the chips really really low power. We made the power management extremely efficient as efficient as we can so the optimization that at the end you get to a point that the device can work but remains a big challenge I acknowledge that. In terms of your second question, was it more of MRI compatibility or interferences between different devices? MRI compatibility but then I extended the question to just generally speaking interference before implantable devices, you know in general something we might put in the body and interference with the communication. So it actually may be the fact that the device is like the tissue is so lossy, the device is so small, it helps us actually not worry too much about interferences because anybody so if you have to get very close to detect a signal. So we haven't seen much of interferences because again overall it's close, it's near field proximity and there are a lot of the signals are very weak so they don't interfere with each other but interference from external devices at least we the glucose sensor we didn't have any because again you're using the is ISM bands and I'm not sure if that would be eventually a problem if they have many on these devices. That's what I wonder actually, yeah and you know even if you look at ISM band you know you still have some cellphone bands right around the gigahertz right so it's not too far away and I just wonder if somebody wanders underneath the base station you know in the future if you if you've got some of these devices how sensitive is it to that yes you get enormous isolation inside the body but then we're talking about in some cases, we are talking about huge signals. In the case of MRI it's just you know fields are just enormous so it's I think it's an interesting open-ended question at this point. Exactly and especially a lot of these devices will not work in MRI so MRI compatibility is one hand and whether they would operate while under MRI is I don't think any of these devices will operate correctly. Unless perhaps if you went way up in frequency so in the millimeter wave band right so the field sit so actually this is something we've looked at well okay I don't want to take away from other people asking questions, I'll... that's an offline type discussion. Sounds good, but definitely is very interesting... But there are a lot of open lot of open questions left a lot of technical challenges left in this domain. Azita, that was a fantastic talk, thank you. I just had a quick question or point of clarification, does the does the orientation of the chip inside the body affect your ability to localize and are there like can you comment on if that's the case can you comment on whether like calibration routines are required to remove the ambiguity that may result from from orientation especially ambiguity? That's actually a great question and in the first prototype we actually had that so we need to first create a relatively uniform magnetic field to estimate the angles. So we actually in our published paper we discuss how we can actually find the direction by first having an extra phase that we will apply a relatively constant magnetic field. Constant in terms of in one direction. But in this particular magnetic field the sensor actually it gives us a vector so we actually can measure direction with this with this commercial magnetic sensor but it's definitely it's a great question whether in certain orthopedic surgeries the orientation of course matters as well not only the XYZ position. Right, because I was just imagining if the if the angle varies then you almost end up with a contour of possible locations for any given readout in in 3D but I see okay I'll follow up with questions on that. But that's definitely a good question and we've been addressing that as I mentioned in the first paper, we addressed how we can do that with an adding one extra phase to the measurement. Any other questions from the audience? Yeah I had a quick question, great talk, going back to the neural interfaces work at the end you made a comment that the in using it testing the algorithms in real-time with the patients that they particularly responded to sort of an improved reduced latency and I wasn't entirely clear where that improved latency came from in the algorithm so I wondered if you could clarify. That's a good question so overall it seems that we have a little bit less delay in the system but also it seems that the algorithm also learns better in terms of translation to kinematics and because of that the patient felt so what we do we give a questionnaire to the patient after each session that they rank different like they first test with common and then they test with RNN and then we DRNN so so they give us some testing in terms of how it felt and did they feel in control. So it seemed that so they DRNN and actually got the highest ranking because the patient felt a lot more in control. And also it felt he felt that the system responded better to the way that he intended. Again it's not exactly clear what he meant by it but he felt that he is more in control and that's a good question for us also to understand really what it means but our hypothesis is that because the system is more robust the patient has this feeling that doesn't need to correct every time that is trying to move and visually look and then we correct and we correct. Great, thank you. Yeah can I ask a quick question? Of course. Thanks for the great talk, I had a question about the different neural networks that you have applied for decoding. Have you tried sequence the sequence recurrent neural networks? Those seem to be pretty effective in terms of extracting features from the decoder towards the encoder and the in the combination in between the two. So to use it right before the decoder? Yeah so you would train the you would have like an encoding sequence and then the coding sequence and you would like to reproduce the same sequence and the connection between encoding and decoding will give you in many cases it turns out that it will give preferable features. Actually now that you mentioned that I believe my students read few papers on this and he wanted to try it but we have not tried that yet. Yeah sounds good. Right now what we are trying to do now we have shifted a little bit into feature engineering so but that's a great suggestion to look into that as well. Yeah we are developing such methods and I've seen for what is in terms of unsupervised feature extraction and clustering so I can follow up. Yeah that would be great I would love to talk to you more about this because we briefly discussed this with my student and he had seen good papers in this domain but we haven't yet gotten to that point to try them. Yeah and this is an exciting application to try to and accept those. That would be great if you send me an email I see your name actually but if you send me an email down. Yeah sure. Thank you so I guess I don't see any other questions so thank you so much for again attending and inviting me it was really fun and I hope that I can actually come and visit you next year. We were looking forward to that. So shall we wrap up? Yes I think that's a wrap if there are no questions. Please yes do thank the speaker with your with your clap icon it's what we reduced to in these times but thank you so much. Thank you. 