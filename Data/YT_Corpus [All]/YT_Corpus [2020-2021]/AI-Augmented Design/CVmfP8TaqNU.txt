 all right hey welcome welcome to our session developing mobile augmented reality applications with actual spatial anchors so in this session we're first going to tell you why you should care about agile spatial anchors why it's an important technology and why we need the cloud for that right and why you actually want to target mobile AR as well and then I will tell you a couple of examples lots of scenarios for consumer as well as enterprise use cases and then Paris will actually explain a little bit about the underlying technology we will also have a demo you will later on get the source code on github for native iOS and Android application and then Paris will also tell you a little bit about us UX best practices and at the end we should have time for some Q&A first please introduce yourself awesome hi everyone I'm Paris and I'm an engineer on the azure mixed reality services team I specifically work on client side for our spatial anchors so I touched SDK and the developer experience great hey I'm Renee I'm director global innovation at valorum replay we're a digital transformation firm pretty much focused on the Microsoft stack ranging from agile including IOT M 365 Oz to the intelligent edge like hololens and we have been doing mixed reality since 2015 being part of the mixed reality apartment program but even before that I have been doing a mobile AR for example I created an open source project called slot to a kid which is a port of the famous arrow to kid I did like nine or ten years ago you might also notice this light says Microsoft regional director and MEP so just to be clear these are awards that Microsoft provides two independent experts so I don't work for Microsoft I just love to technology and being part of the community and that's amazing because I can be here on stage and talk to you about this interesting technology and for example why you should care about mobile AR right why is mobile all relevant if we have devices like the hololens - with all these amazing sensors right why should we care about mobile AR in the end well let's take a look at some numbers here God law predicts that by next year 100 million consumers will shop an AR online as well as retail and especially for retail experiences I can imagine a lot of value being added by a persistent content that can also be shared across devices right and more about that later in a couple of slides I will show you some scenarios but also take a look at the right-hand side of that slide you can see it that data that data is from new to an armed company and they say in September 2018 that 26 percent of all active iOS and Android devices supported either a or kid or air core right he's advanced a or SDKs and by now it might be fair to say and may 20 19 it's probably more than one-third of all active iOS and Android devices that have these built in advanced AR capabilities you can use with special anchors right so you can do the math yourself but it's a huge market to tap into right so if we have these devices with these advanced air or capabilities built-in why would we use Ashville right why why does agile make sense here well all of these devices have a view of the digital world in their own device right and so taking it out of just the device view basically and merging those together from all the different devices that can be enabled with the cloud right that can be enabled with special anchors and you can have these unified view of the digital world and of course you can securely store it which means you can enable these persistent experiences right you can store it securely and as well and so these devices perceive the real world in a certain way and a couple of you are pretty much familiar with it but just to make sure we're all in the same page so here's a video I recall it with my Android AR core enabled phone that shows you how it perceives the real world right so what you can see here these blue dots or feature points and then you can also see these planes is this grid overlay right and so that grid overlay currently AR core supports surface planes for horizontal and vertical planes so basically the device can reconstruct where both planes vertical and horizontal and you can place virtual content on it this weird guy that is scanned in 3d and of course it works outdoors right so you can also scan it outdoors and so that is the view of my Android device if I would use now an iOS device or different Android device it would have a slightly different view of the real world right well take a hall lens for example so here's a similar scene recall it with the hall ends and of course the hall ends with having more senseless it has a more detailed view of the real world and it can reconstruct its spatial mesh and a little bit more detail but again right it's digital representation this is how the device sees the world and you can bring in content have it interact with the real world and what but what we really want is we want to step out from our local view and step into this global for you right having these merged experiences from all different devices providing cross-platform experiences where we can place content right so we can drop virtual content in the real world on these surfaces and we can also anchor that content there which means that content will stay at the exact same position so you might ask what is the spatial anchor what is that concept of an anchor well let's talk a little bit about that an anchor is basically a special point in the real world where the tracking system will make sure that the position and orientation of that point will stay in relation to the real world which means even if you walk around right go back go forward this anchor will stay at the exact same position right so the tracking system then assigns a coordinate system or that anchor is a coordinate system and then on that anchor on that coordinate system you can attach virtual content to it which means if that content is anchored if that content is related to that anchor it will make sure it stays at that position even if you walk around right but again the anchor is really just the location it's not the content you can you know attach any content to it if you want so that is a spatial angle right just local on the device and hololens supports it your kid supports it a or cor magically all of these platforms have a concept of a spatial anchor they might just call it a little bit differently but they all have that concept right so what is a cloud spatial anguillan well anchor us you can upload these anchors that we created on your device to the actual spatial anchor servers and then you can have your friend for example come in use use its own device download that anchor from eros special anchor servers then it will map that anchor from the aero special anchor servers into the devices local local tracking system and then well can see the same content at the exact same position right so you can enable these kind of shared cross-platform experiences with a geospatial anchors that normalizes these kind of different views right and you can persist it right I can come back week later content is still there I can still see it at the exact same position pretty hot research topic at the moment a couple of startups in its base as well as the big players but I can tell you Microsoft virtual special anchors is really the only one that provides true persistence right they have really a leap forward compared to all those in the market a purse we'll explain later to you how the data actually looks under the hood like what is a spatial anchor in terms of data how the future points of stores but I want to go on and show you some tests and some more examples that make the abstract concept a little bit more feasible all right so yeah what I said right download the anchor and you can see the same data a week later at the exact same spot all right so here's a video I recorded with my android phone as well as a whole lens so this is about cross-platform shared experiences some of you might have seen it online before but if not take a look basically I created that anchor with my android phone right so that's recall it from the Android phone I create the anchor upload it to the actual spatial anchor service now this is the first-person view of the hololens now right so I load that anchor from a geospatial anchor service into the hall lens and then I can see the content at the exact same position so you can see me holding my phone in front it's really align really well and so when I did these kind of tests I was really surprised how good the accuracy actually is it is fantastic we're talking about centimeter rain's position your reign and again that is not using any GPS it's purely based on computer vision it's purely based on the actual spatial anchor of computer vision if we would use GPS we would probably get middle range kind of procedure rain and with this with the computer vision we can get in the centimeter range of precision though you can still combine both right it totally makes sense actually if you think about you could use GPS for furthering film narrowing down the source space you could say okay only I'm only interested in all the anchor IDs that are like 100 meters around me so you can just load those and just search for them later on right so it totally makes sense to actually use GPS or Wi-Fi IDs Wi-Fi fingerprinting these kind of technologies and combine it with a geospatial anchors you get to the really detailed matching and degrade accuracy all right so this is cross-platform shut experiences let's take a look at persistence so some of you might know the famous Pike Place Market in Seattle just I'm just down the street and so what I did in March doing the MEP summit I went there and created an agile spatial anchor and saved it of course okay so there's the anchor and a couple of days later I went back and we localized it and as you can see well uh it's right there at the exact same position what you also might be able to notice the floor peplum changed right when I created the anchor it was wet when I relocated the anchor and dried up also a lot of people moving around so a lot of dynamic scene changes that are really challenging for the slam for the computer vision under the hood and I was again really surprised how well it works and how good their courtesy actually is and no GPS again right just purely computer vision just pure the power of a geospatial anchors okay so Tesla done let's talk about Enterprise scenarios and like I mentioned we have been working with enterprises since many years so what I did here I extracted some common use cases which I'm going through now in a couple of different categories and then we're talking first enterprise then we're going into consumer scenarios so let's talk about the first use case category which is about multi use of shared experiences with persisted content as you can see on the photo here we have these kind of collaborative design reviews so the lady is wearing a hololens two other people are using different tablets and the good thing is they can see the same content at exact same location even though they use different devices so the business value here is really that we can visualize these kind of complex 3d data in these cross-functional teams right and therefore increase business value that will increase cost and quality because you can you know much easier or collaborate on that virtual content or of course you know seeing real-time sensor data on the actually equipment so you can for example have like here in the photo a control panel on on a sensor and can see the actually sensor data in real time at the actually machinery if you think about what you need to do now there's like it come you know complex control room panel you need to search through all that data and so on and with that you can easily you look up the data I just go to your machine and see it right on spot and of course you know get much faster information and save a lot of time training guidance so I'm going to show you a video of an app we did for a client awhile ago which is for an automotive seat assembly and the challenge there was basically they have quite a bit of turnover rate so you know new employees come in they need to be trained and so on and they just have a limited amount of trainers on staff so what we did with that app is basically you know enabling empowering to trainees to train these easy steps themself so you can see these holographic overlays right and so they can learn how to assemble an automotive seat so you might wonder how do we actually know where to position the virtual content on top of the real seat right as you see it's it's really nicely alliant so what we're using here is a fiducial mark or right you can see the marker that highlighted some call them a or mark or image target QR code whatever right but these kind of traditional mark will help us to find the reference point in the real world and then we know the offset where to actually position the virtual content so why am I telling you that well with agile special anchors we can get rid of those we don't need any fiducial markers anymore because as you probably if you created some of these fiducial markers before it can be quite cumbersome right you need to add a design and then you need to print them and test the size and maybe change something and reprint and you know kind of iterative process so if we use a geospatial anchors what we can do we can just use a phone you know go inside it and scan the position in the room and create an anchor net will be our reference point right we can create this Markel as tracking data on the fly and persist it so we don't have to deal with you know ugly fiducial markers anymore and of course all the benefit is pores right no like extra kind of thingy on top of that which might be annoying for if you think about like automotive or about trade shows but I really don't want you have any stickers attached to anything right so that's really really a big value add I think the knowledge came Cory is wayfinding and Paris will explain to you later on how that actually works under the hood with some with a graph but just think about if you create an anchor and then you create actually multiple anchors in the same session they will be connected with each other right so you can have these kind of wayfinding snores okay go do this next anger and so on so take a look at the photo that's the Boeing plant up in Everett here it's a huge facility and they actually offer a tour so if you haven't had been there I would highly recommend take the tour it's really really amazing but can you imagine it's like your first day on site and all you get is like this kind of map and I tell you yeah I find your colleague in the section PCE 45 or whatever I would highly struggle I would probably have to you know interrupt coworkers Esther and why do you need to go and so on and so forth well we've added spatial anchors we can create these wayfinding experiences right and so they can just pull out the phone and they actually get navigated where I need to go save a lot of time you know increasing employee productivity and all the business value is of course with actual special anchors you can actually securely map your facility in 3d because it's not storing any photos or stuff right it's really just storing a sparse point cloud again Paris will explain that to you much later but it's really the high benefit is you can securely map your 3d environment all right there's another story so think about this one there is an engineer in the control room and a sewing machine is failing so they see like on a control room panel like an LED or whatever right is blinking oh this machine is failing so what they need to do now is they need to go like some some instructions or some maps to find okay well maybe blueprints right where I do I need to go where's that machine why is the sense or and so on and so forth now think about if we would enable them with an app on a phone or Hall ends they can just look it up on the control room panel for example take the phone and hold it up in front of the control room panel then we have some computer vision that recognizes which kind of sense will is and then it loads the data from actual spatial anchors and guides the user to the action machine where it is failing right and so getting down much faster will save a lot of money but as you probably know if you're working with enterprises like certain facilities if they just shut down for a couple of minutes it costs hundred thousand followers so just saving a couple of minutes or even seconds can be huge time saver here it's a lot of business potential there may be getting warehouses well that's pretty pretty clear right so think about you know need to fulfil all or pick up certain stuff and we can also provide dynamic information go there and you know pick that kind of stuff up and so we can business value increase efficiency and also less packaging errors in the end cool let's talk about consumer scenarios because like I mentioned there are so many devices out there that are enabled with it right Android AR core iPhone a orchid hall at all ends and so it's a huge market and of course pretty much everyone has a smartphone and many of them actually support these advanced AR capabilities so here's the first one again wayfinding think about is facial aware a grocery list right so you can go to the grocery store and create these anchors at certain locations at Salton aisles with the favorite products or for example when my wife sends me grocery shopping I always struggle with I never I don't go that often right so I always struggle to find the stuff so it would be awesome if she would create these anchors and then I just pull out my phone and it tells me oh go there I picked this up go there I picked that up right that would save me a lot of time I would be so happy to have that well take a look at this this was a couple of days ago I really at the node on the left side then I went into the store and created these anchors it's by the way the demo app you're going to get later and so you could create these anchors with like what you need to buy now thinking about you can actually share that angle data with the store so the store can access that if you want of course and so they could say ok we noticed you buy the product very often here's a $2.00 discount and they can drop that info they can drop that at the anchor order right right at the position so for retail there's a huge huge potential I think because as we all know brick-and-mortar stores have been struggling with all the retail competition throughout the last couple of years but with these advanced a our capabilities and scenarios we can actually you know increase foot traffic area bring more people in and it doesn't have to only be wayfinding also think about sampling virtual products right right at the location for example you have some modular components and then you can actually see the real object and then you know see some virtual esses wars you can't they don't have in stock for at the moment but you can violate all right it's a lot of these scenarios are possible for retail we just talked about visual content right we justify talked about adding visual content to anchors but like I mentioned initially an anchor is really just a location in the real world so we can actually not just attach visual content but also audio content so we could for example use spatial sound for navigating so if you're not familiar with spatial sound spatial sound is basically a way that that you as a human you know where a sound is coming from in the world right so you know ok I hear the sound there I need to go in this direction right and so we can use that we can drop spatial sound and anchors and then you know empower everyone to navigate so let me show you really a quick video work from an app called seeing-eye it's a Microsoft and Tolan product which was just enhanced with some really nice features I'll take a look at the video [Music] navigate to my next minute your next meeting is with Juliet in Studio C would you like me to guide you yes are you starting from the lobby of Studio C yes and your phone to map the room follow the audio breadcrumbs to conference room 1200 where can I sit and your phone to map the room table at 12 o'clock empty seat located at 11 o'clock [Music] that's pretty awesome isn't it I really loved it but I don't take credit for it right it's from the seeing-eye team but I love what they did their tale using agile spatial anchors really to empower everyone and for these kind of navigation stories and yeah love well Microsoft is going with the whole AI poor good movement it's it's really awesome all righty let's go on there you finding thinking about navigating areas like a museum theme park festival and so on so here's a video I got from our friends at Studio 0-5 in the Netherlands and it's a concept they made well theme park navigation again that's a concept but they could make it real now with agile special anchors actually you have your favorite theme park to go right it shows you where I need to go and it can even pull in dynamic information so it can for example tell you okay if you go left 50 many wedding times if you would go right 30 minutes waiting times right of course you go left and follow our friend and yeah you save a lot of time and you would be pretty happy I guess so yeah a lot of lot of business value in terms of like engaging customer experiences right but there's this odd like pork leap up walking sign which kind of ruins the whole thing so we enhance it with some digital content on it and for example our good old friend clip here right and you know what it doesn't have to be clip Ian 2d we can have Clippy and Freedy all right but but joke aside think about all these social media apps with day off filters right these are very like you know only an experience for yourself right if you use these air filters you can create the yeast a or filters but it's just for yourself now if if you think about without a special anchors you can actually share them with other people and even can persist them right and they would work at any location not just some specific hand-picked location as as we see these days and so you know and the good thing is you can even have customized persistence so you can define the expiration date you could say okay this virtual content dies off to a couple minutes hours days or could be there forever all right so huge potential for these kind of social engaging applications architectural visualization so this is a photo these polls basically define how big a building will be before it's being built right so then actually neighbors can also come in and oppose against it right they see oh that's a huge building I don't want to have that there and nothing about it's quite a you know tgs and laborious work to set up these polls right now think about they would just set them up virtually construction company architect comes on site sets up these polls as no special anchors maybe it leaves a QR code there right then you can download an app and see that stuff and it doesn't only have to be this ugly polls they could actually visualize the real building they could actually visualize a cat model of that building how it will look like when it's actually being built and so the neighbors might actually get a pose against it because they don't just like see some polls and imagine their head oh that's a big cube no they can actually see if it's it will be a nice building and so you get much better commitment and it also think about not just the private sector also think about the public sector right there are sometimes these highly controversial projects like Airport expansions bridges and that kind of stuff and in Germany there's a lot of controversial around that stuff all the time so having these kind of applications that visualize it on site and have these persisted experiences can save you a lot of money and so business value is really here you know not just reducing the work of setting up these kind of polls for the specific examples but if you broaden the range metal visualization means better commitment and in the end cost saving well marketing in ads right that's that's pretty clear so here's a video drop the valoran reply logo recorded a video shot it online had a little bit of wind and yeah I mean you can do a lot of engaging customer experiences there of course if we talk about advertisement we need to think about privacy good thing is it's all safe as all private because actual special anchor Soames is connected to tenant which means everyone can have the own view the own layer of the points of interest so here's the video took my road bike went out to the place I live we have some beautiful rocks there and went up the hill and then you know special anchor there with a point of interest information so it tells you like about this beautiful region just text in this case right but think about tourist agencies they kind of just set up text there they could have like really nice engaging experiences could be a video could be an interactive content so he's kind of really engaging experiences for users and of course you know you can reduce the cost setting up these signs but I think the even higher value is you know providing these engaging experiences and you know there are so many tourist regions competing all the time is like you know using innovative technology to set yourself apart from the competition and of course games I mean agile spatial anchors screams games like that is perfect for games so the thing about hide-and-seek games you know kind of skeptic and Shahani games any kind of location-based social engaging games could be possible with these kind of multi use or cross-platform experiences and the really really nice thing what I love about agile special anchors is that it actually demo critized this location-based a or game development because anyone can build a real pokum and go now basically right so here's a video went to Bellevue in Redmond created some anchors all over the place and then attached some virtual fruits to it and persisted them so they are still there good thing is no one will slip on a virtual banana it's safe they left there and sidewalk yeah so you know cruelly anchors all over the place in Bellevue and Redmond and yeah I might come back at some point and develop my fruit hunt game so I have the basis for that now anyway I hope the last couple of examples gave you some inspiration sparked some ideas for your own projects now Paris is actually explaining you how you can build easy island awesome thank you Renee so I'm still waiting for the banana game but to help everyone build that game I want to get into a little bit more detail on as your special anchors and how you can build apps for it so to start let's revisit this diagram because it's really important that we're all together on what is a spatial anchor and what is a cloud spatial anchor a spatial anchor like Renee discussed is a common frame of reference between the digital and physical world so you have this spatial anchor and you can render a hologram there the spatial anchor is that location not the rocket ship if you want to share that location with as your spatial anchors you can send it up to as your spatial anchors which I'm gonna abbreviate to a sa from now on sometimes and when your friend comes they can get the location sent to them and then render a hologram there as well so to give you a little insight onto what's going on here I want to show you a picture that I know really well because this is the lobby of my building at work I want to then show you what as your spatial anchor sees when it looks at that so in this gift there are three main things going on first in green our feature points future points are areas of high visual contrast they're areas where there was an edge or a corner that went from dark to light or a place where maybe if you look at your badge your writing was on it and it went from white to black we get feature points by passing in camera frames to our algorithms so what you're seeing here in red are each of the camera frames that a mobile device is passing into as your spatial anchors next in the bottom left you're seeing a spatial anchor so that white sphere is a place in the real world that somebody said I care about this I'm in a place in anchor here and so that can later retrieve it I want to note that all of the processing that we're doing to go from these camera frames to our feature points is happening on the device so we're not sending these images up to the cloud with that in mind I want to talk about three things now first how do you build an app for collaboration next how do we extend that to build a wayfinding up and then finally let's talk a little bit about UX when building with a ese so to start we're cross-platform so you can build for hololens iOS or Android and you can build in unity or you can write native code in this example we're mostly going to focus on a Java Android app but the concepts are pretty universal across all platforms and development environments so let's show a demo first before today we built an app that was similar to Rene's factory floor example where he showed you how by placing notes on a car assembly line you're able to save money for the business because they can just render that hologram right on the car seat so I'm now gonna switch over and I'm gonna show you an Android app before today I placed a note up here and what you're gonna see is I'm going to open up the app and we're gonna scan around for keyframes we're gonna scan around for feature points from camera frames so here we are opening the app and we're looking for that anchor right now hey our core is right now looking for a plane which is just found and there we go hello world so we now have an anchor at that place that we found let's place a new anchor so we'll do a smiley face right now as your spacial anchors is getting camera frames and turning him into feature points we went yellow when we had enough data about the environment to save - as your spatial anchors and we went blue when the anchor has been successfully saved so let's imagine a week passes and we want to find these same two anchors Renee is gonna come up now and we're gonna show you how both on this Android device and an iOS device you can find those same two anchors so I'm gonna open up my up and Ray's gonna open up his and there we go smiley face in hello world and Renee also got it so live demo worked awesome [Applause] so let's go back and let's talk a little bit about how we built this I'm going to show you a diagram that's our architecture for the app so there's three main things going on this diagram first we have some client code so we have an iOS app that we're it and wrote in Swift using a our kit and scene kit and we've been Android app and Java using air core and seen form next we have as your spatial anchors which is how we're saving anchors and finding them later and finally we have what we're calling the sharing service this isn't actually an azure service we're just calling it that in this case it's made up of two things in Azure app service asp.net Web API lets you do post calls get calls and ASRA cosmos DB table storage as a database together they help us save information about anchors that we need to save I will give you more detail on that but before we do that I want to jump into some API key concepts for a SA so at the root of a SA is the cloud spatial anchor session and first it provides course services so through it you create anchors locate then update their properties or delete them and second it captures data about the environment when I say that I mean on mobile devices you're passing in camera frames to the session orna hololens we're getting the map from hololens and passing it in ourselves next we have the anchor and the really key thing I want to call out here is that it links to the underlying AR platform anchor so if you're writing a hololens up and you have a world anchor you set that as a property on the cloud spatial anchor or if you're on iOS you use an AR anchor or Android and anchor so you don't have to do any conversion math you just set the anchor that you're used to working with on the platform of your choice as a property on our cloud spatial anchor object-- next it holds a unique ID and expiration date and a bag of properties when you're ready to create an anchor and by that I mean you have an anchor and you to save it to the cloud you're gonna call create anchor async on this cloud spatial anchor in return we're gonna give you a cloud spatial anchor in a callback the difference between the anchor that you're about to save and the anchor that we give you back is that it has an ID assigned so when you're just writing your app you won't have IDs it's only once you actually save them when you're ready to locate anchors so for example up here we want to define those two we're gonna use the concept of a watcher and a watcher is something that looks for anchors that meet the specified criteria I promise I'll tell you what criteria are in a second but when they find anchors that meet the specified criteria you'll get back those objects through a delegate or a callback the interesting thing about the anchors that come back is they will have that underlying error platform assigned as a property so here you saw we had an iOS app and an Android app I created an anchor I created a cloud spatial anchor in Android and I was able to find it on iOS when I was on iOS I was given back that AR anchor even though I created the cloud spatial anchor with the AR core anchor so that's the aspect of cross-platform that we talk about is that we do the conversion between different systems and you get to work with whatever you want the criteria that I promised our anchor locate criteria and it's an array of IDs so you might be looking this and saying ok I create an anchor and I get back an ID later what I want to find anchors I need to give you IDs so where do I put those IDs that's where we have the sharing service the sharing service is just in a database of IDs because it's not really important what the implementation details are for this talk we're just gonna simplify it and just think of it as a database it's a database that stores IDs so what else is going on in here there's three main things first we're initializing a session then we're creating an anchor and finally we're locating the anchors so if we walk through how data is flowing first we saved the anchor to a ese in return we get an ID we save that ID to the database and we've created an anchor when we're ready to locate anchors we're gonna get the IDS in the database tell them to aasa through the criteria that we set on a watcher and get back the anchors in between steps five and six you're scanning your phone around to get environment data one thing I want to call out before we move on is that you write this yourself so in this app that we wrote we just use the key of build 2019 and that's how we selected the grouping of anchors that we wanted to look for but you could use other things you could use GPS to kind of narrow it down to anchors maybe around you and then you look for those or we could use user ID or some other app specific property with that preface I want to show you four slides of code that will step you through one two and three and we're gonna go forward in my favorite IDE which is PowerPoint so here we are in step one initializing a session and we're in oncreate which is like start in unity or Veta duo done iOS to start we're gonna set up our a our corn scene form things I'm using ellipses here to emit code that you can see on github or you can see in many a our sample apps but basically here we have seen view and scene which are seen form concepts next we're gonna initialize the cloud spatial anchor session first it was the session we're gonna set a log level and we're gonna set an account ID and an account key which you get from Azure comm after that we're gonna set up for the frame listener the update listener and what this does is it gives frames to as your spatial anchors so when the gif I showed you we had the many key frames or camera frames that were being turned into feature points this is how we give as your spatial anchors those camera frames this on update listener is a Java concept basically it will be called every time a our core has a new camera frame to give in return we're gonna call process frame on that camera frame so this is one side of the handshake them about to show you we give camera frames to as your special anchors in return as your special anchors is gonna give us back a float that tells us how much information about the environment it has so we're doing this cloud session dot session updated listener this will be called by Azure spacial anchors and it will tell us when we're ready to create an anchor session updated will be a float and when it gets to one that is us that is as your spatial anchors telling you as an app you can save an anchor we know about the environment so here we have this handshake give frames to as our spatial anchors in return you'll get back a float 0 to 2 when it gets to 1 you're ready to save an anchor will throw an error if you save an anchor too early because you don't have enough environment information now that we've initialized the session we're ready to create an anchor before we can create an anchor we need to choose a place in the real world to place that anchor what we're gonna do is set this on tap a our plane listener which is an AR core concept what its gonna do is say whenever the user taps on the phone and it's tapping on a plane so a horizontal space or vertical space call this handled tap method and we get to write the handle tab method ourselves so let's go in and write that handle tap method which will let us create an anchor we're gonna get passed in a hit result and with that hit result we're gonna create an AR cor anchor creating an Air Corps anchor is pretty much a raycast down into the real world so we're gonna say hit result create anchor raycast down from 2d space into 3d space and we now have our spatial anchor after that we can render a white sphere so you saw how I tap to place and there was a white sphere for a little bit that was us just rendering a local air core anchor know as your spatial anchors kind of Java Android concepts next here comes the magic we're gonna create the cloud spatial anchor and we're gonna set the local anchor as that a our core anchor so here is us setting the underlying AR platform anchor on the cloud spatial anchor after that we're gonna prompt the user to input a note so that was the smiley face that I type dinner we're gonna then set it as a property on the cloud spatial anchor so we have a string string dictionary and you can set things that you want on there next we're gonna wait until we have an update about the environment Swint so when I talked about that handshake that here's camera frames give us back a number we're waiting until we get above one so we know enough about the environment once we get to there we can save it - as your spatial anchors so we're gonna save it and wait for a callback that callback will have the cloud spatial anchor with an ID assigned we're going to update the sphere color to blue because we successfully saved the anchor and then we're gonna save the ID to the sharing service so with this we created an anchor in the real world using a r chord we saved a cloud spatial anchor - as your spatial anchors and then we save that ID to this sharing service on the other side of things we're gonna look at the anchor and we're gonna start from the sharing service we're then gonna do a get call and we're gonna get this list of identifiers like we talked about before in this case we're just using a key you could use GPS or another way to filter down the anchors you're interested in once you have the anchor IDs you're interested in you're gonna create a watcher to create a watcher you create your criteria you set the identifiers as that list of identify as you're interested in and then you tell as your spatial anchors clouds that should not create watcher now as you pan your phone around and we get feature points in the real world we'll be trying to match those feature points to the feature points we've saved that line up with those identifiers when we find anchors we need a way to tell you about them so let's go back to that code we wrote for initializing this session and add something that we forgot what we're gonna add is an anchor located listener so this is a callback that will get called once we've found an anchor there are several statuses that can occur he we're just gonna show located another option is not located does not exist and that could come up if you give us a bad identifier that we don't know about so here we found one and so we have the locate anchor status of located now we're gonna get the AR core anchor from that cloud spatial anchor and I want to highlight again this is the really cool part you're going from a cloud spatial anchor and just grabbing the property of that local anchor and that is a point in the real world so it doesn't matter whether it was created in Hollands iOS or Android you get it on whatever platform you want it on we can then render a green sphere there get that note that it's on a dictionary and render it as well and now we've completed the app so with this we can initialize a session create a cloud anchor cloud spatial anchor and then locate that anchor so I hope this is a good starting point for you to build apps that enabled you to place persistent content in the real world but one thing I didn't show you here is how do you do wayfinding how do these anchors that you're looking by ID actually line up with the ability to way find around a location and the thing I haven't told you yet is that anchors are connected in a graph so to illustrate that point I'm gonna walk you through a scenario here we have in that box a session a session is basically you open up your app and you're scanning around first we create and Kure so we tapped on the real world and we created an anchor we then moved somewhere and we created anchor B in the graph a and B are now connected and they're connected because we knew the location of both anchors at the same time in the same session we then close that session and start a new session so we close the app and we open the up again if we find anchor a a and B are still connected in the graph if we then move somewhere and create anchor C a and C will now be connected they'll be connected because we knew the location of both of them in the real world in the same session now let's move somewhere else so we walked over to that corner and we locate anchor D and anchor D is an anchor that we placed a month ago and it hasn't interacted with anything since but we're able to locate it by ID and what happens then is C and D are connected and a and D are connected and they're connected again because we knew the location of all of them at the same time so what does this mean for you when you're writing apps well I showed you how to locate anchors by ID but there's another way you can locate anchors and that's by locating anchors connected to an anchor you've already located so let's imagine we first locate an anchor by ID and in that callback we get back a cod spatial anchor it has that local anchor property on it after that we'll then create a new method locate nearby anchors and we'll be passed in that anchor so that's an anchor that's been located will create a new criteria called this near anchor criteria set the source anchor of the anchor that's already been found and then we'll go back to our anchor locate criteria set the near anchor as that near anchor criteria and create a watcher semantically what this means is you found that cloud spatial anchor and you want to find anchors connected to it connected to it you can set a property which is the radius so you can say find me all anchors within 2 meters 5 meters 10 meters and as your special anchors will fan out in the graph and return anchors that satisfy that property if we go back to the diagram let's choose D to be our source anchor we choose D to be our source anchor we'll get back a and C and we'll also get back B because all of them are connected in the graph if you think about this on a larger scale say a factory floor or an amusement park if the entire area was look was connected with anchors you could start in one location and get to the other and you can get to the other in the real world these are real points as an example of this we built a demo app internally and we're seeing here that we have a start location of the hallway chairs and we want to get somewhere we know where hallway chairs are and so we can do a locate anchors by ID call there so here we are choosing the place we want to get to we want to get some tea we're gonna do a locate anchors by Adi call on the hallway chairs we're gonna find it so there we go we found it now we're doing a nearby query so we're finding connected anchors and we're able to find tea and display an arrow telling us yeah go that way the tea is over there we're then able to find it and we made it to tea successfully so with this extension of that app that I just showed you I hope you can see how by using nearby queries to fan out in the graph you can both build persistent experiences and wayfinding experiences so with that said I want to move on to a third point and it's about UX considerations Before we jump in too much I want to show you a gif again that you've seen and I want to call it something new which is the feature points that we get are super super important for how we're able to locate anchors so here's us finding this really interesting Lobby we had lots of interesting feature points if you didn't have a good area to look at you probably wouldn't have as much success so so in the right example where the room is all blank walls we don't encourage you to use as your spatial anchors as much there we want you to target interesting visual features and to avoid just a blank white wall second point I want to talk about is considering the scenario so when you're considering the scenario I mean think about who's coming after you and gonna be finding your anchors for example are you building an app that lets you place an anchor at the top of a hiking trail and you want someone coming from the north and the south and the east and the west tool to find that anchor if so you probably want to pan around and do a 360 as you're placing the anchor that we've recorded environment data about the entire scene but maybe or not maybe you're designing an app for data visualization on a conference room and in that case is that as important that you aim at the walls or the side corners maybe not maybe it's more important that you get your users to sit down and place an anchor in a central location and maybe be sitting while they do so or how about if you're building an app for a museum where you want to place information on the paintings so that users can learn more about the famous painting they're seeing you in that case maybe you just want to scan around the painting and it's not as important that you pan at the bench behind the painting so as an example of considering the scenario we found there's two main ways that users find anchors probably many more so I want to note don't take this as a silver bullet UX is hard the first is a target scenario and in the target scenario you're able to show a picture when you tell the user to look for an anchor this can be really useful because maybe you're building that museum app you can get an admin to take a picture of the app of take a picture of the painting and when the user goes they can say oh I know that Rembrandt I'll paint it I'll point my phone right there and I'll find the spatial anchor easily but that doesn't always work oftentimes you're in more of a room scenario where the anchors can be anywhere around you as an example of this we built an escape the room experience and in it the anchors could be above you below you behind you or in the corner in that case there's no interesting picture to show them because the anchors could be anywhere so it's more important to build UX and encourage the user to pan all around them including down and up instead of just looking at one thing so with that I want to say that we're live so we have docks up we have samples on github for all platforms and we have lots of other resources so the demo code from today is on github please take a picture of this and check it out we also have samples Doc's Stack Overflow we would love to hear you on user voice or through that feedback email we try to be super responsive there and are really open to working with customers also check out Renee's Twitter because he has lots of really cool videos so check out this and there's some other fun build sessions related to mixed reality that we encourage you to check out as well so thank you it's like a 360 and we should actually have some time for questions so go ahead please step up to the microphones and asking questions awesome and vicente who is an engineering lead on our team will also be around to help answer questions and stick around up in the session okay so I wanted to ask how are you guys getting the feature points from err kar core so we use AR kid an air core for some slam but then we build on top of them and do our own feature points from the camera frames you pass in okay and that's locally on the device yes so when uploading an anchor point when uploading an anchor the feature points that travel along with that definition are those feature points stored with that anchor only or are they stored in sort of a global expanding and enrichment global mesh of feature points they are stored today with the anchor that you uploaded with the anchor um yes so there's no real concept at this point of the feature point cloud right now which you can query anchor points from feature points it's something that you think is a road map item we we do have graph expansion in the road map but we haven't really tackle it yet okay but as of today I query anchor points by a specific enumeration of anchor point IDs or other attributes like GPS location etc wrap through feature points it's okay thank you how's the direction determined between two connected anchor points does it matter how far they are from each other like when you say one anchor point and then you say of another in one session is it keeping track of which direction how does it do that no so yeah so basically it when you place one on occur in the session we are using the tracker from air core or air kit so the farther you are that you're more susceptible to errors so yeah it is recommend that if you're going to go farther alone you might drop anchors while you're going there so you have places before we find minutes you go in the direction that you're showing that's basically just a straight line you're not really taking into account correct awesome any any more questions we have like four minutes yes there's gentleman yeah so do you have a device back on when these could be displayed so some of the older devices doesn't show up these properly done today any air kit enabled able device or air core enable device should be able to handle the SDK and what's the best recommendation to show like you showed the hello my hello world message but typically if you have that angle that's only it shows that but if you have an anchor on a moving stuff then it's difficult to get to our our data I guess can you repeat the question can you repeat the question gonna get a bit close to the mic maybe yeah so what's the best recommendation to look at the or how do you know the angle at which when you're displaying some data so I have a dashboard where I'm displaying real-time data but most of the time it's very difficult to pull it up because people are not used to it or are there handling or filling with it device let me follow up with you after because I'm not sure if I understand the question cool awesome so will stickers another one this may not be worth everybody's time but I'm just curious for as a newbie if I maybe made an app and gave it to my kid right and I said you can put dinosaurs all over the house right and you're gonna go find your dinosaurs is he gonna be able to find those after he cleans his room for example and the location points change so within reason yes but like if you remodel the room you'll probably not find them because the algorithms are actually pure virtual so you can imagine that if you go to a room and you can recognize that as a human it's the same thing for the for the camera so if you go in and the room is vastly different you'll probably have trouble finding them okay this is kind of related but the feature points are very specific to lighting and the data model the that is being used at that particular time and so Google updates there's every who knows week month whatever iOS also Apple will also do that so how have you found like as you're developing this accuracy are you able to like as they progress and change as the lighting changes are you guys able to keep that point here when the lights are you know ten percent versus they're a hundred percent but so today we're like really starting on all this analysis for like how to do persistence we are like really betting very heavily on it but we still haven't done all the experiments so today you basically rely on multiple anchors for different different conditions and that will be your best bet to actually get recall yeah but you might might remember the video ice I showed like at the Pike Place Market it was really a different flow pattern right it was dry and wet like really a different contrast for the dis lamb to try to find the future points and it worked surprisingly well of course it always has limitations right but like the level will already and now it's already really impressive in fact so related to that when you're the one that you showed with the showing an assembly if it's great as long as the assembly is in the same place but if that if they move that assembly it's still the same assembly but they move it slightly in the room because they're changing their shop floor do you have to then reorient everything or or does it can you is are all of the feature points just located on the assembly itself it really matters you know when during the cloud special anchor session what you really captured right if you would just focus on automotive seed and this is the future points right and so if you don't capture a lot of the environment the chance will be much higher than it really relocates that but I mean Center you want to want to add something to that as a so basically the the the anchor post that you get back is relative to the future point so it's like he said if you just can that where this seat is and you're only taking that into account like the code even if you move it the post will be relative to that so it will be moving with it at that point all right we're right at the end thanks a lot for attending thank you enjoy Bill [Applause] 