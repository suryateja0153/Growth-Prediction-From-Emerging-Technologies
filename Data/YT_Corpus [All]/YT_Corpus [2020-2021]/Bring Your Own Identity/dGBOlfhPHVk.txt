 I have the privilege of talking identity to you. I must admit: About 10 years ago I started talking about identity, because I was afraid of large audiences...  What a mistake that was, because Now it seems that Identity is everywhere.  Identity is hot. Even this room is filled up... Well, we have some seats left, so that's cool. Today, I'm going to talk about is identity. Let me first introduce myself, because I am from the Netherlands. I work for a relatively small Microsoft partner: SCCT. and I've been doing Active Directory, Azure Active Directory since 2006. So, yeah... I think I know what I'm talking about... I'm an Enterprise Mobility MVP since 2009... that used to be called a Directory Services MVP and I also talk to guys at Veeam and guys and gals at VMware. What I'm going to talk about today is just the six items that most people don't get about Azure Active Directory and Active Directory. First, I'm just gonna show you the groundwork. "What's Hybrid Identity all about?" "What's up with Active Directory and Azure Active Directory?" "How can you combine them? and "What are the best practices?" or actually ... Microsoft doesn't do best practices anymore: Microsoft tells you recommended practices now, because it depends on your organization's size, your vision, mission ... stuff like that ... your strategy.  So we're going to talk about recommended practices, like multi-factor authentication and I'm not just going to show you how to do multi-factor authentication and I'm not just gonna show you single sign-on... Single sign-on is really silly to demo, anyway. It's like: "Look, nothing happens." I'm going to demo the other four items, which is attribute-based access control, because that's what we want Under the covers, everything's still groups, everything's still access control lists and access control entries, but we can do attribute-based group memberships. That's fun! We can do conditional access, beyond what we're doing today on-premises, which is really powerful and I'm going to show you how to automate and delegate access reviews, so you as admins no longer have to do those tedious tasks. Let product owners do that. Let application owners do that. Of course, I'm going to talk about self-service problem solving, because We're the admins. Okay, but service desk people have a hard life too. So let's help them out too. Let's start off with a bit of ground work, because what we're talking about is one identity platform. You already have one identity platform probably, if you have Active Directory Domain Services... About 93% of organizations have Active Directory or Azure Active Directory: Startups; It's a bit silly, right? If you're a startup, you don't say: "You know what, Let's buy 1200 euros of server hardware. Iron. Let's put it in a cupboard.  Let's remove the carpet., put some tiling in so it doesn't become a vacuum cleaner." Startups don't do that. Startups say: "You know what, I think 18 bucks a month per user is a pretty good deal. Let's do that and then they scale up to 200, 250 or thousands of users, just like that." Just pay per user per month, and if you... accidentally of course... reduce in numbers... That's OK too, because you still pay per user per month. It's not like you have a big Exchange Server cluster, that's just sitting there doing nothing anymore, because nobody's mailing anymore... No, it's just the service that you pay for as you go.  The biggest service that you get, if you do anything Microsoft cloud is  Azure Active Directory. and the popular saying is ... Well, I think  Sami Laiho can make it a meme if he wants to... Azure AD is neither Azure nor AD. It's not Azure, as it's not in all datacenters. It's not in old regions. It's not in all locations. It has its different setups with different characteristics just like Exchange Online has. It's not AD either, because you can join a computer to AD by just doing domain join, but you can't do exactly that with Azure Active Directory. Of course, they've added the hybrid AD join, hybrid as ready join the azure ad join and stuff like that in the last two years but basically what it was when it first started out was just a large scalable ad LDS hosted instance but it's an azure active directory its cloud-based it's an identity and access management solution I am it's got directory services it's got well something that is close to resembling some sort of an identity governance platform there's there's a lot of stuff that's currently being developed in that area with Azure Active Directory it's not complete and so I'm only showing you some of those identity governance features the ones that work the ones that we deploy at our customers the ones that we enjoy as an organization and the other stuff I'd go I basically don't talk about those you have to keep something for it next year right and of course there's application Nexus management we're going to talk about that and it's a rich standards-based platform for developers and that's a big deal because Active Directory even LDAP even all those stuff that you talk to Active Directory is not the open standard anymore Microsoft has been what do they call it embracing extending those open standards making them their own so they could add value to those and it means that Active Directory has its own specific way of communicating back to you as your Active Directory is completely open standards and it's funny because Microsoft is one of the biggest contributors to all those open standards these days so now they're giving it back now they're saying you know what even if you have some other cloud-based directory even if you have some open source ad FS if and if you have open source whatever it will communicate with Azure Active Directory if it uses the open standards that were using sam'l WS fet skim a lot to fight out you stuff like that there's a lot of tubes right yeah there's no issues they do get it wrong the first time most of the time but if you have a Active Directory and if you have Active Directory and you combine them and I'll show you how then you get all the benefits of single sign-on now your users no longer have to enter credentials think about this as a as a prime example your marketing department probably uses social media they probably use Twitter as a group Twitter doesn't do a lot of fancy stuff in terms of identity what they do is you have user name password and if you want to milk you factor authentication we're actually two step verification now if a person from your marketing department leaves we have to reset the password on Twitter LinkedIn all those other social media because the person that left knew all those passwords a multi-factor authentication in a team is not that convenient so what we're doing with Azure Active Directory and it's one of these three types of web applications that you can add Twitter you can add as a password voltage application so what you're doing is you store the username and password for Twitter in Azure Active Directory and then you add a tile for Twitter to the access panel to portal that office.com you can even put it in a waffle if you want to that's the menu in the left top corner in the office365 portal you can do all that stuff and the only thing that a marketing person has to do is click on the tile as your active directory does its magic on the recovers and boom here's your Twitter no one from the marketing department has to know the password as your active directory knows the password and if that isn't mind blowing as your active directory will even try and change the password every 30 days so even if the password is compromised in one way or another then the window of time where you can actually use those credentials is limited to it's all the tricks that as your active directory for cloud-based applications has up its sleeve and I'll show you how to put people in groups but you already know how to do that in Active Directory if you just sync up your groups from ad on-prem to Azure Active Directory boom they're there the marketing department find marketing department Twitter there you go it's that easy and the tool that you want to use is a j''r ad connect and I'm specifically using this cream from the azure ad connect wizard this is a screen that you get if you do not use Express settings expressing is really cool because you install the app for clicks later it's done and it's synchronizing between Active Directory on-prem and azure active directory with default settings and default settings means password hash synchronization which is the stupidest acronym ever it's it's acronyms PHS but it's actually synchronization of the hash of the hash of the password but I think shhp wasn't that catch you or something it's not your your hash it's not the hash of the users objects in Active Directory that are synchronized whereas your Active Directory gets that well and the for hash to be exact and it pulls it a thousand times through a es 256 that should probably do it so even if you have password hash sync there's a hash on the other side in Azure Active Directory and let me let me let me just paint a picture of that skill there's password hashes for about half of Microsoft's tenants so Microsoft Azure ad organizations so there's about 10 million organizations with their password hashes in Azure Active Directory that makes it a really prime target for attackers so Microsoft has thought that true and said you know what probably we shouldn't just put hashes from on-premises environments straight into Azure ad if the platform is at one point of time compromised what you'll see is that now we've got 10 million compromised environments well probably we should make sure that that doesn't happen so that's password hashing relation that's pass through authentication as well juices the azure service bus which is really cool Azure Active Directory just puts authentication requests on the azure service bus and then PDA agents in your environment pick up those authentication requests and process these with your on-premises Active Directory Federation with AD FS and Federation with ping federal are two scenarios where you see the same thing happening as your Active Directory talks to Active Directory and performs the actual authentication in Active Directory itself leveraging all your auditing or your seam or your I am processes you're sill point all that stuff still works still there everything is everything it directory and in Azure ad and of course you can always choose to do not configure which is a very interesting option which well we don't use that much if you do that if you enable as ready Connect which is a free tool and you sync up your user objects from Active Directory to Azure Active Directory and you specify the authentication method and there's lots of choices I just told you then what you get is your first stepping stone to password list now you can have sign ins with the Authenticator app no longer you have to use a password it's just an authenticate their request that you approve you pick a number from three numbers that the number that matches the screen well that's the good thing to do or else you won't be logged on and then you just logged on you no longer need a password for that and of course those fancy Fido 2.0 keys work with Azure Active Directory in hybrid mode and Azure Active Directory cloud mode by default I've got a couple of those keys on my keychain it just works I just go to my device any device in my organisation I put in a key boom I logged on it's that simple and it's still multi-factor authentication but because I can only do that on devices that are company-owned I can only do that by default on organizations devices with a TPM chip its device that I have that I add to the other device I can't use that device anywhere else and the first time I get there to that device I have to provide a pin so the device is something I have or can prove I can have the key is something I can prove I can I have but I need to pin something I could prove I can know to actually perform that multi-factor authentication and every password layers authentication is a multi-factor authentication so think about that all those users currently and I work with admins mostly if we do stuff in Azure Active Directory and Active Directory and hybrid identity and all that stuff I see the people from the organization perform nota factor authentication but probably 30 times a day it's a hassle and admins know you oh you know what I'm most admins feel responsible responsible for their environments I say you know what let's do multi-factor authentication I'll take my responsibility and act like an adult users mmm not so much so if we can make authentication more easy or easier for our users safer for our users that's something that will help security in the end I'm not even gonna kind of demo that because it's single sign-on it's hard to demo the sign-on screen if you're presenting but I am gonna demo the next thing that we're going to talk about and it's attribute based access control with dynamic groups so in Azure Active Directory I can have groups based on attributes so I can have a group with all the people that are hidden from the global address list just like that if I want to do that on Prem I need Microsoft Identity Manager that's another free service that I have to configure maintain write off stuff like that it's built into Azure Active Directory and then I can use those groups - I don't know assign licenses assign applications like Twitter if you have your your department name field in Active Directory filled out right so with lots and lots of our integrity if you have your your function attribute in a in Active Directory filled out with great integrity you can just filter out those stuff so even if you have a marketing liaison in Department X it still has marketing in the description field or in the function field or in whatever field you can just still say you know what I'm gonna give you Twitter too so let's see how that works because I've got a browser right here let me just show you if you haven't seen it this is a j''r Active Directory in the admin Center it's a ad doc portal - accom I use that because I don't get the popups that the admin Center wants me to use an app instead of the browser this is all browser-based I use Firefox with an extension that hides some of the sensitive stuff on the screen which I feel is good and what I'm gonna do is I'm just gonna go in the here's my mouse in the navigation window I'm going to as your active directory which is where all the fun stuff happening and I'm going to groups now this tenant doesn't have any groups yet so let's create one new group security group is great after 365 groups are great to you because you can have teens and stuff like that already added but but please note if you add people to an office 365 group I can see someone grinning already they all get an email yeah so please be very careful with that option if if email is still a thing in your organization the group name we were just gonna show a sure ad premium premium on our Mac soft calls it premium P - let's go license assignment something like that well I think that's a perfect description - and what I'm gonna do is I'm gonna create a dynamic user group you can also create dynamic computer groups dynamic user groups and now I'm gonna add a dynamic query and you can add expressions you can end an or and stuff like that but let's choose a property and let's choose the let scroll down a bit use a principle name because I love that one and I'm gonna say you know what it needs to contain my domain name and I'll show you why I choose this and not something else and then I'm just gonna say enter and let me get that yep now it's here this is the actual LDAP filter that is used on the recovers so I'm just gonna save it then create it it's going to take a while to get the members added it depends on how many people need to be added but if you look at users what you'll see is that there's a couple of users that have that lucerne pub comm user principal name suffix but there's also a couple of them that don't so I'm not assigning a license to someone that's I don't know doing some other stuff now let's go to licensing because this is where we do the fancy stuff with the licensing assignment I've got one product right there let's click on it let's go to license groups and let's assign users in groups there's only one right tidy premium there it is select and then I'm gonna say you know what I only want you to have the premium peach you know wait I like my expression of presentation too and there you go people will be automatically added to the group people will be automatically assigned licenses you don't have to do anything about that if you use your names right for your groups if you do the dynamic membership room good you can actually use that all that stuff that I'm just showing you as the basis for two of the other things that I'm gonna show you let's get this back out of the way here we go and let's get back to the presentation because if we're looking at access based control what we're seeing is that most admins are still stuck somewhere in 2003 we have a file server there's a folder on it there's a group on it if you remember of the group great you've got full control on the folder I see well I see some people Grinch but Grinch but who the full control right that's not something that we do these days but we're still seeing it and after a pretty long night in Las Vegas I came up with this slide and I'm saying you know what this is basically what we have on premises we have either a device app user group or collection collections from system Center for instance people can do stuff to a scope which can either be a collection or a folder or whatever and always is pretty much what we're doing there if you have access to a fuller you can access that folder anytime you can actually log on if you do not have logon restrictions you always have access furthermore if you have access ransomware as access to Wow I think attackers love that so what what can we do about that well let me let me show you what microsoft model for azure active directory looks like this is all the stuff that we can do in Azure Active Directory to Azure ad integrated resources and then maybe maybe really clear about that don't just think about office365 don't you think about Twitter think about your on-premises sharepoint to because you can make that Active Directory integrated with the azure ad app proxy or with your web app proxies all that stuff still works if you have web functionality on Prem you can put it behind the azure ad a proxy and you can still use conditional access and if you do and if you enter this model from the left to the right these four areas will be will be analyzed so what's the user who is he what groups is he a part of what about the device what groups are the device about is it hybrid edge ad joint is it as ready joint is it compliant with engine stuff like that the location is this a location that we trust is this one of our own locations and I think that's that's a silly one in the current way of thinking because currently today most organizations think well my location is a safe haven for devices not not a physical location is only a trusted location if you actually do the hard work like deploying 802 1 X or doing your onboarding and off-boarding right which most organizations just forget right for some reason but I am going to show you something that our Department of International Affairs really loved and is using and of course it is per app so you can have all these rules per application per group per device group stuff like that and it gets evaluated through machine learning and there's loads and loads of data per day pouring in to that from breaches from Microsoft account sort of personal account logins and stuff like that and it all gets mangled into a session risk and based on that session risk and based on all that stuff and of course your conditional access policies that are combined into an effect if policy you either get allow access require multi-factor authentication limited access you can do that in SharePoint you can say you know what if you're in Thailand you only get read access to this document library in SharePoint you can do that with conditional access now try and do that on Prem you can deny access which is obvious and you can force a password reset if the session risk is too high and actually that's built-in everybody gets that stuff conditional access is really cool but conditional access requires a premium license a p1 license it's only one premium and then if you get that stuff you can do fun stuff but first we have to fill that funnel right so how do we fill it how do we do stuff with devices how do we stuff locations and stuff like that so let's see about devices there's five ways then you can join a device and more and more what we're seeing is that organizations are using Azure Active Directory domain services which is like to smoke and mirror domain controllers using the Azure Active Directory database and adding devices to that but please don't that's four servers only and you'll find out that your being is unsupported a pretty fast because there's loads and loads of stuff that just isn't in Azure a DDS that you find extremely likely to be there because you've had that feature for 20 years in Active Directory on Prem well as I told you as you're a DS not AD it's ad LDS from the start of course 80 domain join is the stuff that you all know there's a hybrid as your ad joint so if I have a domain joint device I can automatically make it hybrid as a ID joint that means that device object that I have in Active Directory ends up in Azure Active Directory as well so I just do all the normal stuff bless you all the normal stuff in Active Directory my service desk people still know how to do that and then all of a sudden magic happens and all these devices are in Azure Active Directory now I can use them in conditional access of course you can also do a charade a joint which is cool for windows-based bring-your-own-device scenarios and if you have iPhones and stuff like that you can assure the register them and it's pretty fun because if you deploy that and there's some there's some big there's there's a big fuss about that because the latest version of azure ad Connect seems to break this feature a bit if you do not follow the guides or the how to's to go to the letter basically then actually connect 1.4 will actually break some stuff in some scenarios so there's a GID join as I said it's bringing wrong and of course we've got the hybrid Azure I did join and you need to have a couple of things for that so we start with actually connect one point one point for 86.0 which is about two years old so probably if you've ever deployed actually connecting the last two years you're good to go and if you run Windows 10 1607 sorry wrong button then you're good to go as well Windows 10 are TMF 1511 need a group policy needs to be set to actually do the hybrid azure ad join but if you have 1607 or up it will do it automatically it will just assume that that just works there's a button in System Center Configuration Manager as well for hybrid as ready join that overrules all the stuff that I just said and of course if you have Windows 7 Windows 8 Windows 8.1 and actually the release notes initially said that it works on Windows Vista too if you still have those probably not you can use the workplace join for legacy clients and I've specifically added a link because they've renamed that stuff four times and it's really hard to for it wait now it's hard to look for it by me specifically so if you use Google you'll probably find it I use Bing because I think that that gives me the credibility of being an actual expert because you can't find stuff to help you you've used Microsoft Intune on top of Azure ad joint and hybrid hid joint so you can configure the hybrid I hid joint to do an automatic intern enrollment now there's way bigger experts on engine and contact manager probably even in this room than me so I'm just gonna show you how this works from a an identity point of view so you can auto enroll to in tune if you don't do in tune what you'll see is that hybrid I sure did you and Azure ad joint are on the spot action so if you upgrade your Windows 10 if you rename your Windows 10 devices stuff like that all those changes are not reflected in the azure ad portal and in junior says you know what we'll look at the device is it compliant it doesn't have a different name all that stuff just works so let's see how that works because we still have the azure ad portal right here let me get mouse yep here we go I go to conditional access it's underneath Azure Active Directory as well and here's the baseline policies baseline policies are awesome if you do not have premium or premium p2 licenses because they're free and they help you get to a next security level but what we're going to do is and I've already done something with mink locations I've got some untrusted countries right here and I've selected two you probably know which two it's North Korea let me show you North Korea and the other one that we're not allowed to do business with South Sudan so I've added them to an untrusted countries so let's create a new policy let's say users and groups let's say o users and watch it because this also means all guests let's say Klout yeah I need to be done sorry I need to click done first o users done cloud app server applications all cloud applications done conditions locations configure yes selected locations here are my untrusted countries select done done and I'm gonna say grant and I'm gonna say block access select enable policy don't lock yourself out okay so I screwed my current user create let's give it a name sorry here's your name and right there I've blocked access to every application every feature that is Azure Active Directory integrated from North Korea and South Sudan under a minute there's people in our department of External Affairs that were doing this upgrading IP ranges in a DFS red X claims to two guys almost full-time 36 hours a week I did it under a minute and it's updated because Microsoft also does this stuff so why why why right cool stuff and then there's identity protection and I've already said it but identity protection is always touted and always seen as an Israeli premium pritu license but it's not it's even available for free Microsoft accounts you can just use it everything's gathered everything seen everything's added to that machine learning funnel and we all benefit so if there's a tour exit node and if you in your location say you know what I want anonymous IP addresses to not be included or I want to block to everyone on mf8 that's all coming from identity protection as well if there's a breach and Microsoft's notified of those breaches it will actually try and see if there's users from your tenants because every app uses email address so that's easy to see if they're in the breach and if they are then what they're doing is it gonna allow people to change their passwords after multi-factor authentication we don't have to do anything for that of course if you do not have a premium license what you'll see or premium p2 license what you'll see is that they contain less information and that they only go back 30 days only there's a couple of reports that you can use and it's really fun to get on top of all that stuff we've just seen a holiday season so you'll probably be able as an admin to figure out where all your colleagues went for holidays and if because we all sacrifice as that means so we all go on vacation next month right so if you see something someone they're been to Costa Rica for instance you say well that's interesting let's ask these guys where they went and if they do the hotel or not so yeah good feature automated and delegated access reviews so we're now getting to the one page per feature part of this presentation there's only a couple of features left fortunately but we have our ad access reviews if you have as ready premium p2 license you can have application owners keep their permissions clean themselves so what we're seeing is that now as an admin we can just allow those guys to get rid of all those legacy permissions people that did have rights but don't need them anymore I mean who uses Visio anyway no that's the big one that you can use right here get someone off of Visio if you're not using it who knows who's not using it the manager so let's see getting back to the photo again let me get my mouse it's right here and let's go to identity governance now this is a clean tenant so I first have to unboard it yep I'm bored now thank you I'm boring should be done and then in the governance great yep here's access reviews let's scroll bit down and let's create an access review it needs a name there you go stardate a frequency so how many times do we want those owners to be notified what I think quarterly is just fine we never end cool twenty five days is the period of time that they have to get their answer in then users to review well let's get a group and we've got a group so let's use that one there you go select and reviewers I want this done by my buddy my buddy here you go probably know him here he is he knows everything about licensing and I'm just gonna start so now what happens is that yours is gonna get an email and say you know what you're a reviewer for this group in three months time he's gonna get a new email says hey remember you were a reviewer for this group these are all the people in there please tell us what you want to have done and if we go back to the access review what we'll see is that we can actually say how it was in the advanced features how we want the answers from yours processed because we can say you know what yours may answer all these questions we're not going to do anything tell him we're just ignore it and it's great from an onboarding it's great for an awareness point-of-view but you can also say you know what if your stels me that someone doesn't need Eliza's anymore it's fine remove him or if your says doesn't need me anymore I as an admin who have the last say on that and I will actually remove that in the same portal right here and then of course because these were all features that we as admins really loved but we can also do self-service so users can do self-service Password Reset it's it's really easy to enable it's one slide you enable it after you enable it everyone that does a logon says you know what we're gonna register for self-service Password now we're gonna do an MFA and roll oh cool that's probably something you need to tell the service desk guys people first there goes to surprise right but it's cool because now they can reset their passwords after initial registration and don't get me wrong 20% of typical IT budgets or blown on password resets and the in productivity around that and there's there's cool stuff so it's a kms / sspr it's a kms / register MFA you can just communicate those URLs to your users and of course there's group management and you can allow colleagues to create their own groups and add people to those groups and you can have naming conventions and stuff like that applied so it does get some kind of bushi I don't know what that is uncontrollable so really cool stuff that we can have people that are experiencing problems during the weekends still remain productive by just fixing stuff themselves or just contacting colleagues through whatsapp or whatever and say you know what could you add me to this group could you give me a review could you approve of me joining your group stuff like that so let's conclude this session if there's one thing you do if you want to use every stuff everything every feature that I just shown you just synchronize your objects you benefit from one identity it's single sign-on it's painless you can do all those conditional exit stuff and you get a head start on password list and with identity protection you don't have to worry about those pesky breaches that I think I think the current number is about two per day breaches where you users might be in and of course if we do the banned password feature that unfortunately today we didn't have time for you can actually say in your my organization name is this I don't want that word or the word welcome in any passwords anymore it's cool you can enable your colleagues so you set boundaries with conditional access so they don't break the rule in North Korea or South Sudan you can let them reset their passwords and you can let application owners review the stuff so if they have limiting budgets or stuff like that you can just say you know what I'm just gonna kick some people out and of course you can secure access to is and pass based resources by leveraging Azure ad based role based access control with those same dynamic groups easy and with that there's only two words left for me and I thank you 