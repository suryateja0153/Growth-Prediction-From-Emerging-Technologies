 in this work we tackle the challenge of large-scale image localization by proposing to self-supervise fine-grained region similarities image localization can be cast as an image retrieval task where the geographical location of a given query image is estimated by recognizing its nearest reference images captured at the same place from a large scale database the fundamental challenge of image retrieval tasks is to learn image representations that are discriminative enough to tell apart different locations so here image localization is treated as a weekly supervised task because geographically close by images may not depict the same scene when facing different directions to avoid being misled by weak gps labels previous works utilized on the fly top 1 images of the queries as their positive training samples such an operation is to force the queries to be closer to the already nearest neighbors or in other words the easiest positive samples which will result in lack of robustness to varying conditions since the top 1 images are too simple to provide enough supervisions for learning robust representations so we argue that difficult positives are needed identifying the true difficult positives is challenging with only gps labels for each query image its k-nearest database image might still contain false positive samples directly utilizing them as difficult true positives in existing pipelines might worsen the learned features how to properly use noisy difficult positives is crucial to representation learning we propose to estimate query gallery similarities as informative soft supervisions to train with noisy positive samples specifically the similarity labels are expected to be smaller for false positives or true positives with small overlapping regions in such a way we can properly explore the potential of difficult positives and avoid error amplification caused by false positives so how could we estimate such similarity labels we train the network for the first generation following the existing pipelines with only easiest positives and then query gallery similarities estimated by the first generations network serve as soft supervision for training the network in a second generation here is the formulation of similarity labels the image to image similarities between each query and its k-nearest neighbors are estimated by the network train in generation 1. and such similarity labels serve as soft learning targets to supervise the training of the network in generation 2 in the form of a cross-entropy loss the above process can iterate and train the network for multiple generations to progressively improve the learned features previously we talked about how to exploit difficult positives however even with true positives there might still be non-overlapping regions utilizing only the image level supervisions simply forces features from other spatial regions to approach the same target scores such an operation would hurt the learning of discriminative local features therefore the ideal supervisions should provide more robust region level correspondences specifically we decompose the positive images into four half regions and four quarter regions the query to region similarities estimated from the previous generations network can serve as more fine-grained guidance for feature learning here is the formulation of fine-grained similarity labels for each query image both the query to image and query to region similarities are estimated as soft learning targets here are the results on two public benchmarks for image localization we achieved significant improvements especially on the more challenging tokyo data set we also visualize the feature maps for a better understanding of the superiority of our method compared to the state-of-the-art sare in this example s-a-r-e fails in identifying the correct top one image due to the lack of robustness in varying illuminations specifically they ignore the street shops which provide valuable information for localizing the query image sare also wrongly focuses on the misleading trees in another example due to the lack of discriminative local representations which shows the necessity of region level training supervision thank you for your interest in our work the code is available and you are welcome to send us messages if you have any questions 